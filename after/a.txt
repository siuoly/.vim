<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">
<link rel="pingback" href="https://ataspinar.com/xmlrpc.php">

<title>A guide for using the Wavelet Transform in Machine Learning &#8211; ML Fundamentals</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//code.responsivevoice.org' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="ML Fundamentals &raquo; Feed" href="https://ataspinar.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="ML Fundamentals &raquo; Reactiesfeed" href="https://ataspinar.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="ML Fundamentals &raquo; A guide for using the Wavelet Transform in Machine Learning Reactiesfeed" href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/ataspinar.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='style_main-css'  href='https://ataspinar.com/wp-content/plugins/wp-gif-player/style.css?ver=1512585559' type='text/css' media='all' />
<link rel='stylesheet' id='wp-quicklatex-format-css'  href='https://ataspinar.com/wp-content/plugins/wp-quicklatex/css/quicklatex-format.css?ver=5.8' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-css'  href='https://ataspinar.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://ataspinar.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://ataspinar.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='sydney-bootstrap-css'  href='https://ataspinar.com/wp-content/themes/sydney/css/bootstrap/bootstrap.min.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://ataspinar.com/wp-includes/css/dist/block-library/style.min.css?ver=5.8' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='mediaelement-css'  href='https://ataspinar.com/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.16' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css'  href='https://ataspinar.com/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=5.8' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css'  href='https://ataspinar.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='rv-style-css'  href='https://ataspinar.com/wp-content/plugins/responsivevoice-text-to-speech/includes/css/responsivevoice.css?ver=5.8' type='text/css' media='all' />
<link rel='stylesheet' id='sydney-google-fonts-css'  href='https://fonts.googleapis.com/css?family=Raleway%3A400%2C600%7CExo++++%3B%3A600&#038;subset=latin&#038;display=swap' type='text/css' media='all' />
<link rel='stylesheet' id='sydney-style-css'  href='https://ataspinar.com/wp-content/themes/sydney/style.css?ver=20210526' type='text/css' media='all' />
<style id='sydney-style-inline-css' type='text/css'>
.site-header { background-color:rgba(38,50,70,0.9);}
html { scroll-behavior: smooth;}
body, #mainnav ul ul a { font-family:Raleway;}
h1, h2, h3, h4, h5, h6, #mainnav ul li a, .portfolio-info, .roll-testimonials .name, .roll-team .team-content .name, .roll-team .team-item .team-pop .name, .roll-tabs .menu-tab li a, .roll-testimonials .name, .roll-project .project-filter li a, .roll-button, .roll-counter .name-count, .roll-counter .numb-count button, input[type="button"], input[type="reset"], input[type="submit"] { font-family:Exo    ;;}
.site-title { font-size:32px; }
.site-description { font-size:16px; }
#mainnav ul li a { font-size:14px; }
h1 { font-size:52px; }
h2 { font-size:42px; }
h3 { font-size:32px; }
h4 { font-size:25px; }
h5 { font-size:20px; }
h6 { font-size:18px; }
body { font-size:18px; }
.single .hentry .title-post { font-size:36px; }
.header-image { background-size:cover;}
.header-image { height:150px; }
.go-top:hover svg,.sydney_contact_info_widget span { fill:#d65050;}
.site-header.float-header { background-color:rgba(0,0,0,0.9);}
@media only screen and (max-width: 1024px) { .site-header { background-color:#000000;}}
.site-title a, .site-title a:hover { color:#ffffff}
.site-description { color:#ffffff}
#mainnav ul li a, #mainnav ul li::before { color:#ffffff}
#mainnav .sub-menu li a { color:#ffffff}
#mainnav .sub-menu li a { background:#1c1c1c}
.text-slider .maintitle, .text-slider .subtitle { color:#ffffff}
body { color:#47425d}
#secondary { background-color:#ffffff}
#secondary, #secondary a { color:#767676}
.footer-widgets { background-color:#252525}
.btn-menu .sydney-svg-icon { fill:#ffffff}
#mainnav ul li a:hover { color:#d65050}
.site-footer { background-color:#1c1c1c}
.site-footer,.site-footer a { color:#666666}
.overlay { background-color:#000000}
.page-wrap { padding-top:10px;}
.page-wrap { padding-bottom:10px;}
@media only screen and (max-width: 1025px) {		
			.mobile-slide {
				display: block;
			}
			.slide-item {
				background-image: none !important;
			}
			.header-slider {
			}
			.slide-item {
				height: auto !important;
			}
			.slide-inner {
				min-height: initial;
			} 
		}
@media only screen and (max-width: 780px) { 
    	h1 { font-size: 32px;}
		h2 { font-size: 28px;}
		h3 { font-size: 22px;}
		h4 { font-size: 18px;}
		h5 { font-size: 16px;}
		h6 { font-size: 14px;}
	}

</style>
<!--[if lte IE 9]>
<link rel='stylesheet' id='sydney-ie9-css'  href='https://ataspinar.com/wp-content/themes/sydney/css/ie9.css?ver=5.8' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='addtoany-css'  href='https://ataspinar.com/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.15' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css'  href='https://ataspinar.com/wp-content/plugins/jetpack/_inc/social-logos/social-logos.min.css?ver=10.0' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://ataspinar.com/wp-content/plugins/jetpack/css/jetpack.css?ver=10.0' type='text/css' media='all' />
<script type='text/javascript' src='https://ataspinar.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' id='crayon_js-js-extra'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/ataspinar.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta' id='crayon_js-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1' id='addtoany-js'></script>
<script type='text/javascript' src='https://code.responsivevoice.org/1.8.1/responsivevoice.js?source=wp-plugin&#038;ver=5.8' id='responsive-voice-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/wp-quicklatex/js/wp-quicklatex-frontend.js?ver=1.0' id='wp-quicklatex-frontend-js'></script>
<link rel="https://api.w.org/" href="https://ataspinar.com/wp-json/" /><link rel="alternate" type="application/json" href="https://ataspinar.com/wp-json/wp/v2/posts/4014" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://ataspinar.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://ataspinar.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.8" />
<link rel="canonical" href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/" />
<link rel='shortlink' href='https://ataspinar.com/?p=4014' />
<link rel="alternate" type="application/json+oembed" href="https://ataspinar.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fataspinar.com%2F2018%2F12%2F21%2Fa-guide-for-using-the-wavelet-transform-in-machine-learning%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://ataspinar.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fataspinar.com%2F2018%2F12%2F21%2Fa-guide-for-using-the-wavelet-transform-in-machine-learning%2F&#038;format=xml" />

<script data-cfasync="false">
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};a2a_localize = {
	Share: "Delen",
	Save: "Bewaren",
	Subscribe: "Inschrijven",
	Email: "E-mail",
	Bookmark: "Bookmark",
	ShowAll: "Alles weergeven",
	ShowLess: "Niet alles weergeven",
	FindServices: "Vind dienst(en)",
	FindAnyServiceToAddTo: "Vind direct een dienst om aan toe te voegen",
	PoweredBy: "Mede mogelijk gemaakt door",
	ShareViaEmail: "Delen per e-mail",
	SubscribeViaEmail: "Abonneren via e-mail",
	BookmarkInYourBrowser: "Bookmark in je browser",
	BookmarkInstructions: "Druk op Ctrl+D of \u2318+D om deze pagina te bookmarken",
	AddToYourFavorites: "Voeg aan je favorieten toe",
	SendFromWebOrProgram: "Stuur vanuit elk e-mailadres of e-mail programma",
	EmailProgram: "E-mail programma",
	More: "Meer&#8230;",
	ThanksForSharing: "Bedankt voor het delen!",
	ThanksForFollowing: "Dank voor het volgen!"
};

(function(d,s,a,b){a=d.createElement(s);b=d.getElementsByTagName(s)[0];a.async=1;a.src="https://static.addtoany.com/menu/page.js";b.parentNode.insertBefore(a,b);})(document,"script");
</script>
<style type='text/css'>img#wpstats{display:none}</style>
		
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="A guide for using the Wavelet Transform in Machine Learning" />
<meta property="og:url" content="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/" />
<meta property="og:description" content="[latexpage] 1. Introduction In a previous blog-post we have seen how we can use Signal Processing techniques for the classification of time-series and signals. A very short summary of that post is:…" />
<meta property="article:published_time" content="2018-12-21T06:42:38+00:00" />
<meta property="article:modified_time" content="2021-08-16T14:00:30+00:00" />
<meta property="og:site_name" content="ML Fundamentals" />
<meta property="og:image" content="https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1.png" />
<meta property="og:image:width" content="856" />
<meta property="og:image:height" content="378" />
<meta property="og:locale" content="nl_NL" />
<meta name="twitter:text:title" content="A guide for using the Wavelet Transform in Machine Learning" />
<meta name="twitter:image" content="https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->

<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/wp-spamshield/js/jscripts.php'></script> 
</head>

<body data-rsssl=1 class="post-template-default single single-post postid-4014 single-format-standard group-blog menu-inline" >

<span id="toptarget"></span>


	<div class="preloader">
	    <div class="spinner">
	        <div class="pre-bounce1"></div>
	        <div class="pre-bounce2"></div>
	    </div>
	</div>
	
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Spring naar inhoud</a>

	<div class="header-clone"></div>
	<header id="masthead" class="site-header" role="banner" >
		<div class="header-wrap">
            <div class="container">
                <div class="row">
					<div class="col-md-4 col-sm-8 col-xs-12">
											<h1 class="site-title"><a href="https://ataspinar.com/" rel="home">ML Fundamentals</a></h1>
						<h2 class="site-description"></h2>	        
										</div>
					<div class="col-md-8 col-sm-4 col-xs-12">
						<div class="btn-menu" aria-expanded="false" ><i class="sydney-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" /></svg></i></div>
						<nav id="mainnav" class="mainnav" role="navigation"  >
							<div class="menu-menu-1-container"><ul id="menu-menu-1" class="menu"><li id="menu-item-3272" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-3272"><a href="https://ataspinar.com/">Home</a></li>
<li id="menu-item-3273" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3273"><a href="https://ataspinar.com/about/">About</a></li>
<li id="menu-item-3774" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3774"><a href="https://ataspinar.com/github/">GitHub</a></li>
<li id="menu-item-3274" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3274"><a href="https://ataspinar.com/contact/">Contact</a></li>
</ul></div>						</nav><!-- #site-navigation -->
					</div>
				</div>
			</div>
		</div>
	</header><!-- #masthead -->

	
	<div class="sydney-hero-area">
				<div class="header-image">
			<div class="overlay"></div>					</div>
		
			</div>

	
	<div id="content" class="page-wrap">
		<div class="container content-wrapper">
			<div class="row">	
	
	
	<div id="primary" class="content-area col-md-9">

		
		<main id="main" class="post-wrap" role="main">

		
			
<article id="post-4014" class="post-4014 post type-post status-publish format-standard hentry category-classification category-convolutional-neural-networks category-machine-learning category-recurrent-neural-networks category-scikit-learn category-stochastic-signal-analysis category-tensorflow category-uncategorized">
	
	
	<header class="entry-header">
		
		<div class="meta-post">
			<a href="https://ataspinar.com/category/machine-learning/classification/" title="Classification" class="post-cat">Classification</a><a href="https://ataspinar.com/category/convolutional-neural-networks/" title="convolutional neural networks" class="post-cat">convolutional neural networks</a><a href="https://ataspinar.com/category/machine-learning/" title="Machine Learning" class="post-cat">Machine Learning</a><a href="https://ataspinar.com/category/recurrent-neural-networks/" title="recurrent neural networks" class="post-cat">recurrent neural networks</a><a href="https://ataspinar.com/category/scikit-learn/" title="scikit-learn" class="post-cat">scikit-learn</a><a href="https://ataspinar.com/category/stochastic-signal-analysis/" title="Stochastic signal analysis" class="post-cat">Stochastic signal analysis</a><a href="https://ataspinar.com/category/tensorflow/" title="tensorflow" class="post-cat">tensorflow</a><a href="https://ataspinar.com/category/uncategorized/" title="Uncategorized" class="post-cat">Uncategorized</a>		</div>

		<h1 class="title-post entry-title" >A guide for using the Wavelet Transform in Machine Learning</h1>
				<div class="single-meta">
			<span class="posted-on"><i class="sydney-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z" /></svg></i>Geplaatst <a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/" rel="bookmark"><time class="entry-date published" datetime="2018-12-21T06:42:38+00:00">december 21, 2018</time><time class="updated" datetime="2021-08-16T14:00:30+00:00" >augustus 16, 2021</time></a></span><span class="byline"> <i class="sydney-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z" /></svg></i><span class="author vcard" ><a class="url fn n" href="https://ataspinar.com/author/admin/">admin</a></span></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	
	<div class="entry-content" >
		<h2>1. Introduction</h2>
<p>In a<a href="https://ataspinar.com/2018/04/04/machine-learning-with-signal-processing-techniques/" target="_blank" rel="noopener"> previous blog-post</a> we have seen how we can use Signal Processing techniques for the classification of time-series and signals.</p>
<p>A very short summary of that post is: We can use the Fourier Transform to  transform a signal from its time-domain to its frequency domain. The peaks in the frequency spectrum indicate the most occurring frequencies in the signal. The larger and sharper a peak is, the more prevalent a frequency is in a signal. The location (frequency-value) and height (amplitude) of the peaks in the frequency spectrum then can be used as input for Classifiers like Random Forest or Gradient Boosting.</p>
<p>This simple approach works surprisingly well for many classification problems. In that blog post we were able to classify the Human Activity Recognition dataset with a ~91 % accuracy.</p>
<p>The general rule is that this approach of using the Fourier Transform will work very well when the frequency spectrum is stationary. That is, the frequencies present in the signal are not time-dependent; if a signal contains a frequency of x <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-1f259f83c8ab9424d7fc9b2bc47d2e8a_l3.svg" class="ql-img-inline-formula " alt="&#72;&#122;" title="Rendered by QuickLaTeX.com" height="12" width="25" style="vertical-align: 0px;"/> this frequency should be present equally anywhere in the signal.<br />
The more non-stationary/dynamic a signal is, the worse the results will be. That&#8217;s too bad, since most of the signals we see in real life are non-stationary in nature. Whether we are talking about ECG signals, the stock market, equipment or sensor data, etc, etc, in real life problems start to get interesting when we are dealing with dynamic systems. A much better approach for analyzing dynamic signals is to use the Wavelet Transform instead of the Fourier Transform.</p>
<p>Even though the Wavelet Transform is a very powerful tool for the analysis and classification of time-series and signals, it is unfortunately not known or popular within the field of Data Science. This is partly because you should have some prior knowledge (about signal processing, Fourier Transform and Mathematics) before you can understand the mathematics behind the Wavelet Transform. However, I believe it is also due to the fact that most books, articles and papers are way too theoretical and don&#8217;t provide enough practical information on how it should and can be used.<br />
In this blog-post we will see the theory behind the Wavelet Transform (without going too much into the mathematics) and also see how it can be used in practical applications. <strong>By providing Python code at every step of the way you should be able to use the Wavelet Transform in your own applications by the end of this post.</strong></p>
<p>The contents of this blogpost are as follows:</p>
<ol>
<li>Introduction</li>
<li>Theory
<ul>
<li>2.1 From Fourier Transform to Wavelet Transform</li>
<li>2.2 How does the Wavelet Transform work?</li>
<li>2.3 The different types of Wavelet families</li>
<li>2.4 Continuous Wavelet Transform vs Discrete Wavelet Transform</li>
<li>2.5 More on the Discrete Wavelet Transform: The DWT as a filter-bank.</li>
</ul>
</li>
<li>Practical Applications
<ul>
<li>3.1 Visualizing the State-Space using the Continuous Wavelet Transform</li>
<li>3.2 Using the Continuous Wavelet Transform and a Convolutional Neural Network to classify signals
<ul>
<li>3.2.1 Loading the UCI-HAR time-series dataset</li>
<li>3.2.2 Applying the CWT on the dataset and transforming the data to the right format</li>
<li>3.2.3 Training the Convolutional Neural Network with the CWT</li>
</ul>
</li>
<li>3.3 Deconstructing a signal using the DWT</li>
<li>3.4 Removing (high-frequency) noise using the DWT</li>
<li>3.5 Using the Discrete Wavelet Transform to classify signals
<ul>
<li>3.5.1 The idea behind Discrete Wavelet classification</li>
<li>3.5.2 Generating features per sub-band</li>
<li>3.5.3 Using the features and scikit-learn classifiers to classify two datasets.</li>
</ul>
</li>
<li>3.6 Comparison of the classification accuracies between DWT, Fourier Transform and Recurrent Neural Networks</li>
</ul>
</li>
<li>Finals Words</li>
</ol>
<p><strong>PS:</strong> In this blog-post we will mostly use the Python package <a href="http://pywavelets.readthedocs.io" target="_blank" rel="noopener">PyWavelets</a>, so go ahead and install it with <code>pip install pywavelets</code>.</p>
<h2>2.1 From Fourier Transform to Wavelet Transform</h2>
<p>In the previous blog-post we have seen how the Fourier Transform works. That is, by multiplying a signal with a series of sine-waves with different frequencies we are able to determine which frequencies are present in a signal. If the dot-product between our signal and a sine wave of a certain frequency results in a large amplitude this means that there is a lot of overlap between the two signals, and our signal contains this specific frequency. This is of course because the <a href="https://www.youtube.com/watch?v=LyGKycYT2v0" target="_blank" rel="noopener">dot product</a> is a measure of how much two vectors / signals overlap.</p>
<p>The thing about the Fourier Transform is that it has a high resolution in the frequency-domain but zero resolution in the time-domain. This means that it can tell us exactly which frequencies are present in a signal, but not at which location in time these frequencies have occurred. This can easily be demonstrated as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9338434329068" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
t_n = 1
N = 100000
T = t_n / N
f_s = 1/T

xa = np.linspace(0, t_n, num=N)
xb = np.linspace(0, t_n/4, num=N/4)

frequencies = [4, 30, 60, 90]
y1a, y1b = np.sin(2*np.pi*frequencies[0]*xa), np.sin(2*np.pi*frequencies[0]*xb)
y2a, y2b = np.sin(2*np.pi*frequencies[1]*xa), np.sin(2*np.pi*frequencies[1]*xb)
y3a, y3b = np.sin(2*np.pi*frequencies[2]*xa), np.sin(2*np.pi*frequencies[2]*xb)
y4a, y4b = np.sin(2*np.pi*frequencies[3]*xa), np.sin(2*np.pi*frequencies[3]*xb)

composite_signal1 = y1a + y2a + y3a + y4a
composite_signal2 = np.concatenate([y1b, y2b, y3b, y4b])

f_values1, fft_values1 = get_fft_values(composite_signal1, T, N, f_s)
f_values2, fft_values2 = get_fft_values(composite_signal2, T, N, f_s)

fig, axarr = plt.subplots(nrows=2, ncols=2, figsize=(12,8))
axarr[0,0].plot(xa, composite_signal1)
axarr[1,0].plot(xa, composite_signal2)
axarr[0,1].plot(f_values1, fft_values1)
axarr[1,1].plot(f_values2, fft_values2)
(...)
plt.tight_layout()
plt.show()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-24">24</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-26">26</div><div class="crayon-num" data-line="crayon-622c62a9a9338434329068-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9338434329068-28">28</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9338434329068-1"><span class="crayon-v">t_n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-2"><span class="crayon-v">N</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100000</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-3"><span class="crayon-v">T</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">t_n</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">N</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-4"><span class="crayon-v">f_s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-i">T</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-6"><span class="crayon-v">xa</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">t_n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-o">=</span><span class="crayon-v">N</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-7"><span class="crayon-v">xb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">t_n</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-o">=</span><span class="crayon-v">N</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-8">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9338434329068-9"><span class="crayon-v">frequencies</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-10"><span class="crayon-v">y1a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-o">*</span><span class="crayon-v">frequencies</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">xa</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-o">*</span><span class="crayon-v">frequencies</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">xb</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-11"><span class="crayon-v">y2a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y2b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-o">*</span><span class="crayon-v">frequencies</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">xa</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-o">*</span><span class="crayon-v">frequencies</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">xb</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-12"><span class="crayon-v">y3a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y3b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-o">*</span><span class="crayon-v">frequencies</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">xa</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-o">*</span><span class="crayon-v">frequencies</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">xb</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-13"><span class="crayon-v">y4a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y4b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-o">*</span><span class="crayon-v">frequencies</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">xa</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-o">*</span><span class="crayon-v">frequencies</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-v">xb</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-14">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9338434329068-15"><span class="crayon-v">composite_signal1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y1a</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">y2a</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">y3a</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">y4a</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-16"><span class="crayon-v">composite_signal2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">y1b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y2b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y3b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y4b</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-18"><span class="crayon-v">f_values1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fft_values1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_fft_values</span><span class="crayon-sy">(</span><span class="crayon-v">composite_signal1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">T</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">N</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">f_s</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-19"><span class="crayon-v">f_values2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fft_values2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_fft_values</span><span class="crayon-sy">(</span><span class="crayon-v">composite_signal2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">T</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">N</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">f_s</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-20">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9338434329068-21"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axarr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">nrows</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ncols</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-22"><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">xa</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">composite_signal1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-23"><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">xa</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">composite_signal2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-24"><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">f_values1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fft_values1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-25"><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">f_values2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fft_values2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-26"><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9338434329068-27"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">tight_layout</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9338434329068-28"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0092 seconds] -->
<p><figure id="attachment_4041" aria-describedby="caption-attachment-4041" style="width: 856px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1.png"><img loading="lazy" class="wp-image-4041 size-full" src="https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1.png" alt="" width="856" height="378" srcset="https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1.png 856w, https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1-300x132.png 300w, https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1-768x339.png 768w, https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1-830x367.png 830w, https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1-230x102.png 230w, https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1-350x155.png 350w, https://ataspinar.com/wp-content/uploads/2018/08/fft_spectra-1-480x212.png 480w" sizes="(max-width: 856px) 100vw, 856px" /></a><figcaption id="caption-attachment-4041" class="wp-caption-text">Figure 1. The signals and frequency spectrum of a signal which contains four frequencies at all times (top), four different frequencies at four different times (bottom).</figcaption></figure></p>
<p>In Figure 1 we can see at the top left a signal containing four different frequencies (<img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-e625bc76ce6e840b4341d38022d598b3_l3.svg" class="ql-img-inline-formula " alt="&#52;" title="Rendered by QuickLaTeX.com" height="13" width="9" style="vertical-align: -1px;"/>, <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-ee95b67e5e188bd14b8e47adf0162fd0_l3.svg" class="ql-img-inline-formula " alt="&#51;&#48;" title="Rendered by QuickLaTeX.com" height="12" width="18" style="vertical-align: 0px;"/>, <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-12e8c6c8bc77b282f661bc699203cd92_l3.svg" class="ql-img-inline-formula " alt="&#54;&#48;" title="Rendered by QuickLaTeX.com" height="12" width="18" style="vertical-align: 0px;"/> and <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-875014f73108d904acc55f42185c5fc1_l3.svg" class="ql-img-inline-formula " alt="&#57;&#48;&#32;&#72;&#122;" title="Rendered by QuickLaTeX.com" height="12" width="43" style="vertical-align: 0px;"/>) which are present at all times and on the right its frequency spectrum. In the bottom figure, we can see the same four frequencies, only the first one is present in the first quarter of the signal, the second one in the second quarter, etc. In addition, on the right side we again see its frequency spectrum.</p>
<p>What is important to note here is that the two frequency spectra contain exactly the same four peaks, so it can not tell us <em>where</em> in the signal these frequencies are present. The Fourier Transform can not distinguish between the first two signals.</p>
<p><strong>PS:</strong> The side lobes we see in the bottom frequency spectrum, is due to the discontinuity between the four different frequencies.</p>
<p>In trying to overcome this problem, scientists have come up with the <a href="https://en.wikipedia.org/wiki/Short-time_Fourier_transform" target="_blank" rel="noopener">Short-Time Fourier Transform</a>. In this approach the original signal is splitted into several parts of equal length (which may or may not have an overlap) by using a sliding window before applying the Fourier Transform. The idea is quite simple: if we split our signal into 10 parts, and the Fourier Transform detects a specific frequency in the second part, then we know for sure that this frequency has occurred between <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-e0b93bede19a499955c7bc4e2abcfb86_l3.svg" class="ql-img-inline-formula " alt="&#92;&#102;&#114;&#97;&#99;&#123;&#50;&#125;&#123;&#49;&#48;&#125;" title="Rendered by QuickLaTeX.com" height="23" width="14" style="vertical-align: -7px;"/> th and <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-df0cf27fc23a817b8918291959ca1105_l3.svg" class="ql-img-inline-formula " alt="&#92;&#102;&#114;&#97;&#99;&#123;&#51;&#125;&#123;&#49;&#48;&#125;" title="Rendered by QuickLaTeX.com" height="23" width="14" style="vertical-align: -7px;"/> th of our original signal.</p>
<p>The main problem with this approach is that you run into the theoretical limits of the Fourier Transform known as the <a href="https://en.wikipedia.org/wiki/Fourier_transform#Uncertainty_principle" target="_blank" rel="noopener">uncertainty principle</a>. The smaller we make the size of the window the more we will know about where a frequency has occurred in the signal, but less about the frequency value itself. The larger we make the size of the window the more we will know about the frequency value and less about the time.</p>
<p>A better approach for analyzing signals with a dynamical frequency spectrum is the Wavelet Transform. The Wavelet Transform has a high resolution in both the frequency- and the time-domain. It does not only tell us which frequencies are present in a signal, but also at which time these frequencies have occurred. This is accomplished by working with different scales. First we look at the signal with a large scale/window and analyze &#8216;large&#8217; features and then we look at the signal with smaller scales in order to analyze smaller features.</p>
<p>The time- and frequency resolutions of the different methods are illustrated in Figure 2.</p>
<figure id="attachment_4035" aria-describedby="caption-attachment-4035" style="width: 622px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/08/Comparisonoftransformations.jpg"><img loading="lazy" class="wp-image-4035 size-full" src="https://ataspinar.com/wp-content/uploads/2018/08/Comparisonoftransformations.jpg" alt="" width="622" height="607" srcset="https://ataspinar.com/wp-content/uploads/2018/08/Comparisonoftransformations.jpg 622w, https://ataspinar.com/wp-content/uploads/2018/08/Comparisonoftransformations-300x293.jpg 300w, https://ataspinar.com/wp-content/uploads/2018/08/Comparisonoftransformations-230x224.jpg 230w, https://ataspinar.com/wp-content/uploads/2018/08/Comparisonoftransformations-350x342.jpg 350w, https://ataspinar.com/wp-content/uploads/2018/08/Comparisonoftransformations-480x468.jpg 480w" sizes="(max-width: 622px) 100vw, 622px" /></a><figcaption id="caption-attachment-4035" class="wp-caption-text">Figure 2. A schematic overview of the time and frequency resolutions of the different transformations in comparison with the original time-series dataset. The size and orientations of the block gives an indication of the resolution size.</figcaption></figure>
<p>In Figure 2 we can see the time and frequency resolutions of the different transformations. The size and orientation of the blocks indicate how small the features are that we can distinguish in the time and frequency domain. The original time-series has a high resolution in the time-domain and zero resolution in the frequency domain. This means that we can distinguish very small features in the time-domain and no features in the frequency domain.</p>
<p>Opposite to that is the Fourier Transform, which has a high resolution in the frequency domain and zero resolution in the time-domain.</p>
<p>The Short Time Fourier Transform has medium sized resolution in both the frequency and time domain.</p>
<p>The Wavelet Transform has:</p>
<ul>
<li>for small frequency values a high resolution in the frequency domain, low resolution in the time- domain,</li>
<li>for large frequency values a low resolution in the frequency domain, high resolution in the time domain.</li>
</ul>
<p>In other words, the Wavelet Transforms makes a trade-off; at scales in which time-dependent features are interesting it has a high resolution in the time-domain and at scales in which frequency-dependent features are interesting it has a high resolution in the frequency domain.</p>
<p>And as you can imagine, this is exactly the kind of trade-off we are looking for!</p>
<h2>2.2 How does the Wavelet Transform work?</h2>
<p>The Fourier Transform uses a series of sine-waves with different frequencies to analyze a signal. That is, a signal is represented through a linear combination of sine-waves.<br />
The Wavelet Transform uses a series of functions called wavelets, each with a different scale. The word wavelet means a small wave, and this is exactly what a wavelet is.</p>
<figure id="attachment_4016" aria-describedby="caption-attachment-4016" style="width: 413px" class="wp-caption aligncenter"><a href="https://ataspinar.com/wp-content/uploads/2018/07/Wavelet-Out1.jpg"><img loading="lazy" class="wp-image-4016 size-full" src="https://ataspinar.com/wp-content/uploads/2018/07/Wavelet-Out1.jpg" alt="" width="413" height="123" srcset="https://ataspinar.com/wp-content/uploads/2018/07/Wavelet-Out1.jpg 413w, https://ataspinar.com/wp-content/uploads/2018/07/Wavelet-Out1-300x89.jpg 300w, https://ataspinar.com/wp-content/uploads/2018/07/Wavelet-Out1-230x68.jpg 230w, https://ataspinar.com/wp-content/uploads/2018/07/Wavelet-Out1-350x104.jpg 350w" sizes="(max-width: 413px) 100vw, 413px" /></a><figcaption id="caption-attachment-4016" class="wp-caption-text">Figure 3. The difference between a sine-wave and a Wavelet. The sine-wave is infinitely long and the Wavelet is localized in time.</figcaption></figure>
<p>In Figure 3 we can see the difference between a sine-wave and a wavelet. The main difference is that the sine-wave is not localized in time (it stretches out from -infinity to +infinity) while a wavelet <strong>is</strong> localized in time. This allows the wavelet transform to obtain time-information in addition to frequency information.</p>
<p>Since the Wavelet is localized in time, we can multiply our signal with the wavelet at different locations in time. We start with the beginning of our signal and slowly move the wavelet towards the end of the signal. This procedure is also known as a convolution. After we have done this for the original (mother) wavelet, we can scale it such that it becomes larger and repeat the process. This process is illustrated in the figure below.</p>
<div class="gif_wrap wpgp-width600">
                        <a href="javascript:void(0);" class="gif_link_wrap wpgp-width600" title="Click to play" rel="nofollow"></a>
                        <span class="play_gif wpgp-width600">GIF</span>
                        <img src="https://ataspinar.com/wp-content/uploads/2018/12/wavelet_convolution_3d_2d_final_still_tmp.jpeg" class="_showing frame no-lazy" alt="">
                   </div>
                   <img src="https://ataspinar.com/wp-content/uploads/2018/12/wavelet_convolution_3d_2d_final_still_tmp.jpeg" class="_hidden no-lazy" alt="" style="display:none;">
<p>As we can see in the figure above, the Wavelet transform of an 1-dimensional signal will have two dimensions. This 2-dimensional output of the Wavelet transform is the time-scale representation of the signal in the form of a <a href="https://en.wikipedia.org/wiki/Scaleogram" target="_blank" rel="noopener">scaleogram</a>.<br />
Above the scaleogram is plotted in a 3D plot in the bottom left figure and in a 2D color plot in the bottom right figure.</p>
<p><strong>PS:</strong> You can also have a look at <a href="https://www.youtube.com/watch?v=QX1-xGVFqmw" target="_blank" rel="noopener">this youtube video</a> to see how a Wavelet Transform works.</p>
<p>So what is this dimension called scale? Since the term frequency is reserved for the Fourier Transform, the wavelet transform is usually expressed in scales instead.  That is why the two dimensions of a scaleogram are time and scale. For the ones who find frequencies more intuitive than scales, it is possible to convert scales to pseudo-frequencies with the equation</p>
<p><img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-853574e03ae69d726ef2638517a7cc6d_l3.svg" class="ql-img-inline-formula " alt="&#102;&#95;&#97;&#32;&#61;&#32;&#92;&#102;&#114;&#97;&#99;&#123;&#102;&#95;&#99;&#125;&#123;&#97;&#125;" title="Rendered by QuickLaTeX.com" height="23" width="55" style="vertical-align: -6px;"/></p>
<p>where <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-9c21dc8301268cc7674627bc0e7e2aca_l3.svg" class="ql-img-inline-formula " alt="&#102;&#95;&#97;" title="Rendered by QuickLaTeX.com" height="16" width="16" style="vertical-align: -4px;"/> is the pseudo-frequency, <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-bebbef29334f67e5621b4d973dabcd23_l3.svg" class="ql-img-inline-formula " alt="&#102;&#95;&#99;" title="Rendered by QuickLaTeX.com" height="16" width="15" style="vertical-align: -4px;"/> is the central frequency of the Mother wavelet and <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-c63f5a3a084d567b6d62758d1c9bc8b8_l3.svg" class="ql-img-inline-formula " alt="&#97;" title="Rendered by QuickLaTeX.com" height="8" width="9" style="vertical-align: 0px;"/> is the scaling factor.</p>
<p>We can see that a higher scale-factor (longer wavelet) corresponds with a smaller frequency, so by scaling the wavelet in the time-domain we will analyze smaller frequencies (achieve a higher resolution) in the frequency domain. And vice versa, by using a smaller scale we have more detail in the time-domain. So scales are basically the inverse of the frequency.</p>
<p><strong>PS</strong>: PyWavelets contains the function <a href="http://pywavelets.readthedocs.io/en/latest/ref/other-functions.html#pywt.scale2frequency" target="_blank" rel="noopener">scale2frequency</a> to convert from a scale-domain to a frequency-domain.</p>
<h2>2.3 The different types of Wavelet families</h2>
<p>Another difference between the Fourier Transform and the Wavelet Transform is that there are many different families (types) of wavelets. The wavelet families differ from each other since for each family a different trade-off has been made in how compact and smooth the wavelet looks like. This means that we can choose a specific wavelet family which fits best with the features we are looking for in our signal.</p>
<p>The <a href="http://pywavelets.readthedocs.io/en/latest/" target="_blank" rel="noopener">PyWavelets </a>library for example contains 14 <a href="https://en.wikipedia.org/wiki/Wavelet#Mother_wavelet" target="_blank" rel="noopener">mother Wavelets</a> (families of Wavelets):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a934e196885155" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import pywt
print(pywt.families(short=False))
['Haar', 'Daubechies', 'Symlets', 'Coiflets', 'Biorthogonal', 'Reverse biorthogonal', 
'Discrete Meyer (FIR Approximation)', 'Gaussian', 'Mexican hat wavelet', 'Morlet wavelet', 
'Complex Gaussian wavelets', 'Shannon wavelets', 'Frequency B-Spline wavelets', 'Complex Morlet wavelets']</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a934e196885155-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a934e196885155-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a934e196885155-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a934e196885155-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a934e196885155-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a934e196885155-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pywt</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a934e196885155-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">families</span><span class="crayon-sy">(</span><span class="crayon-v">short</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a934e196885155-3"><span class="crayon-sy">[</span><span class="crayon-s">'Haar'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Daubechies'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Symlets'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Coiflets'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Biorthogonal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Reverse biorthogonal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a934e196885155-4"><span class="crayon-s">'Discrete Meyer (FIR Approximation)'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Gaussian'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Mexican hat wavelet'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Morlet wavelet'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-622c62a9a934e196885155-5"><span class="crayon-s">'Complex Gaussian wavelets'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Shannon wavelets'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Frequency B-Spline wavelets'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Complex Morlet wavelets'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Each type of wavelets has a different shape, smoothness and compactness and is useful for a different purpose. Since there are only two mathematical conditions a wavelet has to satisfy it is easy to generate a new type of wavelet.</p>
<p>The two mathematical conditions are the so-called normalization and orthogonalization constraints:</p>
<p>A wavelet must have 1) finite energy and 2) zero mean.<br />
Finite energy means that it is localized in time and frequency; it is integrable and the inner product between the wavelet and the signal always exists.<br />
The admissibility condition implies a wavelet has zero mean in the time-domain, a zero at zero frequency in the time-domain. This is necessary to ensure that it is integrable and the inverse of the wavelet transform can also be calculated.</p>
<p>Furthermore:</p>
<ul>
<li>A wavelet can be orthogonal or non-orthogonal.</li>
<li>A wavelet can be bi-orthogonal or not.</li>
<li>A wavelet can be symmetric or not.</li>
<li>A wavelet can be complex or real. If it is complex, it is usually divided into a real part representing the amplitude and an imaginary part representing the phase.</li>
<li>A wavelets is normalized to have unit energy.</li>
</ul>
<p>Below we can see a plot with several different families of wavelets.<br />
The first row contains four Discrete Wavelets and the second row four Continuous Wavelets.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9353763059913" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
discrete_wavelets = ['db5', 'sym5', 'coif5', 'bior2.4']
continuous_wavelets = ['mexh', 'morl', 'cgau5', 'gaus5']

list_list_wavelets = [discrete_wavelets, continuous_wavelets]
list_funcs = [pywt.Wavelet, pywt.ContinuousWavelet]

fig, axarr = plt.subplots(nrows=2, ncols=4, figsize=(16,8))
for ii, list_wavelets in enumerate(list_list_wavelets):
    func = list_funcs[ii]
    row_no = ii
    for col_no, waveletname in enumerate(list_wavelets):
        wavelet = func(waveletname)
        family_name = wavelet.family_name
        biorthogonal = wavelet.biorthogonal
        orthogonal = wavelet.orthogonal
        symmetry = wavelet.symmetry
        if ii == 0:
            _ = wavelet.wavefun()
            wavelet_function = _[0]
            x_values = _[-1]
        else:
            wavelet_function, x_values = wavelet.wavefun()
        if col_no == 0 and ii == 0:
            axarr[row_no, col_no].set_ylabel("Discrete Wavelets", fontsize=16)
        if col_no == 0 and ii == 1:
            axarr[row_no, col_no].set_ylabel("Continuous Wavelets", fontsize=16)
        axarr[row_no, col_no].set_title("{}".format(family_name), fontsize=16)
        axarr[row_no, col_no].plot(x_values, wavelet_function)
        axarr[row_no, col_no].set_yticks([])
        axarr[row_no, col_no].set_yticklabels([])

plt.tight_layout()
plt.show()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-24">24</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-26">26</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-28">28</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-30">30</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9353763059913-32">32</div><div class="crayon-num" data-line="crayon-622c62a9a9353763059913-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9353763059913-1"><span class="crayon-v">discrete_wavelets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'db5'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'sym5'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'coif5'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'bior2.4'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-2"><span class="crayon-v">continuous_wavelets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'mexh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'morl'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'cgau5'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'gaus5'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-4"><span class="crayon-v">list_list_wavelets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">discrete_wavelets</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">continuous_wavelets</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-5"><span class="crayon-v">list_funcs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-v">Wavelet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-v">ContinuousWavelet</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-6">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9353763059913-7"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axarr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">nrows</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ncols</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-8"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list_wavelets </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">list_list_wavelets</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">func</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">list_funcs</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">row_no</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ii</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-11"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">waveletname </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">list_wavelets</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">wavelet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">func</span><span class="crayon-sy">(</span><span class="crayon-v">waveletname</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">family_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">.</span><span class="crayon-e">family_name</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-14"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">biorthogonal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">.</span><span class="crayon-e">biorthogonal</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-15"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">orthogonal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">.</span><span class="crayon-e">orthogonal</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-16"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">symmetry</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">.</span><span class="crayon-e">symmetry</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-17"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">ii</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">.</span><span class="crayon-e">wavefun</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">wavelet_function</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">wavelet_function</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">.</span><span class="crayon-e">wavefun</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">ii</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">"Discrete Wavelets"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">ii</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">"Continuous Wavelets"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-s">"{}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">family_name</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">x_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">wavelet_function</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_yticks</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_yticklabels</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9353763059913-32"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">tight_layout</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9353763059913-33"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0071 seconds] -->
<p><figure id="attachment_4025" aria-describedby="caption-attachment-4025" style="width: 1024px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families.png"><img loading="lazy" class="size-large wp-image-4025" src="https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families-1024x508.png" alt="" width="1024" height="508" srcset="https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families-1024x508.png 1024w, https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families-300x149.png 300w, https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families-768x381.png 768w, https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families-830x412.png 830w, https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families-230x114.png 230w, https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families-350x174.png 350w, https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families-480x238.png 480w, https://ataspinar.com/wp-content/uploads/2018/08/wavelet_families.png 1144w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-4025" class="wp-caption-text">Figure 5. Several families of Wavelets. In the first row we see discrete wavelets and in the second row we see several continuous wavelets.</figcaption></figure></p>
<p><strong>PS:</strong> To see how all wavelets looks like, you can have a look at the <a href="http://wavelets.pybytes.com/" target="_blank" rel="noopener">wavelet browser</a>.</p>
<p>Within each wavelet family there can be a lot of different wavelet subcategories belonging to that family. You can distinguish the different subcategories of wavelets by the number of coefficients (the number of vanishing moments) and the level of decomposition.</p>
<p>This is illustrated below in for the one family of wavelets called &#8216;Daubechies&#8217;.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9358219800475" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import pywt
import matplotlib.pyplot as plt

db_wavelets = pywt.wavelist('db')[:5]
print(db_wavelets)
*** ['db1', 'db2', 'db3', 'db4', 'db5']

fig, axarr = plt.subplots(ncols=5, nrows=5, figsize=(20,16))
fig.suptitle('Daubechies family of wavelets', fontsize=16)
for col_no, waveletname in enumerate(db_wavelets):
    wavelet = pywt.Wavelet(waveletname)
    no_moments = wavelet.vanishing_moments_psi
    family_name = wavelet.family_name
    for row_no, level in enumerate(range(1,6)):
        wavelet_function, scaling_function, x_values = wavelet.wavefun(level = level)
        axarr[row_no, col_no].set_title("{} - level {}\n{} vanishing moments\n{} samples".format(
            waveletname, level, no_moments, len(x_values)), loc='left')
        axarr[row_no, col_no].plot(x_values, wavelet_function, 'bD--')
        axarr[row_no, col_no].set_yticks([])
        axarr[row_no, col_no].set_yticklabels([])
plt.tight_layout()
plt.subplots_adjust(top=0.9)
plt.show()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9358219800475-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a9358219800475-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9358219800475-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pywt</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-4"><span class="crayon-v">db_wavelets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">wavelist</span><span class="crayon-sy">(</span><span class="crayon-s">'db'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-5"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">db_wavelets</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-6"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'db1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db3'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db4'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db5'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-8"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axarr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">ncols</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nrows</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-9"><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">suptitle</span><span class="crayon-sy">(</span><span class="crayon-s">'Daubechies family of wavelets'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-10"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">waveletname </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">db_wavelets</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">wavelet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">Wavelet</span><span class="crayon-sy">(</span><span class="crayon-v">waveletname</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">no_moments</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">.</span><span class="crayon-e">vanishing_moments_psi</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-13"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">family_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">.</span><span class="crayon-e">family_name</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-14"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">level </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">wavelet_function</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scaling_function</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">.</span><span class="crayon-e">wavefun</span><span class="crayon-sy">(</span><span class="crayon-v">level</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">level</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-s">"{} - level {}\n{} vanishing moments\n{} samples"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">waveletname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">level</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">no_moments</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">x_values</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loc</span><span class="crayon-o">=</span><span class="crayon-s">'left'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">x_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">wavelet_function</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'bD--'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_yticks</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">row_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col_no</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_yticklabels</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-21"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">tight_layout</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9358219800475-22"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots_adjust</span><span class="crayon-sy">(</span><span class="crayon-v">top</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9358219800475-23"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0052 seconds] -->
<p><figure id="attachment_4024" aria-describedby="caption-attachment-4024" style="width: 1024px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/08/db_family.png"><img loading="lazy" class="size-large wp-image-4024" src="https://ataspinar.com/wp-content/uploads/2018/08/db_family-1024x809.png" alt="" width="1024" height="809" srcset="https://ataspinar.com/wp-content/uploads/2018/08/db_family-1024x809.png 1024w, https://ataspinar.com/wp-content/uploads/2018/08/db_family-300x237.png 300w, https://ataspinar.com/wp-content/uploads/2018/08/db_family-768x607.png 768w, https://ataspinar.com/wp-content/uploads/2018/08/db_family-830x656.png 830w, https://ataspinar.com/wp-content/uploads/2018/08/db_family-230x182.png 230w, https://ataspinar.com/wp-content/uploads/2018/08/db_family-350x277.png 350w, https://ataspinar.com/wp-content/uploads/2018/08/db_family-480x379.png 480w, https://ataspinar.com/wp-content/uploads/2018/08/db_family.png 1432w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-4024" class="wp-caption-text">Figure 6. The Daubechies family of wavelets for several different orders of vanishing moments and several levels of refinement.</figcaption></figure></p>
<p>In Figure 6 we can see wavelets of the &#8216;Daubechies&#8217; family (db) of wavelets. In the first column we can see the Daubechies wavelets of the first order ( db1), in the second column of the second order (db2), up to the fifth order in the fifth column. PyWavelets contains Daubechies wavelets up to order 20 (db20).<br />
The number of the order indicates the number of vanishing moments. So db3 has three vanishing moments and db5 has 5 vanishing moment. The number of vanishing moments is related to the approximation order and smoothness of the wavelet. If a wavelet has p vanishing moments, it can approximate polynomials of degree p &#8211; 1.</p>
<p>When selecting a wavelet, we can also indicate what the level of decomposition has to be. By default, PyWavelets chooses the maximum level of decomposition possible for the input signal. The maximum level of decomposition (see <a href="https://pywavelets.readthedocs.io/en/latest/ref/dwt-discrete-wavelet-transform.html?#maximum-decomposition-level-dwt-max-level" target="_blank" rel="noopener">pywt.dwt_max_level()</a>) depends on the length of the input signal length and the wavelet (more on this later).</p>
<p>As we can see, as the number of vanishing moments increases, the polynomial degree of the wavelet increases and it becomes smoother. And as the level of decomposition increases, the number of samples this wavelet is expressed in increases.</p>
<h2>2.4 Continuous Wavelet Transform vs Discrete Wavelet Transform</h2>
<p>As we have seen before (Figure 5), the Wavelet Transform comes in two different and distinct flavors; the Continuous and the Discrete Wavelet Transform.</p>
<p>Mathematically, a Continuous Wavelet Transform is described by the following equation:</p>
<p><a href="https://ataspinar.com/wp-content/uploads/2018/09/continuous_transform.png"><img loading="lazy" class="size-full wp-image-4046 alignnone" src="https://ataspinar.com/wp-content/uploads/2018/09/continuous_transform.png" alt="" width="393" height="94" srcset="https://ataspinar.com/wp-content/uploads/2018/09/continuous_transform.png 393w, https://ataspinar.com/wp-content/uploads/2018/09/continuous_transform-300x72.png 300w, https://ataspinar.com/wp-content/uploads/2018/09/continuous_transform-230x55.png 230w, https://ataspinar.com/wp-content/uploads/2018/09/continuous_transform-350x84.png 350w" sizes="(max-width: 393px) 100vw, 393px" /></a></p>
<p>where <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-8f4c9800c3c4ee32f863c3c3d7b3640d_l3.svg" class="ql-img-inline-formula " alt="&#92;&#112;&#115;&#105;&#40;&#116;&#41;" title="Rendered by QuickLaTeX.com" height="18" width="31" style="vertical-align: -4px;"/> is the continuous mother wavelet which gets scaled by a factor of <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-c63f5a3a084d567b6d62758d1c9bc8b8_l3.svg" class="ql-img-inline-formula " alt="&#97;" title="Rendered by QuickLaTeX.com" height="8" width="9" style="vertical-align: 0px;"/> and translated by a factor of <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-173b5c22c5ff048f406b49d642c938f4_l3.svg" class="ql-img-inline-formula " alt="&#98;" title="Rendered by QuickLaTeX.com" height="13" width="8" style="vertical-align: 0px;"/>. The values of the scaling and translation factors are continuous, which means that there can be an infinite amount of wavelets. You can scale the mother wavelet with a factor of 1.3, or 1.31, and 1.311, and 1.3111 etc.</p>
<p>When we are talking about the Discrete Wavelet Transform, the main difference is that the DWT uses discrete values for the scale and translation factor. The scale factor increases in powers of two, so <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-003eccf6cc8fcdbc3ead4a402ca05c30_l3.svg" class="ql-img-inline-formula " alt="&#97;&#32;&#61;&#32;&#49;&#44;&#32;&#50;&#44;&#32;&#52;&#44;&#32;&#46;&#46;" title="Rendered by QuickLaTeX.com" height="16" width="92" style="vertical-align: -4px;"/> and the translation factor increases integer values ( <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-01781c784d62dccf6c86516196b6f3b3_l3.svg" class="ql-img-inline-formula " alt="&#98;&#32;&#61;&#32;&#49;&#44;&#32;&#50;&#44;&#32;&#51;&#32;&#46;&#46;" title="Rendered by QuickLaTeX.com" height="17" width="83" style="vertical-align: -4px;"/> ).</p>
<p><strong>PS:</strong>  The DWT is only discrete in the scale and translation domain, not in the time-domain. To be able to work with digital and discrete signals we also need to discretize our wavelet transforms in the time-domain. These forms of the wavelet transform are called the Discrete-Time Wavelet Transform and the Discrete-Time Continuous Wavelet Transform.</p>
<h2>2.5 More on the Discrete Wavelet Transform: The DWT as a filter-bank.</h2>
<p>In practice, the DWT is always implemented as a <a href="https://en.wikipedia.org/wiki/Filter_bank" target="_blank" rel="noopener">filter-bank</a>. This means that it is implemented as a cascade of high-pass and low-pass filters. This is because filter banks are a very efficient way of splitting a signal of into several frequency sub-bands.<br />
Below I will try to explain the concept behind the filter-bank in a simple (and probably oversimplified) way. It is necessary in order to understand how the wavelet transform actually works and can be used in practical applications.</p>
<p>To apply the DWT on a signal, we start with the smallest scale. As we have seen before, small scales correspond with high frequencies. This means that we first analyze high frequency behavior. At the second stage, the scale increases with a factor of two (the frequency decreases with a factor of two), and we are analyzing behavior around half of the maximum frequency. At the third stage, the scale factor is four and we are analyzing frequency behavior around a quarter of the maximum frequency. And this goes on and on, until we have reached the maximum decomposition level.</p>
<p>What do we mean with maximum decomposition level?  To understand this we should also know that at each subsequent stage the number of samples in the signal is reduced with a factor of two. At lower frequency values, you will need less samples to satisfy the <a href="https://en.wikipedia.org/wiki/Nyquist_rate" target="_blank" rel="noopener">Nyquist rate </a>so there is no need to keep the higher number of samples in the signal; it will only cause the transform to be computationally expensive. Due to this downsampling, at some stage in the process the number of samples in our signal will become smaller than the length of the wavelet filter and we will have reached the maximum decomposition level.</p>
<p>To give an example, suppose we have a signal with frequencies up to 1000 Hz. In the first stage we split our signal into a low-frequency part and a high-frequency part, i.e. 0-500 Hz and 500-1000 Hz.<br />
At the second stage we take the low-frequency part and again split it into two parts: 0-250 Hz and 250-500 Hz.<br />
At the third stage we split the 0-250 Hz part into a 0-125 Hz part and a 125-250 Hz part.<br />
This goes on until we have reached the level of refinement we need or until we run out of samples.</p>
<p>We can easily visualize this idea, by plotting what happens when we apply the DWT on a <a href="https://en.wikipedia.org/wiki/Chirp" target="_blank" rel="noopener">chirp signal</a>. A chirp signal is a signal with a dynamic frequency spectrum; the frequency spectrum increases with time. The start of the signal contains low frequency values and the end of the signal contains the high frequencies. This makes it easy for us to visualize which part of the frequency spectrum is filtered out by simply looking at the time-axis.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9361488488518" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import pywt

x = np.linspace(0, 1, num=2048)
chirp_signal = np.sin(250 * np.pi * x**2)
    
fig, ax = plt.subplots(figsize=(6,1))
ax.set_title("Original Chirp Signal: ")
ax.plot(chirp_signal)
plt.show()
    
data = chirp_signal
waveletname = 'sym5'

fig, axarr = plt.subplots(nrows=5, ncols=2, figsize=(6,6))
for ii in range(5):
    (data, coeff_d) = pywt.dwt(data, waveletname)
    axarr[ii, 0].plot(data, 'r')
    axarr[ii, 1].plot(coeff_d, 'g')
    axarr[ii, 0].set_ylabel("Level {}".format(ii + 1), fontsize=14, rotation=90)
    axarr[ii, 0].set_yticklabels([])
    if ii == 0:
        axarr[ii, 0].set_title("Approximation coefficients", fontsize=14)
        axarr[ii, 1].set_title("Detail coefficients", fontsize=14)
    axarr[ii, 1].set_yticklabels([])
plt.tight_layout()
plt.show()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-24">24</div><div class="crayon-num" data-line="crayon-622c62a9a9361488488518-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9361488488518-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9361488488518-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">pywt</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-2">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9361488488518-3"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-o">=</span><span class="crayon-cn">2048</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-4"><span class="crayon-v">chirp_signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sin</span><span class="crayon-sy">(</span><span class="crayon-cn">250</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-6"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-7"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-s">"Original Chirp Signal: "</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-8"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">chirp_signal</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-9"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-11"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">chirp_signal</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-12"><span class="crayon-v">waveletname</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'sym5'</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-14"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axarr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">nrows</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ncols</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-15"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">ii </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">coeff_d</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">dwt</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">waveletname</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">coeff_d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'g'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">"Level {}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">ii</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-o">=</span><span class="crayon-cn">90</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_yticklabels</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">ii</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-s">"Approximation coefficients"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-s">"Detail coefficients"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axarr</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_yticklabels</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9361488488518-25"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">tight_layout</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9361488488518-26"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0058 seconds] -->
<p><figure id="attachment_4052" aria-describedby="caption-attachment-4052" style="width: 1024px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic.png"><img loading="lazy" class="size-large wp-image-4052" src="https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic-1024x670.png" alt="" width="1024" height="670" srcset="https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic-1024x670.png 1024w, https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic-300x196.png 300w, https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic-768x502.png 768w, https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic-830x543.png 830w, https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic-230x150.png 230w, https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic-350x229.png 350w, https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic-480x314.png 480w, https://ataspinar.com/wp-content/uploads/2018/09/multilevel_coefficients_schematic.png 1087w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-4052" class="wp-caption-text">Figure 7. The approximation and detail coefficients of the sym5 wavelet (level 1 to 5) applied on a chirp signal, from level 1 to 5. On the left we can see a schematic representation of the high pass and low pass filters applied on the signal at each level.</figcaption></figure></p>
<p>In Figure 7 we can see our chirp signal, and the DWT applied to it subsequently. There are a few things to notice here:</p>
<ul>
<li>In PyWavelets the DWT is applied with <code><a href="https://pywavelets.readthedocs.io/en/latest/ref/dwt-discrete-wavelet-transform.html" target="_blank" rel="noopener">pywt.dwt()</a></code></li>
<li>The DWT return two sets of coefficients; the <span style="color: #ff0000;"><strong>approximation</strong></span> coefficients and <span style="color: #339966;"><strong>detail</strong></span> coefficients.</li>
<li>The <strong><span style="color: #ff0000;">approximation coefficients</span></strong> represent the output of the low pass filter (averaging filter) of the DWT.</li>
<li>The <span style="color: #008000;"><strong>detail coefficients</strong></span> represent the output of the high pass filter (difference filter) of the DWT.</li>
<li>By applying the DWT again on the approximation coefficients of the previous DWT, we get the wavelet transform of the next level.</li>
<li>At each next level, the original signal is also sampled down by a factor of 2.</li>
</ul>
<p>So now we have seen what it means that the DWT is implemented as a filter bank; At each subsequent level, the approximation coefficients are divided into a coarser low pass and high pass part and the DWT is applied again on the low-pass part.</p>
<p>As we can see, our original signal is now converted to several signals each corresponding to different frequency bands. Later on we will see how the approximation and detail coefficients at the different frequency sub-bands can be used in applications like removing high frequency noise from signals, compressing signals, or classifying the different types signals.</p>
<p><strong>PS:</strong> We can also use <code><a href="https://pywavelets.readthedocs.io/en/latest/ref/dwt-discrete-wavelet-transform.html#multilevel-decomposition-using-wavedec" target="_blank" rel="noopener">pywt.wavedec()</a></code> to immediately calculate the coefficients of a higher level. This functions takes as input the original signal and the level <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-a63eb5ff0272d3119fa684be6e7acce8_l3.svg" class="ql-img-inline-formula " alt="&#110;" title="Rendered by QuickLaTeX.com" height="8" width="11" style="vertical-align: 0px;"/> and returns the one set of approximation coefficients (of the n-th level) and n sets of detail coefficients (1 to n-th level).</p>
<p><strong>PS2:</strong> This idea of analyzing the signal on different scales is also known as <a href="https://en.wikipedia.org/wiki/Multiresolution_analysis" target="_blank" rel="noopener">multiresolution / multiscale analysis</a>, and decomposing your signal in such a way is also known as multiresolution decomposition, or <a href="https://en.wikipedia.org/wiki/Sub-band_coding" target="_blank" rel="noopener">sub-band coding</a>.</p>
<h2>3.1 Visualizing the State-Space using the Continuous Wavelet Transform</h2>
<p>So far we have seen what the wavelet transform is, how it is different from the Fourier Transform, what the difference is between the CWT and the DWT, what types of wavelet families there are, what the impact of the order and level of decomposition is on the mother wavelet, and how and why the DWT is implemented as a filter-bank.</p>
<p>We have also seen that the output of a wavelet transform on a 1D signal results in a 2D scaleogram. Such a scaleogram gives us detailed information about the state-space of the system, i.e. it gives us information about the dynamic behavior of the system.</p>
<p>The el-Nino dataset is a time-series dataset used for tracking the <a href="https://en.wikipedia.org/wiki/El_Ni%C3%B1o" target="_blank" rel="noopener">El Nino</a> and contains quarterly measurements of the sea surface temperature from 1871 up to 1997. In order to understand the power of a scaleogram, let us visualize it for el-Nino dataset together with the original time-series data and its Fourier Transform.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9368184108752" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def plot_wavelet(time, signal, scales, 
                 waveletname = 'cmor', 
                 cmap = plt.cm.seismic, 
                 title = 'Wavelet Transform (Power Spectrum) of signal', 
                 ylabel = 'Period (years)', 
                 xlabel = 'Time'):
    
    dt = time[1] - time[0]
    [coefficients, frequencies] = pywt.cwt(signal, scales, waveletname, dt)
    power = (abs(coefficients)) ** 2
    period = 1. / frequencies
    levels = [0.0625, 0.125, 0.25, 0.5, 1, 2, 4, 8]
    contourlevels = np.log2(levels)
    
    fig, ax = plt.subplots(figsize=(15, 10))
    im = ax.contourf(time, np.log2(period), np.log2(power), contourlevels, extend='both',cmap=cmap)
    
    ax.set_title(title, fontsize=20)
    ax.set_ylabel(ylabel, fontsize=18)
    ax.set_xlabel(xlabel, fontsize=18)
    
    yticks = 2**np.arange(np.ceil(np.log2(period.min())), np.ceil(np.log2(period.max())))
    ax.set_yticks(np.log2(yticks))
    ax.set_yticklabels(yticks)
    ax.invert_yaxis()
    ylim = ax.get_ylim()
    ax.set_ylim(ylim[0], -1)
    
    cbar_ax = fig.add_axes([0.95, 0.5, 0.03, 0.25])
    fig.colorbar(im, cax=cbar_ax, orientation="vertical")
    plt.show()

def plot_signal_plus_average(time, signal, average_over = 5):
    fig, ax = plt.subplots(figsize=(15, 3))
    time_ave, signal_ave = get_ave_values(time, signal, average_over)
    ax.plot(time, signal, label='signal')
    ax.plot(time_ave, signal_ave, label = 'time average (n={})'.format(5))
    ax.set_xlim([time[0], time[-1]])
    ax.set_ylabel('Signal Amplitude', fontsize=18)
    ax.set_title('Signal + Time Average', fontsize=18)
    ax.set_xlabel('Time', fontsize=18)
    ax.legend()
    plt.show()
    
def get_fft_values(y_values, T, N, f_s):
    f_values = np.linspace(0.0, 1.0/(2.0*T), N//2)
    fft_values_ = fft(y_values)
    fft_values = 2.0/N * np.abs(fft_values_[0:N//2])
    return f_values, fft_values

def plot_fft_plus_power(time, signal):
    dt = time[1] - time[0]
    N = len(signal)
    fs = 1/dt
    
    fig, ax = plt.subplots(figsize=(15, 3))
    variance = np.std(signal)**2
    f_values, fft_values = get_fft_values(signal, dt, N, fs)
    fft_power = variance * abs(fft_values) ** 2     # FFT power spectrum
    ax.plot(f_values, fft_values, 'r-', label='Fourier Transform')
    ax.plot(f_values, fft_power, 'k--', linewidth=1, label='FFT Power Spectrum')
    ax.set_xlabel('Frequency [Hz / year]', fontsize=18)
    ax.set_ylabel('Amplitude', fontsize=18)
    ax.legend()
    plt.show()

dataset = "http://paos.colorado.edu/research/wavelets/wave_idl/sst_nino3.dat"
df_nino = pd.read_table(dataset)
N = df_nino.shape[0]
t0=1871
dt=0.25
time = np.arange(0, N) * dt + t0
signal = df_nino.values.squeeze()

scales = np.arange(1, 128)
plot_signal_plus_average(time, signal)
plot_fft_plus_power(time, signal)
plot_wavelet(time, signal, scales)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-24">24</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-26">26</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-28">28</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-30">30</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-32">32</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-34">34</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-36">36</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-38">38</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-40">40</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-42">42</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-44">44</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-46">46</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-48">48</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-50">50</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-52">52</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-54">54</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-56">56</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-58">58</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-60">60</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-62">62</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-64">64</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-66">66</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-68">68</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-70">70</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-72">72</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-74">74</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-76">76</div><div class="crayon-num" data-line="crayon-622c62a9a9368184108752-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9368184108752-78">78</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9368184108752-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">plot_wavelet</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scales</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">waveletname</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'cmor'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-v">cm</span><span class="crayon-sy">.</span><span class="crayon-v">seismic</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Wavelet Transform (Power Spectrum) of signal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">ylabel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Period (years)'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">xlabel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Time'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-v">coefficients</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frequencies</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">cwt</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scales</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">waveletname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dt</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">power</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">abs</span><span class="crayon-sy">(</span><span class="crayon-v">coefficients</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">period</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1.</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">frequencies</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-12"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">levels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.0625</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.125</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">contourlevels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log2</span><span class="crayon-sy">(</span><span class="crayon-v">levels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">im</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">contourf</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log2</span><span class="crayon-sy">(</span><span class="crayon-v">period</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log2</span><span class="crayon-sy">(</span><span class="crayon-v">power</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">contourlevels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">extend</span><span class="crayon-o">=</span><span class="crayon-s">'both'</span><span class="crayon-sy">,</span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">cmap</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-v">title</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-v">ylabel</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlabel</span><span class="crayon-sy">(</span><span class="crayon-v">xlabel</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">yticks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">arange</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">ceil</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log2</span><span class="crayon-sy">(</span><span class="crayon-v">period</span><span class="crayon-sy">.</span><span class="crayon-k ">min</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">ceil</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log2</span><span class="crayon-sy">(</span><span class="crayon-v">period</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_yticks</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log2</span><span class="crayon-sy">(</span><span class="crayon-v">yticks</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_yticklabels</span><span class="crayon-sy">(</span><span class="crayon-v">yticks</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">invert_yaxis</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ylim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">get_ylim</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylim</span><span class="crayon-sy">(</span><span class="crayon-v">ylim</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cbar_ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">add_axes</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0.95</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.03</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">colorbar</span><span class="crayon-sy">(</span><span class="crayon-v">im</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cax</span><span class="crayon-o">=</span><span class="crayon-v">cbar_ax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">orientation</span><span class="crayon-o">=</span><span class="crayon-s">"vertical"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-32">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9368184108752-33"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">plot_signal_plus_average</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">average_over</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">time_ave</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">signal_ave</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_ave_values</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">average_over</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'signal'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">time_ave</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">signal_ave</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'time average (n={})'</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlim</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-k ">time</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Signal Amplitude'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-s">'Signal + Time Average'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Time'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-45"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get_fft_values</span><span class="crayon-sy">(</span><span class="crayon-v">y_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">T</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">N</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">f_s</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">f_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-cn">2.0</span><span class="crayon-o">*</span><span class="crayon-v">T</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">N</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fft_values_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">fft</span><span class="crayon-sy">(</span><span class="crayon-v">y_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fft_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span><span class="crayon-o">/</span><span class="crayon-v">N</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">abs</span><span class="crayon-sy">(</span><span class="crayon-v">fft_values_</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">N</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">f_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">fft_values</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-50">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9368184108752-51"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">plot_fft_plus_power</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">signal</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">N</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-e">dt</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-55"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-56"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">variance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">f_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fft_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_fft_values</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">N</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fft_power</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">variance</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">abs</span><span class="crayon-sy">(</span><span class="crayon-v">fft_values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c"># FFT power spectrum</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">f_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fft_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r-'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'Fourier Transform'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">f_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fft_power</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'k--'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linewidth</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'FFT Power Spectrum'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Frequency [Hz / year]'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Amplitude'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-66">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9368184108752-67"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"http://paos.colorado.edu/research/wavelets/wave_idl/sst_nino3.dat"</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-68"><span class="crayon-v">df_nino</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_table</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-69"><span class="crayon-v">N</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df_nino</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-70"><span class="crayon-v">t0</span><span class="crayon-o">=</span><span class="crayon-cn">1871</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-71"><span class="crayon-v">dt</span><span class="crayon-o">=</span><span class="crayon-cn">0.25</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-72"><span class="crayon-k ">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">arange</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">N</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">dt</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">t0</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-73"><span class="crayon-k ">signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df_nino</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">squeeze</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-74">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9368184108752-75"><span class="crayon-v">scales</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">arange</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-76"><span class="crayon-e">plot_signal_plus_average</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">signal</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9368184108752-77"><span class="crayon-e">plot_fft_plus_power</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">signal</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9368184108752-78"><span class="crayon-e">plot_wavelet</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scales</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0178 seconds] -->
<p><figure id="attachment_4059" aria-describedby="caption-attachment-4059" style="width: 755px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/09/el_nino_scaleogram.png"><img loading="lazy" class="size-full wp-image-4059" src="https://ataspinar.com/wp-content/uploads/2018/09/el_nino_scaleogram.png" alt="" width="755" height="826" srcset="https://ataspinar.com/wp-content/uploads/2018/09/el_nino_scaleogram.png 755w, https://ataspinar.com/wp-content/uploads/2018/09/el_nino_scaleogram-274x300.png 274w, https://ataspinar.com/wp-content/uploads/2018/09/el_nino_scaleogram-230x252.png 230w, https://ataspinar.com/wp-content/uploads/2018/09/el_nino_scaleogram-350x383.png 350w, https://ataspinar.com/wp-content/uploads/2018/09/el_nino_scaleogram-480x525.png 480w" sizes="(max-width: 755px) 100vw, 755px" /></a><figcaption id="caption-attachment-4059" class="wp-caption-text">Figure 8. el-Nino dataset (on top), with the Fourier Transform (middle) and the Continuous Wavelet Transform (bottom).</figcaption></figure></p>
<p>In Figure 8 we can see in the top figure the el-Nino dataset together with its time average, in the middle figure the Fourier Transform and at the bottom figure the scaleogram produced by the Continuous Wavelet Transform.</p>
<p>In the scaleogram we can see that most of the power is concentrated in a 2-8 year period. If we convert this to frequency (T = 1 / f) this corresponds with a frequency of 0.125 &#8211; 0.5 Hz. The increase in power can also be seen in the Fourier transform around these frequency values. The main difference is that the wavelet transform also gives us temporal information and the Fourier Transform does not. For example, in the scaleogram we can see that up to 1920 there were many fluctuations, while there were not so much between 1960 &#8211; 1990. We can also see that there is a shift from shorter to longer periods as time progresses. This is the kind of dynamic behavior in the signal which can be visualized with the Wavelet Transform but not with the Fourier Transform.</p>
<p>This should already make clear how powerful the wavelet transform can be for machine learning purposes. But to make the story complete, let us also look at how this can be used in combination with a Convolutional Neural Network to classify signals.</p>
<h2>3.2 Using the Continuous Wavelet Transform and a Convolutional Neural Network for classification of signals</h2>
<p>In section 3.1 we have seen that the wavelet transform of a 1D signal results in a 2D scaleogram which contains a lot more information than just the time-series or just the Fourier Transform. We have seen that applied on the el-Nino dataset, it can not only tell us what the period is of the largest oscillations, but also when these oscillations were present and when not.</p>
<p>Such a scaleogram can not only be used to better understand the dynamical behavior of a system, but it can also be used to distinguish different types of signals produced by a system from each other.<br />
If you record a signal while you are walking up the stairs or down the stairs, the scaleograms will look different. ECG measurements of people with a healthy heart will have different scaleograms than ECG measurements of people with arrhythmia. Or measurements on a bearing, motor, rotor, ventilator, etc when it is faulty vs when it not faulty. The possibilities are limitless!</p>
<p>So by looking at the scaleograms we can distinguish a broken motor from a working one, a healthy person from a sick one, a person walking up the stairs from a person walking down the stairs, etc etc. But if you are as lazy as me, you probably don&#8217;t want to sift through thousands of scaleograms manually. One way to automate this process is to build a Convolutional Neural Network which can automatically detect the class each scaleogram belongs to and classify them accordingly.</p>
<p>What was the deal again with CNN? In previous blog posts we have seen how we can use Tensorflow to <a href="https://ataspinar.com/2017/08/15/building-convolutional-neural-networks-with-tensorflow/" target="_blank" rel="noopener">build a convolutional neural network from scratch</a>. And how we can use such a CNN to <a href="https://ataspinar.com/2017/12/04/using-convolutional-neural-networks-to-detect-features-in-sattelite-images/" target="_blank" rel="noopener">detect roads in satellite images</a>. If you are not familiar with CNN&#8217;s it is a good idea to have a look at these previous blog posts, since the rest of this section assumes you have some knowledge of CNN&#8217;s.</p>
<p>In the next few sections we will load a dataset (containing measurement of people doing six different activities), visualize the scaleograms using the CWT and then use a Convolutional Neural Network to classify these scaleograms.</p>
<h3>3.2.1. Loading the UCI-HAR time-series dataset</h3>
<p>Let us try to classify an open dataset containing time-series using the scaleograms and a CNN. The <a href="https://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones" target="_blank" rel="noopener">Human Activity Recognition Dataset (UCI-HAR) </a> contains sensor measurements of people while they were doing different types of activities, like walking up or down the stairs, laying, standing, walking, etc. There are in total more than 10.000 signals where each signal consists of nine components (x acceleration, y acceleration, z acceleration, x,y,z gyroscope, etc). This is the perfect dataset for us to try our use case of CWT + CNN!</p>
<p><strong>PS: </strong>For more on how the UCI HAR dataset looks like, you can also have a look at the <a href="https://ataspinar.com/2018/04/04/machine-learning-with-signal-processing-techniques/" target="_blank" rel="noopener">previous blog post</a> in which it was described in more detail.</p>
<p>After we have downloaded the data, we can load it into a numpy nd-array in the following way:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9372814364670" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def read_signals_ucihar(filename):
    with open(filename, 'r') as fp:
        data = fp.read().splitlines()
        data = map(lambda x: x.rstrip().lstrip().split(), data)
        data = [list(map(float, line)) for line in data]
    return data

def read_labels_ucihar(filename):        
    with open(filename, 'r') as fp:
        activities = fp.read().splitlines()
        activities = list(map(int, activities))
    return activities

def load_ucihar_data(folder):
    train_folder = folder + 'train/InertialSignals/'
    test_folder = folder + 'test/InertialSignals/'
    labelfile_train = folder + 'train/y_train.txt'
    labelfile_test = folder + 'test/y_test.txt'
    train_signals, test_signals = [], []
    for input_file in os.listdir(train_folder):
        signal = read_signals_ucihar(train_folder + input_file)
        train_signals.append(signal)
    train_signals = np.transpose(np.array(train_signals), (1, 2, 0))
    for input_file in os.listdir(test_folder):
        signal = read_signals_ucihar(test_folder + input_file)
        test_signals.append(signal)
    test_signals = np.transpose(np.array(test_signals), (1, 2, 0))
    train_labels = read_labels_ucihar(labelfile_train)
    test_labels = read_labels_ucihar(labelfile_test)
    return train_signals, train_labels, test_signals, test_labels

folder_ucihar = './data/UCI_HAR/' 
train_signals_ucihar, train_labels_ucihar, test_signals_ucihar, test_labels_ucihar = load_ucihar_data(folder_ucihar)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-24">24</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-26">26</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-28">28</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-30">30</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9372814364670-32">32</div><div class="crayon-num" data-line="crayon-622c62a9a9372814364670-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9372814364670-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">read_signals_ucihar</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">fp</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">splitlines</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-e">rstrip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">lstrip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-k ">float</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">data</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-8"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">read_labels_ucihar</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">fp</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">splitlines</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-k ">int</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activities</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">activities</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-14"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">load_ucihar_data</span><span class="crayon-sy">(</span><span class="crayon-v">folder</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">train_folder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">folder</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'train/InertialSignals/'</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_folder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">folder</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'test/InertialSignals/'</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">labelfile_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">folder</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'train/y_train.txt'</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">labelfile_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">folder</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'test/y_test.txt'</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">train_signals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_signals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">input_file </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">os</span><span class="crayon-sy">.</span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">train_folder</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_signals_ucihar</span><span class="crayon-sy">(</span><span class="crayon-v">train_folder</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">input_file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">train_signals</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">train_signals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">transpose</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">train_signals</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">input_file </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">os</span><span class="crayon-sy">.</span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">test_folder</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_signals_ucihar</span><span class="crayon-sy">(</span><span class="crayon-v">test_folder</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">input_file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_signals</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_signals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">transpose</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">test_signals</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">train_labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_labels_ucihar</span><span class="crayon-sy">(</span><span class="crayon-v">labelfile_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_labels_ucihar</span><span class="crayon-sy">(</span><span class="crayon-v">labelfile_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_signals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_signals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_labels</span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9372814364670-32"><span class="crayon-v">folder_ucihar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'./data/UCI_HAR/'</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-622c62a9a9372814364670-33"><span class="crayon-v">train_signals_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_labels_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_signals_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_labels_ucihar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_ucihar_data</span><span class="crayon-sy">(</span><span class="crayon-v">folder_ucihar</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0074 seconds] -->
<p>The training set contains 7352 signals where each signal has 128 measurement samples and 9 components. The signals from the training set are loaded into a numpy ndarray of size (7352 , 128, 9) and the signals from the test set into one of size (2947 , 128, 9).</p>
<p>Since the signal consists of nine components we have to apply the CWT nine times for each signal. Below we can see the result of the CWT applied on two different signals from the dataset. The left one consist of a signal measured while walking up the stairs and the right one is a signal measured while laying down.</p>
<p><a href="https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs.png"><img loading="lazy" class="wp-image-4088 size-medium" src="https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs-300x300.png" alt="" width="300" height="300" srcset="https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs-300x300.png 300w, https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs-150x150.png 150w, https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs-768x768.png 768w, https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs-830x830.png 830w, https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs-230x230.png 230w, https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs-350x350.png 350w, https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs-480x480.png 480w, https://ataspinar.com/wp-content/uploads/2018/12/1_walking-upstairs.png 864w" sizes="(max-width: 300px) 100vw, 300px" /></a><a href="https://ataspinar.com/wp-content/uploads/2018/12/2_laying.png"><img loading="lazy" class="alignnone wp-image-4089 size-medium" src="https://ataspinar.com/wp-content/uploads/2018/12/2_laying-300x300.png" alt="" width="300" height="300" srcset="https://ataspinar.com/wp-content/uploads/2018/12/2_laying-300x300.png 300w, https://ataspinar.com/wp-content/uploads/2018/12/2_laying-150x150.png 150w, https://ataspinar.com/wp-content/uploads/2018/12/2_laying-768x768.png 768w, https://ataspinar.com/wp-content/uploads/2018/12/2_laying-830x830.png 830w, https://ataspinar.com/wp-content/uploads/2018/12/2_laying-230x230.png 230w, https://ataspinar.com/wp-content/uploads/2018/12/2_laying-350x350.png 350w, https://ataspinar.com/wp-content/uploads/2018/12/2_laying-480x480.png 480w, https://ataspinar.com/wp-content/uploads/2018/12/2_laying.png 864w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Figure 9. The CWT applied on two signals belonging to the UCI HAR dataset. Each signal has nine different components. On the left we can see the signals measured during walking upstairs and on the right we can see a signal measured during laying.</p>
<h3>3.2.2 Applying the CWT on the dataset and transforming the data to the right format</h3>
<p>Since each signal has nine components, each signal will also have nine scaleograms. So the next question to ask is, how do we feed this set of nine scaleograms into a Convolutional Neural Network? There are several options we could follow:</p>
<ol>
<li>Train a CNN for each component separately and combine the results of the nine CNN&#8217;s in some sort of an ensembling method. I suspect that this will generally result in a poorer performance since the inter dependencies between the different components are not taken into account.</li>
<li>Concatenate the nine different signals into one long signal and apply the CWT on the concatenated signal. This <em>could</em> work but there will be discontinuities at location where two signals are concatenated and this will introduced noise in the scaleogram at the boundary locations of the component signals.</li>
<li>Calculate the CWT first and thén concatenate the nine different CWT images into one and feed that into the CNN. This could also work, but here there will also be discontinuities at the boundaries of the CWT images which will feed noise into the CNN. If the CNN is deep enough, it will be able to distinguish between these noisy parts and actually useful parts of the image and choose to ignore the noise. But I still prefer option number four:</li>
<li>Place the nine scaleograms on top of each other and create one single image with nine channels. What does this mean? Well, normally an image has either one channel (grayscale image) or three channels (color image), but our CNN can just as easily handle images with nine channels. The way the CNN works remains exactly the same, the only difference is that there will be three times more filters compared to an RGB image.</li>
</ol>
<p>This process is illustrated in the Figure 11.</p>
<figure id="attachment_4090" aria-describedby="caption-attachment-4090" style="width: 1024px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN.png"><img loading="lazy" class="wp-image-4090 size-large" src="https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN-1024x291.png" alt="" width="1024" height="291" srcset="https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN-1024x291.png 1024w, https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN-300x85.png 300w, https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN-768x218.png 768w, https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN-830x236.png 830w, https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN-230x65.png 230w, https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN-350x99.png 350w, https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN-480x136.png 480w, https://ataspinar.com/wp-content/uploads/2018/12/9layer_image_CNN.png 1184w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption id="caption-attachment-4090" class="wp-caption-text">Figure 10. We will use the nine CWT from the nine components to create a nine-channel image which is used as input for a Convolutional Neural Network.</figcaption></figure>
<p>Below we can see the Python code on how to apply the CWT on the signals in the dataset, and reformat it in such a way that it can be used as input for our Convolutional Neural Network. The total dataset contains over 10.000 signals, but we will only use 5.000 signals in our training set and 500 signals in our test set.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9379097928135" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
scales = range(1,128)
waveletname = 'morl'
train_size = 5000
test_size= 500

train_data_cwt = np.ndarray(shape=(train_size, 127, 127, 9))

for ii in range(0,train_size):
    if ii % 1000 == 0:
        print(ii)
    for jj in range(0,9):
        signal = uci_har_signals_train[ii, :, jj]
        coeff, freq = pywt.cwt(signal, scales, waveletname, 1)
        coeff_ = coeff[:,:127]
        train_data_cwt[ii, :, :, jj] = coeff_

test_data_cwt = np.ndarray(shape=(test_size, 127, 127, 9))
for ii in range(0,test_size):
    if ii % 100 == 0:
        print(ii)
    for jj in range(0,9):
        signal = uci_har_signals_test[ii, :, jj]
        coeff, freq = pywt.cwt(signal, scales, waveletname, 1)
        coeff_ = coeff[:,:127]
        test_data_cwt[ii, :, :, jj] = coeff_

uci_har_labels_train = list(map(lambda x: int(x) - 1, uci_har_labels_train))
uci_har_labels_test = list(map(lambda x: int(x) - 1, uci_har_labels_test))

x_train = train_data_cwt
y_train = list(uci_har_labels_train[:train_size])
x_test = test_data_cwt
y_test = list(uci_har_labels_test[:test_size])</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-24">24</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-26">26</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-28">28</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-30">30</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9379097928135-32">32</div><div class="crayon-num" data-line="crayon-622c62a9a9379097928135-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9379097928135-1"><span class="crayon-v">scales</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">128</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-2"><span class="crayon-v">waveletname</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'morl'</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-3"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-4"><span class="crayon-v">test_size</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-6"><span class="crayon-v">train_data_cwt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">ndarray</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">127</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">127</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-8"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">ii </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-v">train_size</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">ii</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">ii</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">jj </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">uci_har_signals_train</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">jj</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coeff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">freq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">cwt</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scales</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">waveletname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coeff_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coeff</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-cn">127</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">train_data_cwt</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">jj</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">coeff_</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-16">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9379097928135-17"><span class="crayon-v">test_data_cwt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">ndarray</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">test_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">127</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">127</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-18"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">ii </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-v">test_size</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">ii</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">ii</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">jj </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">uci_har_signals_test</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">jj</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coeff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">freq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">cwt</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scales</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">waveletname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coeff_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coeff</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-cn">127</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_data_cwt</span><span class="crayon-sy">[</span><span class="crayon-v">ii</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">jj</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">coeff_</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-26">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9379097928135-27"><span class="crayon-v">uci_har_labels_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">uci_har_labels_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-28"><span class="crayon-v">uci_har_labels_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">uci_har_labels_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-30"><span class="crayon-v">x_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_data_cwt</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-31"><span class="crayon-v">y_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">uci_har_labels_train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9379097928135-32"><span class="crayon-v">x_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_data_cwt</span></div><div class="crayon-line" id="crayon-622c62a9a9379097928135-33"><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">uci_har_labels_test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">test_size</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0071 seconds] -->
<p>As you can see above, the CWT of a single signal-component (128 samples) results in an image of 127 by 127 pixels. So the scaleograms coming from the 5000 signals of the training dataset are stored in an numpy ndarray of size (5000, 127, 127, 9) and the scaleograms coming from the 500 test signals are stored in one of size (500, 127, 127, 9).</p>
<h3>3.2.3 Training the Convolutional Neural Network with the CWT</h3>
<p>Now that we have the data in the right format, we can start with the most interesting part of this section: training the CNN! For this part you will need the <a href="https://keras.io/#installation" target="_blank" rel="noopener">keras library</a>, so please install it first.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a937d508940837" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import keras
from keras.layers import Dense, Flatten
from keras.layers import Conv2D, MaxPooling2D
from keras.models import Sequential
from keras.callbacks import History 
history = History()

img_x = 127
img_y = 127
img_z = 9
input_shape = (img_x, img_y, img_z)

num_classes = 6
batch_size = 16
num_classes = 7
epochs = 10

x_train = x_train.astype('float32')
x_test = x_test.astype('float32')

y_train = keras.utils.to_categorical(y_train, num_classes)
y_test = keras.utils.to_categorical(y_test, num_classes)


model = Sequential()
model.add(Conv2D(32, kernel_size=(5, 5), strides=(1, 1),
                 activation='relu',
                 input_shape=input_shape))
model.add(MaxPooling2D(pool_size=(2, 2), strides=(2, 2)))
model.add(Conv2D(64, (5, 5), activation='relu'))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Flatten())
model.add(Dense(1000, activation='relu'))
model.add(Dense(num_classes, activation='softmax'))

model.compile(loss=keras.losses.categorical_crossentropy,
              optimizer=keras.optimizers.Adam(),
              metrics=['accuracy'])


model.fit(x_train, y_train,
          batch_size=batch_size,
          epochs=epochs,
          verbose=1,
          validation_data=(x_test, y_test),
          callbacks=[history])

train_score = model.evaluate(x_train, y_train, verbose=0)
print('Train loss: {}, Train accuracy: {}'.format(train_score[0], train_score[1]))
test_score = model.evaluate(x_test, y_test, verbose=0)
print('Test loss: {}, Test accuracy: {}'.format(test_score[0], test_score[1]))

*** Epoch 1/10
*** 5000/5000 [==============================] - 235s 47ms/step - loss: 0.3963 - acc: 0.8876 - val_loss: 0.6006 - val_acc: 0.8780
*** Epoch 2/10
*** 5000/5000 [==============================] - 228s 46ms/step - loss: 0.1939 - acc: 0.9282 - val_loss: 0.3952 - val_acc: 0.8880
*** Epoch 3/10
*** 5000/5000 [==============================] - 224s 45ms/step - loss: 0.1347 - acc: 0.9434 - val_loss: 0.4367 - val_acc: 0.9100
*** Epoch 4/10
*** 5000/5000 [==============================] - 228s 46ms/step - loss: 0.1971 - acc: 0.9334 - val_loss: 0.2662 - val_acc: 0.9320
*** Epoch 5/10
*** 5000/5000 [==============================] - 231s 46ms/step - loss: 0.1134 - acc: 0.9544 - val_loss: 0.2131 - val_acc: 0.9320
*** Epoch 6/10
*** 5000/5000 [==============================] - 230s 46ms/step - loss: 0.1285 - acc: 0.9520 - val_loss: 0.2014 - val_acc: 0.9440
*** Epoch 7/10
*** 5000/5000 [==============================] - 232s 46ms/step - loss: 0.1339 - acc: 0.9532 - val_loss: 0.2884 - val_acc: 0.9300
*** Epoch 8/10
*** 5000/5000 [==============================] - 237s 47ms/step - loss: 0.1503 - acc: 0.9488 - val_loss: 0.3181 - val_acc: 0.9340
*** Epoch 9/10
*** 5000/5000 [==============================] - 250s 50ms/step - loss: 0.1247 - acc: 0.9504 - val_loss: 0.2403 - val_acc: 0.9460
*** Epoch 10/10
*** 5000/5000 [==============================] - 238s 48ms/step - loss: 0.1578 - acc: 0.9508 - val_loss: 0.2133 - val_acc: 0.9300
*** Train loss: 0.11115437872409821, Train accuracy: 0.959
*** Test loss: 0.21326758581399918, Test accuracy: 0.93</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-24">24</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-26">26</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-28">28</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-30">30</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-32">32</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-34">34</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-36">36</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-38">38</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-40">40</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-42">42</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-44">44</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-46">46</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-48">48</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-50">50</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-52">52</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-54">54</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-56">56</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-58">58</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-60">60</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-62">62</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-64">64</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-66">66</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-68">68</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-70">70</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-72">72</div><div class="crayon-num" data-line="crayon-622c62a9a937d508940837-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a937d508940837-74">74</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a937d508940837-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">keras</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">Dense</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">Conv2D</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-5"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">callbacks </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">History </span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-6"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">History</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-8"><span class="crayon-v">img_x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">127</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-9"><span class="crayon-v">img_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">127</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-10"><span class="crayon-v">img_z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-11"><span class="crayon-v">input_shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">img_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">img_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">img_z</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-12">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a937d508940837-13"><span class="crayon-v">num_classes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-14"><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-15"><span class="crayon-v">num_classes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-16"><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-18"><span class="crayon-v">x_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-19"><span class="crayon-v">x_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-20">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a937d508940837-21"><span class="crayon-v">y_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num_classes</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-22"><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num_classes</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-24">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a937d508940837-25"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-v">input_shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-29"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-30"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-31"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-32"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-33"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-34"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">num_classes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-36"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-k ">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">losses</span><span class="crayon-sy">.</span><span class="crayon-v">categorical_crossentropy</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">optimizers</span><span class="crayon-sy">.</span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-40">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a937d508940837-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">x_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-v">epochs</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">x_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">callbacks</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">history</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-47">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-48"><span class="crayon-v">train_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">x_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-49"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train loss: {}, Train accuracy: {}'</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">train_score</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_score</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-50"><span class="crayon-v">test_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">x_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-51"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test loss: {}, Test accuracy: {}'</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">test_score</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_score</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-52">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a937d508940837-53"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-54"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">235s</span><span class="crayon-h"> </span><span class="crayon-cn">47ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3963</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8876</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.6006</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8780</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-55"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-56"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">228s</span><span class="crayon-h"> </span><span class="crayon-cn">46ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1939</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9282</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3952</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8880</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-57"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-58"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">224s</span><span class="crayon-h"> </span><span class="crayon-cn">45ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1347</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9434</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.4367</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9100</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-59"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-60"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">228s</span><span class="crayon-h"> </span><span class="crayon-cn">46ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1971</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9334</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2662</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9320</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-61"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-62"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">231s</span><span class="crayon-h"> </span><span class="crayon-cn">46ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1134</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9544</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2131</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9320</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-63"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-64"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">230s</span><span class="crayon-h"> </span><span class="crayon-cn">46ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1285</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9520</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2014</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9440</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-65"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-66"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">232s</span><span class="crayon-h"> </span><span class="crayon-cn">46ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1339</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9532</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2884</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9300</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-67"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-68"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">237s</span><span class="crayon-h"> </span><span class="crayon-cn">47ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1503</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9488</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3181</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9340</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-69"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-70"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">250s</span><span class="crayon-h"> </span><span class="crayon-cn">50ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1247</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9504</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2403</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9460</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-71"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">/</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-72"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-o">/</span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">238s</span><span class="crayon-h"> </span><span class="crayon-cn">48ms</span><span class="crayon-o">/</span><span class="crayon-v">step</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1578</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9508</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2133</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9300</span></div><div class="crayon-line" id="crayon-622c62a9a937d508940837-73"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Train </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.11115437872409821</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Train </span><span class="crayon-v">accuracy</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.959</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a937d508940837-74"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">Test</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.21326758581399918</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">Test</span><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.93</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0202 seconds] -->
<p><a href="https://ataspinar.com/wp-content/uploads/2018/12/history_cwt_.png"><img loading="lazy" class="wp-image-4166 size-full alignnone" src="https://ataspinar.com/wp-content/uploads/2018/12/history_cwt_.png" alt="" width="755" height="393" srcset="https://ataspinar.com/wp-content/uploads/2018/12/history_cwt_.png 755w, https://ataspinar.com/wp-content/uploads/2018/12/history_cwt_-300x156.png 300w, https://ataspinar.com/wp-content/uploads/2018/12/history_cwt_-230x120.png 230w, https://ataspinar.com/wp-content/uploads/2018/12/history_cwt_-350x182.png 350w, https://ataspinar.com/wp-content/uploads/2018/12/history_cwt_-480x250.png 480w" sizes="(max-width: 755px) 100vw, 755px" /></a></p>
<p>As you can see, combining the Wavelet Transform and a Convolutional Neural Network leads to an awesome and amazing result!</p>
<p>We have an accuracy of 94% on the Activity Recognition dataset. Much higher than you can achieve with any other method.<br />
In section 3.5 we will use the Discrete Wavelet Transform instead of Continuous Wavelet Transform to classify the same dataset and achieve similarly amazing results!</p>
<h2>3.3 Deconstructing a signal using the DWT</h2>
<p>In Section 2.5 we have seen how the DWT is implemented as a filter-bank which can deconstruct a signal into its frequency sub-bands. In this section, let us see how we can use PyWavelets to deconstruct a signal into its frequency sub-bands and reconstruct the original signal again.</p>
<p>PyWavelets offers two different ways to deconstruct a signal.</p>
<ol>
<li>We can either apply <code><a href="https://pywavelets.readthedocs.io/en/latest/ref/dwt-discrete-wavelet-transform.html" target="_blank" rel="noopener">pywt.dwt()</a></code> on a signal to retrieve the approximation coefficients. Then apply the DWT on the retrieved coefficients to get the second level coefficients and continue this process until you have reached the desired decomposition level.</li>
<li>Or we can apply <code><a href="https://pywavelets.readthedocs.io/en/latest/ref/dwt-discrete-wavelet-transform.html#multilevel-decomposition-using-wavedec" target="_blank" rel="noopener">pywt.wavedec()</a></code> directly and retrieve all of the the detail coefficients up to some level <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-a63eb5ff0272d3119fa684be6e7acce8_l3.svg" class="ql-img-inline-formula " alt="&#110;" title="Rendered by QuickLaTeX.com" height="8" width="11" style="vertical-align: 0px;"/>. This functions takes as input the original signal and the level <img loading="lazy" src="https://ataspinar.com/wp-content/ql-cache/quicklatex.com-a63eb5ff0272d3119fa684be6e7acce8_l3.svg" class="ql-img-inline-formula " alt="&#110;" title="Rendered by QuickLaTeX.com" height="8" width="11" style="vertical-align: 0px;"/> and returns the one set of approximation coefficients (of the n-th level) and n sets of detail coefficients (1 to n-th level).</li>
</ol>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9384282282730" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
(cA1, cD1) = pywt.dwt(signal, 'db2', 'smooth')
reconstructed_signal = pywt.idwt(cA1, cD1, 'db2', 'smooth')

fig, ax = plt.subplots(figsize=(8,4))
ax.plot(signal, label='signal')
ax.plot(reconstructed_signal, label='reconstructed signal', linestyle='--')
ax.legend(loc='upper left')
plt.show()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9384282282730-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9384282282730-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9384282282730-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9384282282730-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9384282282730-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9384282282730-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9384282282730-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9384282282730-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9384282282730-1"><span class="crayon-sy">(</span><span class="crayon-v">cA1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cD1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">dwt</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'smooth'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9384282282730-2"><span class="crayon-v">reconstructed_signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">idwt</span><span class="crayon-sy">(</span><span class="crayon-v">cA1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cD1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'smooth'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9384282282730-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9384282282730-4"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9384282282730-5"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'signal'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9384282282730-6"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">reconstructed_signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'reconstructed signal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linestyle</span><span class="crayon-o">=</span><span class="crayon-s">'--'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9384282282730-7"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-v">loc</span><span class="crayon-o">=</span><span class="crayon-s">'upper left'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9384282282730-8"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p><figure id="attachment_4068" aria-describedby="caption-attachment-4068" style="width: 495px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal.png"><img loading="lazy" class="wp-image-4068 size-full" src="https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal.png" alt="" width="495" height="252" srcset="https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal.png 495w, https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal-300x153.png 300w, https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal-230x117.png 230w, https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal-350x178.png 350w, https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal-480x244.png 480w" sizes="(max-width: 495px) 100vw, 495px" /></a><figcaption id="caption-attachment-4068" class="wp-caption-text">Figure 12. A signal together with the reconstructed signal.</figcaption></figure></p>
<p>Above we have deconstructed a signal into its coefficients and reconstructed it again using the inverse DWT.</p>
<p>The second way is to use <code>pywt.wavedec()</code> to deconstruct and reconstruct a signal and it is probably the most simple way if you want to get higher-level coefficients.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9387168269099" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
coeffs = pywt.wavedec(signal, 'db2', level=8)
reconstructed_signal = pywt.waverec(coeffs, 'db2')

fig, ax = plt.subplots(figsize=(8,4))
ax.plot(signal[:1000], label='signal')
ax.plot(reconstructed_signal[:1000], label='reconstructed signal', linestyle='--')
ax.legend(loc='upper left')
ax.set_title('de- and reconstruction using wavedec()')
plt.show()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9387168269099-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9387168269099-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9387168269099-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9387168269099-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9387168269099-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9387168269099-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9387168269099-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9387168269099-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9387168269099-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9387168269099-1"><span class="crayon-v">coeffs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">wavedec</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">level</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9387168269099-2"><span class="crayon-v">reconstructed_signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">waverec</span><span class="crayon-sy">(</span><span class="crayon-v">coeffs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db2'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9387168269099-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9387168269099-4"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9387168269099-5"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">1000</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'signal'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9387168269099-6"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">reconstructed_signal</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">1000</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'reconstructed signal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linestyle</span><span class="crayon-o">=</span><span class="crayon-s">'--'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9387168269099-7"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-v">loc</span><span class="crayon-o">=</span><span class="crayon-s">'upper left'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9387168269099-8"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-s">'de- and reconstruction using wavedec()'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9387168269099-9"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p><figure id="attachment_4070" aria-describedby="caption-attachment-4070" style="width: 495px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal3.png"><img loading="lazy" class="wp-image-4070 size-full" src="https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal3.png" alt="" width="495" height="264" srcset="https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal3.png 495w, https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal3-300x160.png 300w, https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal3-230x123.png 230w, https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal3-350x187.png 350w, https://ataspinar.com/wp-content/uploads/2018/09/reconstructed_signal3-480x256.png 480w" sizes="(max-width: 495px) 100vw, 495px" /></a><figcaption id="caption-attachment-4070" class="wp-caption-text">Figure 13. A signal together with the reconstructed signal.</figcaption></figure></p>
<h2>3.4 Removing (high-frequency) noise using the DWT</h2>
<p>In the previous section we have seen how we can deconstruct a signal into the approximation (low pass) and detail (high pass) coefficients. If we reconstruct the signal using these coefficients we will get the original signal back.</p>
<p>But what happens if we reconstruct while we leave out some detail coefficients? Since the detail coefficients represent the high frequency part of the signal, we will simply have filtered out that part of the frequency spectrum. If you have a lot of high-frequency noise in your signal, this one way to filter it out.<br />
Leaving out of the detail coefficients can be done using <a href="https://pywavelets.readthedocs.io/en/latest/ref/thresholding-functions.html" target="_blank" rel="noopener">pywt.threshold()</a>, which removes coefficient values higher than the given threshold.</p>
<p>Lets demonstrate this using <a href="https://ti.arc.nasa.gov/tech/dash/groups/pcoe/prognostic-data-repository/#femto" target="_blank" rel="noopener">NASA&#8217;s Femto Bearing Dataset</a>. This is a dataset containing high frequency sensor data regarding accelerated degradation of bearings.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a938b726419055" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
DATA_FOLDER = './FEMTO_bearing/Training_set/Bearing1_1/'
filename = 'acc_01210.csv'
df = pd.read_csv(DATA_FOLDER + filename, header=None)
signal = df[4].values

def lowpassfilter(signal, thresh = 0.63, wavelet="db4"):
    thresh = thresh*np.nanmax(signal)
    coeff = pywt.wavedec(signal, wavelet, mode="per" )
    coeff[1:] = (pywt.threshold(i, value=thresh, mode="soft" ) for i in coeff[1:])
    reconstructed_signal = pywt.waverec(coeff, wavelet, mode="per" )
    return reconstructed_signal

fig, ax = plt.subplots(figsize=(12,8))
ax.plot(signal, color="b", alpha=0.5, label='original signal')
rec = lowpassfilter(signal, 0.4)
ax.plot(rec, 'k', label='DWT smoothing}', linewidth=2)
ax.legend()
ax.set_title('Removing High Frequency Noise with DWT', fontsize=18)
ax.set_ylabel('Signal Amplitude', fontsize=16)
ax.set_xlabel('Sample No', fontsize=16)
plt.show()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a938b726419055-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a938b726419055-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a938b726419055-1"><span class="crayon-v">DATA_FOLDER</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'./FEMTO_bearing/Training_set/Bearing1_1/'</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-2"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'acc_01210.csv'</span></div><div class="crayon-line" id="crayon-622c62a9a938b726419055-3"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">DATA_FOLDER</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-4"><span class="crayon-k ">signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-622c62a9a938b726419055-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-6"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">lowpassfilter</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.63</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-o">=</span><span class="crayon-s">"db4"</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a938b726419055-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thresh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">thresh</span><span class="crayon-o">*</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanmax</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coeff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">wavedec</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">"per"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a938b726419055-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coeff</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">threshold</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-v">thresh</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">"soft"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">coeff</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">reconstructed_signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">waverec</span><span class="crayon-sy">(</span><span class="crayon-v">coeff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">wavelet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">"per"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a938b726419055-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">reconstructed_signal</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-12">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a938b726419055-13"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-14"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">"b"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'original signal'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a938b726419055-15"><span class="crayon-v">rec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">lowpassfilter</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-16"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">rec</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'k'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'DWT smoothing}'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linewidth</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a938b726419055-17"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-18"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-s">'Removing High Frequency Noise with DWT'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a938b726419055-19"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Signal Amplitude'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a938b726419055-20"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Sample No'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a938b726419055-21"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0052 seconds] -->
<p><figure id="attachment_4073" aria-describedby="caption-attachment-4073" style="width: 737px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/11/dwt_smoothing.png"><img loading="lazy" class="size-full wp-image-4073" src="https://ataspinar.com/wp-content/uploads/2018/11/dwt_smoothing.png" alt="" width="737" height="505" srcset="https://ataspinar.com/wp-content/uploads/2018/11/dwt_smoothing.png 737w, https://ataspinar.com/wp-content/uploads/2018/11/dwt_smoothing-300x206.png 300w, https://ataspinar.com/wp-content/uploads/2018/11/dwt_smoothing-230x158.png 230w, https://ataspinar.com/wp-content/uploads/2018/11/dwt_smoothing-350x240.png 350w, https://ataspinar.com/wp-content/uploads/2018/11/dwt_smoothing-480x329.png 480w" sizes="(max-width: 737px) 100vw, 737px" /></a><figcaption id="caption-attachment-4073" class="wp-caption-text">Figure 14. A high frequency signal and its DWT smoothed version.</figcaption></figure></p>
<p>As we can see, by deconstructing the signal, setting some of the coefficients to zero, and reconstructing it again, we can remove high frequency noise from the signal.</p>
<p>People who are familiar with signal processing techniques might know there are a lot of different ways to remove noise from a signal. For example, the Scipy library contains a lot of smoothing filters (one of them is the famous <a href="https://docs.scipy.org/doc/scipy-0.16.1/reference/generated/scipy.signal.savgol_filter.html" target="_blank" rel="noopener">Savitzky-Golay</a> filter) and they are much simpler to use. Another method for smoothing a signal is to average it over its time-axis.<br />
So why should you use the DWT instead? The advantage of the DWT again comes from the many wavelet shapes there are available. You can choose a wavelet which will have a shape characteristic to the phenomena you expect to see. In this way, less of the phenomena you expect to see will be smoothed out.</p>
<h2>3.5 Using the Discrete Wavelet Transform to classify signals</h2>
<p>In Section 3.2 we have seen how we can use a the CWT and a CNN  to classify signals. Of course it is also possible to  use the DWT to classify signals. Let us have a look at how this could be done.</p>
<h3>3.5.1 The idea behind Discrete Wavelet classification</h3>
<p>The idea behind DWT signal classification is as follows: The DWT is used to split a signal into different frequency sub-bands, as many as needed or as many as possible. If the different types of signals exhibit different frequency characteristics, this difference in behavior has to be exhibited in one of the frequency sub-bands. So if we generate features from each of the sub-band and use the collection of features as an input for a classifier (Random Forest, Gradient Boosting, Logistic Regression, etc) and train it by using these features, the classifier should be able to distinguish between the different types of signals.</p>
<p>This is illustrated in the figure below:</p>
<figure id="attachment_4111" aria-describedby="caption-attachment-4111" style="width: 2612px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3.png"><img loading="lazy" class="wp-image-4111 size-full" src="https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3.png" alt="" width="2612" height="1596" srcset="https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3.png 2612w, https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3-300x183.png 300w, https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3-768x469.png 768w, https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3-1024x626.png 1024w, https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3-830x507.png 830w, https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3-230x141.png 230w, https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3-350x214.png 350w, https://ataspinar.com/wp-content/uploads/2018/12/multilevel_coefficients_to_features3-480x293.png 480w" sizes="(max-width: 2612px) 100vw, 2612px" /></a><figcaption id="caption-attachment-4111" class="wp-caption-text">Figure 15. By applying the DWT on a signal we can deconstruct it its frequency sub-bands. And out of each sub-band we can generate features which can be used as input for a Classifier.</figcaption></figure>
<h3>3.5.2 Generating features per sub-band</h3>
<p>So what kind of features can be generated from the set of values for each of the sub-bands? Of course this will highly depend on the type of signal and the application. But in general, below are some features which are most frequently used for signals.</p>
<ul>
<li>Auto-regressive model coefficient values</li>
<li>(Shannon) Entropy values; entropy values can be taken as a measure of complexity of the signal.</li>
<li>Statistical features like:
<ul>
<li>variance</li>
<li>standard deviation</li>
<li>Mean</li>
<li>Median</li>
<li>25th percentile value</li>
<li>75th percentile value</li>
<li>Root Mean Square value; square of the average of the squared amplitude values</li>
<li>The mean of the derivative</li>
<li>Zero crossing rate, i.e. the number of times a signal crosses y = 0</li>
<li>Mean crossing rate, i.e. the number of times a signal crosses y = mean(y)</li>
</ul>
</li>
</ul>
<p>These are just some ideas you could use to generate the features out of each sub-band. You could use some of the features described here, or you could use all of them. Most classifiers in the scikit-learn package are powerful enough to handle a large number of input features and distinguish between useful ones and non-useful ones. However, I still recommend you think carefully about which feature would be useful for the type of signal you are trying to classify.</p>
<p><strong>PS:</strong> There are a hell of a lot more statistical functions in <a href="https://docs.scipy.org/doc/scipy/reference/stats.html" target="_blank" rel="noopener">scipy.stats</a>. By using these you can create more features if necessary.</p>
<p>Let&#8217;s see how this could be done in Python for a few of the above mentioned features:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9392071189522" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def calculate_entropy(list_values):
    counter_values = Counter(list_values).most_common()
    probabilities = [elem[1]/len(list_values) for elem in counter_values]
    entropy=scipy.stats.entropy(probabilities)
    return entropy

def calculate_statistics(list_values):
    n5 = np.nanpercentile(list_values, 5)
    n25 = np.nanpercentile(list_values, 25)
    n75 = np.nanpercentile(list_values, 75)
    n95 = np.nanpercentile(list_values, 95)
    median = np.nanpercentile(list_values, 50)
    mean = np.nanmean(list_values)
    std = np.nanstd(list_values)
    var = np.nanvar(list_values)
    rms = np.nanmean(np.sqrt(list_values**2))
    return [n5, n25, n75, n95, median, mean, std, var, rms]

def calculate_crossings(list_values):
    zero_crossing_indices = np.nonzero(np.diff(np.array(list_values) &amp;gt; 0))[0]
    no_zero_crossings = len(zero_crossing_indices)
    mean_crossing_indices = np.nonzero(np.diff(np.array(list_values) &amp;gt; np.nanmean(list_values)))[0]
    no_mean_crossings = len(mean_crossing_indices)
    return [no_zero_crossings, no_mean_crossings]

def get_features(list_values):
    entropy = calculate_entropy(list_values)
    crossings = calculate_crossings(list_values)
    statistics = calculate_statistics(list_values)
    return [entropy] + crossings + statistics</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-24">24</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-26">26</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-28">28</div><div class="crayon-num" data-line="crayon-622c62a9a9392071189522-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9392071189522-30">30</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9392071189522-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">calculate_entropy</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">counter_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">most_common</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">probabilities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">elem</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">/</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">elem </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">counter_values</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">entropy</span><span class="crayon-o">=</span><span class="crayon-v">scipy</span><span class="crayon-sy">.</span><span class="crayon-v">stats</span><span class="crayon-sy">.</span><span class="crayon-e">entropy</span><span class="crayon-sy">(</span><span class="crayon-v">probabilities</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">entropy</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-6">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9392071189522-7"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">calculate_statistics</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n5</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanpercentile</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n25</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanpercentile</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n75</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanpercentile</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n95</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanpercentile</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">median</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanpercentile</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanmean</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">std</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanstd</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">var</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanvar</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rms</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanmean</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">n5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n95</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">median</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">var</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rms</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-18">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9392071189522-19"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">calculate_crossings</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">zero_crossing_indices</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nonzero</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">diff</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">no_zero_crossings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">zero_crossing_indices</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mean_crossing_indices</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nonzero</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">diff</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nanmean</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">no_mean_crossings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">mean_crossing_indices</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">no_zero_crossings</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">no_mean_crossings</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-26"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get_features</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">entropy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">calculate_entropy</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">crossings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">calculate_crossings</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9392071189522-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">statistics</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">calculate_statistics</span><span class="crayon-sy">(</span><span class="crayon-v">list_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9392071189522-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">entropy</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">crossings</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">statistics</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0075 seconds] -->
<p>Above we can see</p>
<ul>
<li>a function to calculate the entropy value of an input signal,</li>
<li>a function to calculate some statistics like several percentiles, mean, standard deviation, variance, etc,</li>
<li>a function to calculate the zero crossings rate and the mean crossings rate,</li>
<li>and a function to combine the results of these three functions.</li>
</ul>
<p>The final function returns a set of 12 features for any list of values. So if one signal is decomposed into 10 different sub-bands, and we generate features for each sub-band, we will end up with 10*12 = 120 features per signal.</p>
<h3>3.5.3 Using the features and scikit-learn classifiers to classify two ECG datasets.</h3>
<p>So far so good. The next step is to actually use the DWT to decompose the signals in the training set into its sub-bands, calculate the features for each sub-band, use the features to train a classifier and use the classifier to predict the signals in the test-set.</p>
<p>We will do this for two time-series datasets:</p>
<ol>
<li>The UCI-HAR dataset which we have already seen in section 3.2. This dataset contains smartphone sensor data of humans while doing different types of activities, like sitting, standing, walking, stair up and stair down.</li>
<li><a href="https://physionet.org/" target="_blank" rel="noopener">PhysioNet</a> ECG Dataset (<a href="https://github.com/mathworks/physionet_ECG_data/blob/master/ECGData.zip" target="_blank" rel="noopener">download from here</a>) which contains a set of ECG measurements of healthy persons (indicated as Normal sinus rhythm, NSR) and persons with either an arrhythmia (ARR) or a congestive heart failure (CHF). This dataset contains 96 ARR measurements, 36 NSR measurements and 30 CHF measurements.</li>
</ol>
<p>After we have downloaded both datasets, and placed them in the right folders, the next step is to load them into memory. We have already seen how we can load the UCI-HAR dataset in section 3.2, and below we can see how to load the ECG dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a9398260933201" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def load_ecg_data(filename):
    raw_data = sio.loadmat(filename)
    list_signals = raw_data['ECGData'][0][0][0]
    list_labels = list(map(lambda x: x[0][0], raw_data['ECGData'][0][0][1]))
    return list_signals, list_labels


##########

filename = './data/ECG_data/ECGData.mat'
data_ecg, labels_ecg = load_ecg_data(filename)
training_size = int(0.6*len(labels_ecg))
train_data_ecg = data_ecg[:training_size]
test_data_ecg = data_ecg[training_size:]
train_labels_ecg = labels_ecg[:training_size]
test_labels_ecg = labels_ecg[training_size:]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a9398260933201-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9398260933201-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a9398260933201-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9398260933201-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a9398260933201-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9398260933201-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a9398260933201-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9398260933201-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a9398260933201-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9398260933201-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a9398260933201-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9398260933201-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a9398260933201-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9398260933201-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a9398260933201-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a9398260933201-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a9398260933201-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">load_ecg_data</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9398260933201-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">raw_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sio</span><span class="crayon-sy">.</span><span class="crayon-e">loadmat</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9398260933201-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">list_signals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">raw_data</span><span class="crayon-sy">[</span><span class="crayon-s">'ECGData'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9398260933201-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">list_labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">raw_data</span><span class="crayon-sy">[</span><span class="crayon-s">'ECGData'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9398260933201-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">list_signals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">list_labels</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9398260933201-6">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a9398260933201-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9398260933201-8"><span class="crayon-c">##########</span></div><div class="crayon-line" id="crayon-622c62a9a9398260933201-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9398260933201-10"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'./data/ECG_data/ECGData.mat'</span></div><div class="crayon-line" id="crayon-622c62a9a9398260933201-11"><span class="crayon-v">data_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels_ecg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_ecg_data</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9398260933201-12"><span class="crayon-v">training_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-cn">0.6</span><span class="crayon-o">*</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">labels_ecg</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a9398260933201-13"><span class="crayon-v">train_data_ecg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_ecg</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">training_size</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9398260933201-14"><span class="crayon-v">test_data_ecg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_ecg</span><span class="crayon-sy">[</span><span class="crayon-v">training_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a9398260933201-15"><span class="crayon-v">train_labels_ecg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">labels_ecg</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">training_size</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a9398260933201-16"><span class="crayon-v">test_labels_ecg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">labels_ecg</span><span class="crayon-sy">[</span><span class="crayon-v">training_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
<p>The ECG dataset is saved as a MATLAB file, so we have to use scipy.io.loadmat() to open this file in Python and retrieve its contents (the ECG measurements and the labels) as two separate lists.</p>
<p>The UCI HAR dataset is saved in a lot of .txt files, and after reading the data we save it into an numpy ndarray of size (no of signals, length of signal, no of components) = (10299 , 128, 9)</p>
<p>Now let us have a look at how we can get features out of these two datasets.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a939c074916655" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def get_uci_har_features(dataset, labels, waveletname):
    uci_har_features = []
    for signal_no in range(0, len(dataset)):
        features = []
        for signal_comp in range(0,dataset.shape[2]):
            signal = dataset[signal_no, :, signal_comp]
            list_coeff = pywt.wavedec(signal, waveletname)
            for coeff in list_coeff:
                features += get_features(coeff)
        uci_har_features.append(features)
    X = np.array(uci_har_features)
    Y = np.array(labels)
    return X, Y

def get_ecg_features(ecg_data, ecg_labels, waveletname):
    list_features = []
    list_unique_labels = list(set(ecg_labels))
    list_labels = [list_unique_labels.index(elem) for elem in ecg_labels]
    for signal in ecg_data:
        list_coeff = pywt.wavedec(signal, waveletname)
        features = []
        for coeff in list_coeff:
            features += get_features(coeff)
        list_features.append(features)
    return list_features, list_labels

X_train_ecg, Y_train_ecg = get_ecg_features(train_data_ecg, train_labels_ecg, 'db4')
X_test_ecg, Y_test_ecg = get_ecg_features(test_data_ecg, test_labels_ecg, 'db4')

X_train_ucihar, Y_train_ucihar = get_uci_har_features(train_signals_ucihar, train_labels_ucihar, 'rbio3.1')
X_test_ucihar, Y_test_ucihar = get_uci_har_features(test_signals_ucihar, test_labels_ucihar, 'rbio3.1')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-20">20</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-22">22</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-24">24</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-26">26</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-28">28</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a939c074916655-30">30</div><div class="crayon-num" data-line="crayon-622c62a9a939c074916655-31">31</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a939c074916655-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get_uci_har_features</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">waveletname</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">uci_har_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">signal_no </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">signal_comp </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">signal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">signal_no</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">signal_comp</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">list_coeff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">wavedec</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">waveletname</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">coeff </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">list_coeff</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">get_features</span><span class="crayon-sy">(</span><span class="crayon-v">coeff</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">uci_har_features</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">features</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">uci_har_features</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">Y</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-14">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a939c074916655-15"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get_ecg_features</span><span class="crayon-sy">(</span><span class="crayon-v">ecg_data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ecg_labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">waveletname</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">list_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">list_unique_labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-k ">set</span><span class="crayon-sy">(</span><span class="crayon-v">ecg_labels</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">list_labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">list_unique_labels</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-v">elem</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">elem </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ecg_labels</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-k ">signal</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ecg_data</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">list_coeff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pywt</span><span class="crayon-sy">.</span><span class="crayon-e">wavedec</span><span class="crayon-sy">(</span><span class="crayon-k ">signal</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">waveletname</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">coeff </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">list_coeff</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">get_features</span><span class="crayon-sy">(</span><span class="crayon-v">coeff</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">list_features</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">features</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">list_features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list_labels</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-26">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a939c074916655-27"><span class="crayon-v">X_train_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_train_ecg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_ecg_features</span><span class="crayon-sy">(</span><span class="crayon-v">train_data_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_labels_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db4'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-28"><span class="crayon-v">X_test_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_test_ecg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_ecg_features</span><span class="crayon-sy">(</span><span class="crayon-v">test_data_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_labels_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db4'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a939c074916655-30"><span class="crayon-v">X_train_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_train_ucihar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_uci_har_features</span><span class="crayon-sy">(</span><span class="crayon-v">train_signals_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_labels_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rbio3.1'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a939c074916655-31"><span class="crayon-v">X_test_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_test_ucihar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_uci_har_features</span><span class="crayon-sy">(</span><span class="crayon-v">test_signals_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_labels_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rbio3.1'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0064 seconds] -->
<p>What we have done above is to write functions to generate features from the ECG signals and the UCI HAR signals. There is nothing special about these functions and the only reason we are using two seperate functions is because the two datasets are saved in different formats. The ECG dataset is saved in a list, and the UCI HAR dataset is saved in a 3D numpy ndarray.</p>
<p>For the ECG dataset we iterate over the list of signals, and for each signal apply the DWT which returns a list of coefficients. For each of these coefficients, i.e. for each of the frequency sub-bands, we calculate the features with the function we have defined previously. The features calculated from all of the different coefficients belonging to one signal are concatenated together, since they belong to the same signal.</p>
<p>The same is done for the UCI HAR dataset. The only difference is that we now have two for-loops since each signal consists of nine components. The features generated from each of the sub-band from each of the signal component are concatenated together.</p>
<p>Now that we have calculated the features for the two datasets, we can use a GradientBoostingClassifier from the scikit-learn library and train it.</p>
<p><strong>PS:</strong> If you want to know more about classification with the scikit-learn library, you can have a look at <a href="https://ataspinar.com/2017/05/26/classification-with-scikit-learn/" target="_blank" rel="noopener">this blog post</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-622c62a9a93a0904123391" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
cls = GradientBoostingClassifier(n_estimators=2000)
cls.fit(X_train_ecg, Y_train_ecg)
train_score = cls.score(X_train_ecg, Y_train_ecg)
test_score = cls.score(X_test_ecg, Y_test_ecg)
print("Train Score for the ECG dataset is about: {}".format(train_score))
print("Test Score for the ECG dataset is about: {.2f}".format(test_score))

### 

cls = GradientBoostingClassifier(n_estimators=2000)
cls.fit(X_train_ucihar, Y_train_ucihar)
train_score = cls.score(X_train_ucihar, Y_train_ucihar)
test_score = cls.score(X_test_ucihar, Y_test_ucihar)
print("Train Score for the UCI-HAR dataset is about: {}".format(train_score))
print("Test Score for the UCI-HAR dataset is about: {.2f}".format(test_score))

*** Train Score for the ECG dataset is about: 1.0
*** Test Score for the ECG dataset is about: 0.93
*** Train Score for the UCI_HAR dataset is about: 1.0
*** Test Score for the UCI-HAR dataset is about: 0.95</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-2">2</div><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-4">4</div><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-6">6</div><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-8">8</div><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-10">10</div><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-12">12</div><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-14">14</div><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-16">16</div><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-18">18</div><div class="crayon-num" data-line="crayon-622c62a9a93a0904123391-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-622c62a9a93a0904123391-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-622c62a9a93a0904123391-1"><span class="crayon-v">cls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-cn">2000</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-2"><span class="crayon-v">cls</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_train_ecg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a93a0904123391-3"><span class="crayon-v">train_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cls</span><span class="crayon-sy">.</span><span class="crayon-e">score</span><span class="crayon-sy">(</span><span class="crayon-v">X_train_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_train_ecg</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-4"><span class="crayon-v">test_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cls</span><span class="crayon-sy">.</span><span class="crayon-e">score</span><span class="crayon-sy">(</span><span class="crayon-v">X_test_ecg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_test_ecg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a93a0904123391-5"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Train Score for the ECG dataset is about: {}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">train_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-6"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Test Score for the ECG dataset is about: {.2f}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">test_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a93a0904123391-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-8"><span class="crayon-c">### </span></div><div class="crayon-line" id="crayon-622c62a9a93a0904123391-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-10"><span class="crayon-v">cls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-cn">2000</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a93a0904123391-11"><span class="crayon-v">cls</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_train_ucihar</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-12"><span class="crayon-v">train_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cls</span><span class="crayon-sy">.</span><span class="crayon-e">score</span><span class="crayon-sy">(</span><span class="crayon-v">X_train_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_train_ucihar</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a93a0904123391-13"><span class="crayon-v">test_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cls</span><span class="crayon-sy">.</span><span class="crayon-e">score</span><span class="crayon-sy">(</span><span class="crayon-v">X_test_ucihar</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_test_ucihar</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-14"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Train Score for the UCI-HAR dataset is about: {}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">train_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-622c62a9a93a0904123391-15"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Test Score for the UCI-HAR dataset is about: {.2f}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">test_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-16">&nbsp;</div><div class="crayon-line" id="crayon-622c62a9a93a0904123391-17"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Train </span><span class="crayon-e">Score </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">ECG </span><span class="crayon-e">dataset </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">about</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-18"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">Test</span><span class="crayon-h"> </span><span class="crayon-e">Score </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">ECG </span><span class="crayon-e">dataset </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">about</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.93</span></div><div class="crayon-line" id="crayon-622c62a9a93a0904123391-19"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Train </span><span class="crayon-e">Score </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">UCI_HAR </span><span class="crayon-e">dataset </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">about</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-622c62a9a93a0904123391-20"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">Test</span><span class="crayon-h"> </span><span class="crayon-e">Score </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-v">UCI</span><span class="crayon-o">-</span><span class="crayon-e">HAR </span><span class="crayon-e">dataset </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">about</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.95</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0043 seconds] -->
<p>As we can see, the results when we use the DWT + Gradient Boosting Classifier are equally amazing!</p>
<p>This approach has an accuracy on the UCI-HAR test set of 95% and an accuracy on the ECG test set of 93%.</p>
<h2>3.6 Comparison of the classification accuracies between DWT, Fourier Transform and Recurrent Neural Networks</h2>
<p>So far, we have seen throughout the various blog-posts, how we can classify time-series and signals in different ways. In a previous post we have classified the UCI-HAR dataset <a href="https://ataspinar.com/2018/04/04/machine-learning-with-signal-processing-techniques/" target="_blank" rel="noopener">using Signal Processing techniques like The Fourier Transform</a>. The accuracy on the test-set was ~91%.</p>
<p>In another blog-post, we have classified the same UCI-HAR dataset <a href="https://ataspinar.com/2018/07/05/building-recurrent-neural-networks-in-tensorflow/" target="_blank" rel="noopener">using Recurrent Neural Networks</a>. The highest achieved accuracy on the test-set was ~86%.</p>
<p>In this blog-post we have achieved an accuracy of ~94% on the test-set with the approach of CWT + CNN and an accuracy of ~95% with the DWT + GradientBoosting approach!</p>
<p>It is clear that the Wavelet Transform has far better results. We could repeat this for other datasets and I suspect there the Wavelet Transform will also outperform.</p>
<p>What we can also notice is that strangely enough Recurrent Neural Networks perform the worst. Even the approach of simply using the Fourier Transform and then the peaks in the frequency spectrum has an better accuracy than RNN&#8217;s.</p>
<p>This really makes me wonder, what the hell Recurrent Neural Networks are actually good for. It is said that a RNN can learn &#8216;temporal dependencies in sequential data&#8217;. But, if a Fourier Transform can fully describe any signal (no matter its complexity) in terms of the Fourier components, then what more can be learned with respect to &#8216;temporal dependencies&#8217;.<br />
It is no wonder that people already start talking about <a href="https://towardsdatascience.com/the-fall-of-rnn-lstm-2d1594c74ce0" target="_blank" rel="noopener">the fall of RNN / LSTM</a>.</p>
<p><strong>PS: </strong>The achieved accuracy using the DWT will depend on the features you decide to calculate, the wavelet and the classifier you decide to use. To give an impression, below are the accuracy values for the test set of the UCI-HAR and ECG datasets, for all of the wavelets present in PyWavelets, and for the most used 5 classifiers in scikit-learn.</p>
<figure id="attachment_4084" aria-describedby="caption-attachment-4084" style="width: 515px" class="wp-caption alignnone"><a href="https://ataspinar.com/wp-content/uploads/2018/11/ucihar_ecg_accuracies.png"><img loading="lazy" class="size-large wp-image-4084" src="https://ataspinar.com/wp-content/uploads/2018/11/ucihar_ecg_accuracies-515x1024.png" alt="" width="515" height="1024" srcset="https://ataspinar.com/wp-content/uploads/2018/11/ucihar_ecg_accuracies-515x1024.png 515w, https://ataspinar.com/wp-content/uploads/2018/11/ucihar_ecg_accuracies-151x300.png 151w, https://ataspinar.com/wp-content/uploads/2018/11/ucihar_ecg_accuracies-230x457.png 230w, https://ataspinar.com/wp-content/uploads/2018/11/ucihar_ecg_accuracies-350x696.png 350w, https://ataspinar.com/wp-content/uploads/2018/11/ucihar_ecg_accuracies-480x954.png 480w, https://ataspinar.com/wp-content/uploads/2018/11/ucihar_ecg_accuracies.png 758w" sizes="(max-width: 515px) 100vw, 515px" /></a><figcaption id="caption-attachment-4084" class="wp-caption-text">Figure 16. The accuracies on the test set of the UCI-HAR and ECG datasets, for all of the wavelets present in PyWavelets, and for five of the most popular classifiers in scikit-learn.</figcaption></figure>
<p>We can see that there will be differences in accuracy depending on the chosen classifier. Generally speaking, the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html" target="_blank" rel="noopener">Gradient Boosting</a> classifier performs best. This should come as no surprise since almost all kaggle competitions are <a href="https://www.quora.com/What-machine-learning-approaches-have-won-most-Kaggle-competitions" target="_blank" rel="noopener">won with the gradient boosting model</a>.</p>
<p>What is more important is that the chosen wavelet can also have a lot of influence on the achieved accuracy values. Unfortunately I do not have an guideline on choosing the right wavelet. The best way to choose the right wavelet is to do a lot of trial-and-error and a little bit of literature research.</p>
<h2>4. Final Words</h2>
<p>In this blog post we have seen how we can use the Wavelet Transform for the analysis and classification of time-series and signals (and some other stuff). Not many people know how to use the Wavelet Transform, but this is mostly because the theory is not beginner-friendly and the wavelet transform is not readily available in open source programming languages.</p>
<p>MATLAB is one the few programming languages with a very complete <a href="https://nl.mathworks.com/products/wavelet.html" target="_blank" rel="noopener">Wavelet Toolbox</a>. But since MATLAB has a expensive licensing fee, it is mostly used in the academic world and large corporations.</p>
<p>Among Data Scientists, the Wavelet Transform remains an undiscovered jewel and I recommend fellow Data Scientists to use it more often. I am very thankful to the contributors of the PyWavelets package who have implemented a large set of Wavelet families and higher level functions for using these wavelets. Thanks to them, Wavelets can now more easily be used by people using the Python programming language.</p>
<p>I have tried to give a concise but complete description of how wavelets can be used for the analysis of signals. I hope it has motivated you to use it more often and that the Python code provided in this blog-post will point you in the right direction in your quest to use wavelets for data analysis.</p>
<p>A lot will depend on the choices you make; which wavelet transform will you use, CWT or DWT? which wavelet family will you use? Up to which level of decomposition will you go? What is the right range of scales to use?</p>
<p>Like most things in life, the only way to master a new method is by a lot of practice. You can look up some literature to see what the commonly used wavelet type is for your specific problem, but do not make the mistake of thinking whatever you read in research papers is the holy and you don&#8217;t need to look any further.  🙂</p>
<p><strong>PS: You can also find the code in this blog-post in five different Jupyter notebooks in <a href="https://github.com/taspinar/siml" target="_blank" rel="noopener">my Github repository</a>.</strong></p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Delen:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-4014" class="share-twitter sd-button share-icon no-text" href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?share=twitter" target="_blank" title="Klik om te delen met Twitter"><span></span><span class="sharing-screen-reader-text">Klik om te delen met Twitter (Wordt in een nieuw venster geopend)</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-4014" class="share-facebook sd-button share-icon no-text" href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?share=facebook" target="_blank" title="Klik om te delen op Facebook"><span></span><span class="sharing-screen-reader-text">Klik om te delen op Facebook (Wordt in een nieuw venster geopend)</span></a></li><li class="share-end"></li></ul></div></div></div><div class="addtoany_share_save_container addtoany_content addtoany_content_bottom"><div class="addtoany_header">Share This:</div><div class="a2a_kit a2a_kit_size_32 addtoany_list" data-a2a-url="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/" data-a2a-title="A guide for using the Wavelet Transform in Machine Learning"><a class="a2a_button_facebook" href="https://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fataspinar.com%2F2018%2F12%2F21%2Fa-guide-for-using-the-wavelet-transform-in-machine-learning%2F&amp;linkname=A%20guide%20for%20using%20the%20Wavelet%20Transform%20in%20Machine%20Learning" title="Facebook" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_twitter" href="https://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fataspinar.com%2F2018%2F12%2F21%2Fa-guide-for-using-the-wavelet-transform-in-machine-learning%2F&amp;linkname=A%20guide%20for%20using%20the%20Wavelet%20Transform%20in%20Machine%20Learning" title="Twitter" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_reddit" href="https://www.addtoany.com/add_to/reddit?linkurl=https%3A%2F%2Fataspinar.com%2F2018%2F12%2F21%2Fa-guide-for-using-the-wavelet-transform-in-machine-learning%2F&amp;linkname=A%20guide%20for%20using%20the%20Wavelet%20Transform%20in%20Machine%20Learning" title="Reddit" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_linkedin" href="https://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fataspinar.com%2F2018%2F12%2F21%2Fa-guide-for-using-the-wavelet-transform-in-machine-learning%2F&amp;linkname=A%20guide%20for%20using%20the%20Wavelet%20Transform%20in%20Machine%20Learning" title="LinkedIn" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_sina_weibo" href="https://www.addtoany.com/add_to/sina_weibo?linkurl=https%3A%2F%2Fataspinar.com%2F2018%2F12%2F21%2Fa-guide-for-using-the-wavelet-transform-in-machine-learning%2F&amp;linkname=A%20guide%20for%20using%20the%20Wavelet%20Transform%20in%20Machine%20Learning" title="Sina Weibo" rel="nofollow noopener" target="_blank"></a><a class="a2a_dd addtoany_share_save addtoany_share" href="https://www.addtoany.com/share"></a></div></div>			</div><!-- .entry-content -->

	<footer class="entry-footer">
			</footer><!-- .entry-footer -->

	
</article><!-- #post-## -->

				<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Berichtnavigatie</h2>
		<div class="nav-links clearfix">
			<div class="nav-previous"><span>&#10229;</span><a href="https://ataspinar.com/2018/07/05/building-recurrent-neural-networks-in-tensorflow/" rel="prev">Building Recurrent Neural Networks in Tensorflow</a></div><div class="nav-next"><a href="https://ataspinar.com/2020/12/22/time-series-forecasting-with-stochastic-signal-analysis-techniques/" rel="next">Time-Series forecasting with Stochastic Signal Analysis techniques</a><span>&#10230;</span></div>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
			
<div id="comments" class="comments-area">

	
			<h4 class="comment-title">
			88 gedachten over &ldquo;<span>A guide for using the Wavelet Transform in Machine Learning</span>&rdquo;		</h4>

		
		<ol class="comments-list">
					<li id="comment-365" class="comment even thread-even depth-1">
			<article id="div-comment-365" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ac602fa3fa905f6758b9022c783491c9?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ac602fa3fa905f6758b9022c783491c9?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Gareth</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-365"><time datetime="2018-12-21T08:58:37+00:00">december 21, 2018 om 8:58 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Firstly thank you, great article, I had been aware of wavelets for some decades as an Electrical/Controls engineer but never fully grasped even the basic relationship to Fourier transforms of them until now.</p>
<p>In your closing summary you ask &#8220;This really makes me wonder, what the hell Recurrent Neural Networks are actually good for. &#8220;.</p>
<p>I contemplate that RNNs are more like direct computational logic than intelligence or thought as we call it &#8211; they basically give a static output if given a static input. How does this allow spontaneous &#8220;thought&#8221; or &#8220;ideas&#8221; to emerge or be synthesised?</p>
<p>The human brain has waves, it seems the role of these waves in consciousness, thought and memory is only just starting to be contemplated in any detail. </p>
<p>In the physical world in order for there to be waves, or oscillations, generally a system needs to have an appropriately changed phase signal fed back back to an input or earlier processing stage. (Controls theory have negative feedback in the basic PID building block, but it depends on the transfer function of the part of the network/system you feed back around to the input of).</p>
<p>A network model that had this structure might not be statically stable, but if effectively critically damped, it could be dynamically stable &#8211; continuous waves, and of many frequencies and amplitudes and localised at different scales.</p>
<p>Maybe the physical connections between the neurons are only part of the mystery of what makes us human, no matter the number and complexity. </p>
<p>Is there also a need energy for waves continuously &#8220;circulating&#8221; and constantly creating some kind of stimulation at different times to different parts of the neuronal network to allow us to hallucinate our reality. Interrupting these waves too severely maybe throws the pattern into an unrecoverable, or decaying mode. (Which also then begs the question, how do they start at the beginning of life?)</p>
<p>Could the multiple waves, localised at overlapping scales combine to create wavelets, in a manner not unlike the creation a Fourier impulse function? And would that then allow the brain to generate complexity out of simplicity and also analyse observed patterns in both a time and frequency based way? (I am totally out of my depth here by now, just expanding a spontaneous idea)</p>
<p>Do the brains waves could also explain death and loss of consciousness where the physical structure is effectively unchanged but something is lost, the measurable thing being the brain waves. If it were to be the waves that are lost and they are part of what makes us conscious, self aware and gift us emergent thinking?</p>
<p>Disclaimer : This is all just semi random thoughts I had while reading the article, I am not more than an amateur in most of these matters and welcome informed comment.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=365#respond' data-commentid="365" data-postid="4014" data-belowelement="div-comment-365" data-respondelement="respond" data-replyto="Antwoord op Gareth" aria-label='Antwoord op Gareth'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-366" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-366" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/f303bbfa8546e4534d0694ba25c88db5?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f303bbfa8546e4534d0694ba25c88db5?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn"><a href='http://datamutation.net' rel='external nofollow ugc' class='url'>Francois Bagaini</a></b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-366"><time datetime="2018-12-26T17:45:52+00:00">december 26, 2018 om 5:45 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you for this awesome article. I&#8217;m working with wavelets and deep learning for signal processing, but I was not sure to well understand maths under the hood. Your examples are absolutely meaningful and of great help. Your the man! Thanks again for sharing.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=366#respond' data-commentid="366" data-postid="4014" data-belowelement="div-comment-366" data-respondelement="respond" data-replyto="Antwoord op Francois Bagaini" aria-label='Antwoord op Francois Bagaini'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-516" class="comment even depth-2">
			<article id="div-comment-516" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/e579168f937d6ad510b3262a754a6968?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e579168f937d6ad510b3262a754a6968?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">shahnaz</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-516"><time datetime="2021-07-04T01:29:21+00:00">juli 4, 2021 om 1:29 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>for the code for figure 1, get_fft_values  module if from which library. numpy of scipy. it is not mentioned</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=516#respond' data-commentid="516" data-postid="4014" data-belowelement="div-comment-516" data-respondelement="respond" data-replyto="Antwoord op shahnaz" aria-label='Antwoord op shahnaz'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-371" class="comment odd alt thread-even depth-1">
			<article id="div-comment-371" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/8b76c3cb9eddb6cc02c400ba41a46c04?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8b76c3cb9eddb6cc02c400ba41a46c04?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Ramesh</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-371"><time datetime="2019-02-01T21:54:17+00:00">februari 1, 2019 om 9:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I enjoyed every part of the article and along the way I had a lot of ideas. Thanks a lot.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=371#respond' data-commentid="371" data-postid="4014" data-belowelement="div-comment-371" data-respondelement="respond" data-replyto="Antwoord op Ramesh" aria-label='Antwoord op Ramesh'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-373" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-373" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/999c128e22e2a49a2c5d1f35b0bec9ec?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/999c128e22e2a49a2c5d1f35b0bec9ec?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Stone</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-373"><time datetime="2019-02-25T21:47:09+00:00">februari 25, 2019 om 9:47 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Great article! Really helpful! Thank you so much for sharing all these things!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=373#respond' data-commentid="373" data-postid="4014" data-belowelement="div-comment-373" data-respondelement="respond" data-replyto="Antwoord op Stone" aria-label='Antwoord op Stone'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-375" class="comment odd alt thread-even depth-1">
			<article id="div-comment-375" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1d114ea045eea77865593018fcc0672a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1d114ea045eea77865593018fcc0672a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">William</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-375"><time datetime="2019-03-06T02:34:42+00:00">maart 6, 2019 om 2:34 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Inedible overview &#8211; thank you for such an easy to understand and replicate guide!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=375#respond' data-commentid="375" data-postid="4014" data-belowelement="div-comment-375" data-respondelement="respond" data-replyto="Antwoord op William" aria-label='Antwoord op William'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-376" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-376" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/86549247412a1fdec45af9ae4ff128c1?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/86549247412a1fdec45af9ae4ff128c1?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Rizkia Ilham Ramadhan</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-376"><time datetime="2019-03-07T14:40:05+00:00">maart 7, 2019 om 2:40 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>What a great article, Thank you so muchh !</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=376#respond' data-commentid="376" data-postid="4014" data-belowelement="div-comment-376" data-respondelement="respond" data-replyto="Antwoord op Rizkia Ilham Ramadhan" aria-label='Antwoord op Rizkia Ilham Ramadhan'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-377" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-377" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1c403ef65230f4373cafd4e37425478d?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1c403ef65230f4373cafd4e37425478d?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Julien</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-377"><time datetime="2019-03-13T15:19:59+00:00">maart 13, 2019 om 3:19 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Awesome article!<br />
this is really helpful, Thanks!</p>
<p>I do not quite grasp the  how the DWT algorithm is working (maybe that comes from a lack of understanding of what a filter bank is actually doing). Would you say that a first pass of the DWT is doing a convolution between the signal and the wavelet (and would that be the approximation coefficients?, in that case how do you get the detailed ones?). then the second pass is doing the same on the approximation coefficents, etc. Is that right?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=377#respond' data-commentid="377" data-postid="4014" data-belowelement="div-comment-377" data-respondelement="respond" data-replyto="Antwoord op Julien" aria-label='Antwoord op Julien'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-378" class="comment byuser comment-author-admin bypostauthor even depth-2">
			<article id="div-comment-378" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-378"><time datetime="2019-03-15T10:49:06+00:00">maart 15, 2019 om 10:49 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Julien,<br />
Thank you for your response. In regards to your question, I think you almost got it right.<br />
The DWT on any signal results in a set of two coefficient; approximation which correspond with the lower frequencies and detail coefficients which correspond with the higher frequencies. Lets call these cA1 and cD1.<br />
The second pass is done on the approximation coefficients; so the sub-band containing the lower frequencies is split into approximation and detail coefficients again. Lets call them cA2 and cD2.<br />
This is done up to the maximum decomposition level n.<br />
As you can see in the documentation of <a href="https://pywavelets.readthedocs.io/en/latest/ref/dwt-discrete-wavelet-transform.html#multilevel-decomposition-using-wavedec" target="_blank" rel="noopener nofollow">pywt.wavedec()</a> the final output is [cAn, cDn, cDn-1, &#8230;, cD2, cD1].</p>
<p>If you want, you can also have a look at <a href="https://www.math.aau.dk/digitalAssets/120/120646_r-2003-24.pdf" target="_blank" rel="noopener nofollow">this simple example</a> of the DWT.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=378#respond' data-commentid="378" data-postid="4014" data-belowelement="div-comment-378" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-380" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-380" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/bfd12e4736496d21bf2fbe96b9c72b5e?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bfd12e4736496d21bf2fbe96b9c72b5e?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Sam</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-380"><time datetime="2019-03-26T18:42:31+00:00">maart 26, 2019 om 6:42 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi,  I was trying to run your code but it doesn&#8217;t have the code for the below function.  Can you please help me with that?<br />
get_ave_values(time, signal, average_over)</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=380#respond' data-commentid="380" data-postid="4014" data-belowelement="div-comment-380" data-respondelement="respond" data-replyto="Antwoord op Sam" aria-label='Antwoord op Sam'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-393" class="comment byuser comment-author-admin bypostauthor even depth-2">
			<article id="div-comment-393" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-393"><time datetime="2019-04-12T09:24:13+00:00">april 12, 2019 om 9:24 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>See: <a href="https://github.com/taspinar/siml/blob/master/notebooks/WV2%20-%20Visualizing%20the%20Scaleogram%2C%20time-axis%20and%20Fourier%20Transform.ipynb" rel="nofollow ugc">https://github.com/taspinar/siml/blob/master/notebooks/WV2%20-%20Visualizing%20the%20Scaleogram%2C%20time-axis%20and%20Fourier%20Transform.ipynb</a></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=393#respond' data-commentid="393" data-postid="4014" data-belowelement="div-comment-393" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-381" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-381" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4aefa6173df962ad926e8f5397784003?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4aefa6173df962ad926e8f5397784003?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Rui</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-381"><time datetime="2019-03-29T02:16:44+00:00">maart 29, 2019 om 2:16 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>hello , Nice Job ! I will test on my dataset .</p>
<p>I have some questions looking at the code using CNN after CWT.<br />
you have 6 classes but then you update de num_classes var to 7 ? (this can induce incorrect values for accuracy&#8230;) or it must be 7 for some reason ?<br />
Also at the end of the notebook you plot the history.acc saying it is the test set &#8230; for the test set it must be history.val_acc that is a lit bit lower &#8230; </p>
<p>nice job in general of course ! 😉</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=381#respond' data-commentid="381" data-postid="4014" data-belowelement="div-comment-381" data-respondelement="respond" data-replyto="Antwoord op Rui" aria-label='Antwoord op Rui'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-389" class="comment byuser comment-author-admin bypostauthor even depth-2">
			<article id="div-comment-389" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-389"><time datetime="2019-04-05T09:42:15+00:00">april 5, 2019 om 9:42 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Rui,<br />
Thank you for the feedback.<br />
I had forgotten that the labels for the classes are starting with index 1, while keras assumes the labeling for the classes start with index 0.<br />
I have updated the code as well as the figures is in the blog-post and on the notebook on GitHub.<br />
PS: The accuracy does get a small percentage better, but I would say it falls within the range of fluctuations.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=389#respond' data-commentid="389" data-postid="4014" data-belowelement="div-comment-389" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-382" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-382" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4aefa6173df962ad926e8f5397784003?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4aefa6173df962ad926e8f5397784003?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Rui</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-382"><time datetime="2019-03-29T17:15:29+00:00">maart 29, 2019 om 5:15 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>hello !<br />
the CWT operation is so slow&#8230; or is just me ?  is there any way to speed up this transformation ?<br />
Thanks !<br />
Rui</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=382#respond' data-commentid="382" data-postid="4014" data-belowelement="div-comment-382" data-respondelement="respond" data-replyto="Antwoord op Rui" aria-label='Antwoord op Rui'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-383" class="comment byuser comment-author-admin bypostauthor even depth-2">
			<article id="div-comment-383" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-383"><time datetime="2019-03-29T17:57:25+00:00">maart 29, 2019 om 5:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I assume were talking about an input signal with a high sampling rate and lots of samples. I also experienced the same problem. I dont have a definite solution but I think you should have a look at the scales youre using.<br />
Also see <a href="https://groups.google.com/forum/m/#!topic/pywavelets/Z1ThBeG2oIo" rel="nofollow ugc">https://groups.google.com/forum/m/#!topic/pywavelets/Z1ThBeG2oIo</a></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=383#respond' data-commentid="383" data-postid="4014" data-belowelement="div-comment-383" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-384" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-384" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1f41d9f9cb92c9e5027c0fd70ec35115?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f41d9f9cb92c9e5027c0fd70ec35115?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Jorge</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-384"><time datetime="2019-04-01T15:40:23+00:00">april 1, 2019 om 3:40 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>hello,</p>
<p>I have test this method on my dataset but the model does not converge &#8230; with LSTM it converges 10% above base line (it is a difficult dataset to learn). But the conclusion is that LSTM is better at least in my case-study. I have another 3 case studies to test &#8230; lets see. </p>
<p>Also I have found some bugs/issues in your notebook&#8230;<br />
&#8211; The N_CLASSES are 6 in the datset but in the network but you have 7.<br />
&#8211; your normalization is not well done&#8230; I see you copy paste the CNN from some example with mnist and here normalization are made with min=0 and max=255 (that is why you divide the all dataset by 255) but in your case the min max values are around 6 &#8230;<br />
&#8211; You shuffle the data-set before you divide into train test &#8230; I dont know if there is some &#8220;continuity&#8221; in the collection of data but if there is you end up with very similar examples in the test dataset and train &#8230; For LSTM if your batch is not size 1 this has implications because the &#8220;CELL&#8221; memory is reset only when it changes batch on train&#8230; </p>
<p>All this &#8220;bugs&#8221; mainly the one with 7 classes and wrong normalizations makes the all final results  uncertainty&#8230; I will try to correct this issues  and see if the ACC is really that . And retrain one LSTM exactly with the same train/test data (no randoms and no truncated data to 5000 and 500 like you do &#8230; all equal for both models).</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=384#respond' data-commentid="384" data-postid="4014" data-belowelement="div-comment-384" data-respondelement="respond" data-replyto="Antwoord op Jorge" aria-label='Antwoord op Jorge'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-385" class="comment even depth-2 parent">
			<article id="div-comment-385" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1f41d9f9cb92c9e5027c0fd70ec35115?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f41d9f9cb92c9e5027c0fd70ec35115?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Jorge</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-385"><time datetime="2019-04-02T01:45:50+00:00">april 2, 2019 om 1:45 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>well&#8230; I have clean your code :<br />
-nb_classes 6 not 7<br />
-no shuffling data<br />
-correct normalization<br />
-correct acc_VAL plot (not history.acc) </p>
<p>and the conclusions are not good for this method </p>
<p>Epoch 10/10<br />
4000/4000 [==============================] &#8211; 21s 5ms/step &#8211; loss: 0.0691 &#8211; acc: 0.9650 &#8211; val_loss: 0.2654 &#8211; val_acc: 0.8940<br />
Test loss: 0.2653581520216439<br />
Test accuracy: 0.8939999990463257</p>
<p>I &#8220;blow&#8221; the computer memory and takes about 1 hour to build the CWT features &#8230; </p>
<p>If you apply a simple  CNN directly to the data you have this in 10 seconds :<br />
Epoch 71/400<br />
4000/4000 [==============================] &#8211; 3s 785us/step &#8211; loss: 0.1284 &#8211; acc: 0.9535 &#8211; val_loss: 0.4725 &#8211; val_acc: 0.9420</p>
<p>I did not apply LSTM yet &#8230; I will come back in a second &#8230;</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=385#respond' data-commentid="385" data-postid="4014" data-belowelement="div-comment-385" data-respondelement="respond" data-replyto="Antwoord op Jorge" aria-label='Antwoord op Jorge'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-386" class="comment odd alt depth-3">
			<article id="div-comment-386" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1f41d9f9cb92c9e5027c0fd70ec35115?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f41d9f9cb92c9e5027c0fd70ec35115?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Jorge</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-386"><time datetime="2019-04-02T16:00:41+00:00">april 2, 2019 om 4:00 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>using LSTM bidirectional :<br />
4000/4000 [==============================] &#8211; 262s 66ms/step &#8211; loss: 0.3157 &#8211; acc: 0.8733 &#8211; val_loss: 0.2348 &#8211; val_acc: 0.8980<br />
(iteration 26)<br />
I think the best method is CNN directly (with out CWT) for this case study since we have segmented time-series and memory is not important &#8230;<br />
PS: CWT only introduce entropy to all problem &#8230; can be discarded</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=386#respond' data-commentid="386" data-postid="4014" data-belowelement="div-comment-386" data-respondelement="respond" data-replyto="Antwoord op Jorge" aria-label='Antwoord op Jorge'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-390" class="comment byuser comment-author-admin bypostauthor even depth-3">
			<article id="div-comment-390" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-390"><time datetime="2019-04-05T09:58:17+00:00">april 5, 2019 om 9:58 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Jorge,<br />
Thanks for the feedback as well.<br />
It was already mentioned that the num of classes is wrong. I have updated this in the code and on the notebook on GitHub.<br />
The errors you mentioned (&#8216;normalization by 255&#8217; / val_acc) have been removed in the code and run again. Results are very similar to the previous version. </p>
<p>I understand that for this simple toy-dataset applying a CNN directly to the signal also gives really good results. However, I am curious whether that will still be the case for more complicated datasets or whether the CWT does provide an additional benefit.<br />
In any case, CNN&#8217;s are a very powerful tool and by the looks of your code outperform LSTM&#8217;s for this dataset. I believe there have also been numerous papers written on CNN&#8217;s outperforming LSTM&#8217;s.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=390#respond' data-commentid="390" data-postid="4014" data-belowelement="div-comment-390" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-515" class="comment odd alt depth-3">
			<article id="div-comment-515" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/3272c779631be6390961b69c807fd4e0?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3272c779631be6390961b69c807fd4e0?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn"><a href='https://%20www.aaua.edu.bg' rel='external nofollow ugc' class='url'>J.K Adedeji</a></b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-515"><time datetime="2021-05-28T13:52:59+00:00">mei 28, 2021 om 1:52 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Very impressive and elaborate research, thanks for helping my research on wavelets analysis.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=515#respond' data-commentid="515" data-postid="4014" data-belowelement="div-comment-515" data-respondelement="respond" data-replyto="Antwoord op J.K Adedeji" aria-label='Antwoord op J.K Adedeji'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-391" class="comment byuser comment-author-admin bypostauthor even depth-2 parent">
			<article id="div-comment-391" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-391"><time datetime="2019-04-05T10:18:11+00:00">april 5, 2019 om 10:18 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi jorge, I have updated the code for num_classes and normalization of the data.<br />
In regards to the shuffling, I do think it is necessary since in this dataset the classes are not randomly ordered (see y_train.txt / y_test.txt).<br />
In any case, the files are splitted in a train and a test set in the original dataset, so there is no need to worry about that.</p>
<p>PS: What are the other use cases?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=391#respond' data-commentid="391" data-postid="4014" data-belowelement="div-comment-391" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-403" class="comment odd alt depth-3 parent">
			<article id="div-comment-403" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4aefa6173df962ad926e8f5397784003?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4aefa6173df962ad926e8f5397784003?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Rui</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-403"><time datetime="2019-04-29T14:35:33+00:00">april 29, 2019 om 2:35 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hello, I have been toying with this data set (this blog motivated me to do so 😉 )  I have reach state of the art results (better than 1st place on kaggle using exactly the UCI raw data sets &#8211; some papers present good results but they cheat altering the dataset (e.g. you can see on the confusion matrix the number of examples is different than the original in the test set &#8230;)) and I am going to publish my method and I would like to reference this work &#8230; Do you have any article on this ? what is the best way to refer to this work in an article?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=403#respond' data-commentid="403" data-postid="4014" data-belowelement="div-comment-403" data-respondelement="respond" data-replyto="Antwoord op Rui" aria-label='Antwoord op Rui'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-404" class="comment byuser comment-author-admin bypostauthor even depth-4 parent">
			<article id="div-comment-404" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-404"><time datetime="2019-04-29T15:38:50+00:00">april 29, 2019 om 3:38 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Rui,<br />
Pretty cool of you. Hope you can publish a good article!<br />
I am also thinking of publishing an article, but I did not have time so far to write anything up. So you only have this blog-post to refer to ATM. </p>
<p>I don&#8217;t know exactly it works, but in the past my blog has been referred to with either<br />
a) only a reference to the page,<br />
b) Name, blog title, blog url<br />
c) Name, blog title, blog url, github page<br />
You can have a look at some examples at <a href="https://scholar.google.nl/scholar?hl=nl&#038;as_sdt=0%2C5&#038;q=ataspinar.com&#038;btnG=" rel="nofollow ugc">https://scholar.google.nl/scholar?hl=nl&#038;as_sdt=0%2C5&#038;q=ataspinar.com&#038;btnG=</a></p>
<p>In any case, good luck with the article.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=404#respond' data-commentid="404" data-postid="4014" data-belowelement="div-comment-404" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-405" class="comment odd alt depth-5">
			<article id="div-comment-405" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4aefa6173df962ad926e8f5397784003?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4aefa6173df962ad926e8f5397784003?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Rui</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-405"><time datetime="2019-04-29T16:57:03+00:00">april 29, 2019 om 4:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I will use this : </p>
<p>@online{wletCNN,<br />
  author = {Ahmet Taspinar},<br />
  title = {A guide for using the Wavelet Transform in Machine Learning.},<br />
  year = 2018,<br />
  url = {https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/},<br />
  urldate = {2018-12-21}<br />
}</p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-392" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-392" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/04286b6f91efc74504ab1d75e477fa83?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/04286b6f91efc74504ab1d75e477fa83?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Pau Labarta Bajo</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-392"><time datetime="2019-04-12T09:16:40+00:00">april 12, 2019 om 9:16 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks a lot for this blog post. It is super useful!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=392#respond' data-commentid="392" data-postid="4014" data-belowelement="div-comment-392" data-respondelement="respond" data-replyto="Antwoord op Pau Labarta Bajo" aria-label='Antwoord op Pau Labarta Bajo'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-398" class="comment odd alt thread-even depth-1">
			<article id="div-comment-398" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9c5af4a6c86f457febc2efb03ec9e033?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9c5af4a6c86f457febc2efb03ec9e033?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Seoul</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-398"><time datetime="2019-04-18T07:04:51+00:00">april 18, 2019 om 7:04 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks a lot for this blog post.</p>
<p>I have a question.<br />
I think that the result of the CWT pre-processing of the signal will be positive and negative and Max will be different. By the way,<br />
How did you Nomalize the value before putting it in deep running?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=398#respond' data-commentid="398" data-postid="4014" data-belowelement="div-comment-398" data-respondelement="respond" data-replyto="Antwoord op Seoul" aria-label='Antwoord op Seoul'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-401" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-401" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d05aea2b8c00cb30ce192cb6cb705348?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d05aea2b8c00cb30ce192cb6cb705348?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">zoe</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-401"><time datetime="2019-04-25T21:21:47+00:00">april 25, 2019 om 9:21 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Great post!<br />
I have a small question. I try to use &#8220;Image.fromarray&#8221; save 3-d data to a RGB image. However, the image looks quite different from the plot in Figure 8 and 9. Do you why?<br />
Should I use plot image to train?<br />
Thanks a lot.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=401#respond' data-commentid="401" data-postid="4014" data-belowelement="div-comment-401" data-respondelement="respond" data-replyto="Antwoord op zoe" aria-label='Antwoord op zoe'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-402" class="comment odd alt depth-2">
			<article id="div-comment-402" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d05aea2b8c00cb30ce192cb6cb705348?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d05aea2b8c00cb30ce192cb6cb705348?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">zoe</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-402"><time datetime="2019-04-25T22:37:35+00:00">april 25, 2019 om 10:37 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>problem fixed by using<br />
.astype(np.uint8)</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=402#respond' data-commentid="402" data-postid="4014" data-belowelement="div-comment-402" data-respondelement="respond" data-replyto="Antwoord op zoe" aria-label='Antwoord op zoe'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-406" class="comment even thread-even depth-1 parent">
			<article id="div-comment-406" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9c5af4a6c86f457febc2efb03ec9e033?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9c5af4a6c86f457febc2efb03ec9e033?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Seoul</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-406"><time datetime="2019-05-03T07:08:13+00:00">mei 3, 2019 om 7:08 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks a lot for this blog post.</p>
<p>I think that the result of the CWT pre-processing of the signal will be positive and negative and Max will be different. By the way,<br />
How did you Nomalize the value before putting it in deep running?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=406#respond' data-commentid="406" data-postid="4014" data-belowelement="div-comment-406" data-respondelement="respond" data-replyto="Antwoord op Seoul" aria-label='Antwoord op Seoul'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-408" class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<article id="div-comment-408" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-408"><time datetime="2019-05-06T05:53:50+00:00">mei 6, 2019 om 5:53 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Seoul,<br />
This really depends on the input signal. For example, if it has a high sampling rate there is a large chance there will outliers in the signal and standard scaling of min/max scaling do not perform optimally. Then I scale with percentiles instead of the min and max. Like this:</p>
<p>def normalize_signal(signal):<br />
    p99 = np.nanpercentile(signal, 99.9)<br />
    p01 = np.nanpercentile(signal, 0.1)<br />
    height = p99-p01<br />
    normalized_signal = ((signal &#8211; p01) / (height/2)) &#8211; 1<br />
    return [p01, p99, normalized_signal]</p>
<p>I guess this corresponds with the RobustScaler. You can also have a look here for a comparison of the different scalers.<br />
<a href="https://scikit-learn.org/stable/auto_examples/preprocessing/plot_all_scaling.html" rel="nofollow ugc">https://scikit-learn.org/stable/auto_examples/preprocessing/plot_all_scaling.html</a></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=408#respond' data-commentid="408" data-postid="4014" data-belowelement="div-comment-408" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-409" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-409" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/301ffb35dbf68ebc08c37be8086fce43?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/301ffb35dbf68ebc08c37be8086fce43?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Yijian</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-409"><time datetime="2019-05-27T15:57:00+00:00">mei 27, 2019 om 3:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hello,</p>
<p>Thank you so much for this post, it&#8217;s super enlightening! I have a few minor questions though.</p>
<p>For the CWT scaleogram in Figure 8, how did you observe the &#8220;shift from shorter to longer periods as time progresses&#8221;? It seems the exact opposite to me, for as the time progresses, the peaks of positive periods (red parts) shift upward to the region where periods are shorter?</p>
<p>Also, I&#8217;m currently dealing with some seismic signals, which are better processed by continous wavelets like Morlet or Ricker Wavelet, but I&#8217;m using LGBM. So I wonder if there&#8217;s a way to extract features from CWT like you did in section 2.5 from each sub-band on DWT? I see that pywt.cwt() returns a 1 dimension coefficient array just like DWT, but it seems I need to manually enter each scale? I&#8217;m kinda confused&#8230;</p>
<p>Once again really appreciate your time and insights!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=409#respond' data-commentid="409" data-postid="4014" data-belowelement="div-comment-409" data-respondelement="respond" data-replyto="Antwoord op Yijian" aria-label='Antwoord op Yijian'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-410" class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<article id="div-comment-410" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-410"><time datetime="2019-05-27T17:54:51+00:00">mei 27, 2019 om 5:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Yijan,<br />
Thanks for the  comment!<br />
I was referring to the later period 1960 and upwards, where you can also see higher values in the longer periods (32 years). </p>
<p><code>pywt.cwt()</code> actually returns two items: coefficients and frequencies.<br />
frequencies is indeed a one dimensional array, but coefficients is an two dimensional array!<br />
print(coefficients.shape) &#8211;> (127, 503)<br />
print(frequencies.shape) &#8211;> (127,)</p>
<p>If have never tried it myself, but you can try to generate features out of each row of the &#8216;coefficients&#8217; array (or out of every n rows). </p>
<p>Good luck!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=410#respond' data-commentid="410" data-postid="4014" data-belowelement="div-comment-410" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-411" class="comment even thread-even depth-1">
			<article id="div-comment-411" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1cc0f4ba0498ff91f0fb8b589cbb7373?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1cc0f4ba0498ff91f0fb8b589cbb7373?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Wasim</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-411"><time datetime="2019-06-02T23:41:26+00:00">juni 2, 2019 om 11:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you so much Ahmet for a wonderful explanation of wavelet transform and its application. I learned alot from your blog. Keep doing the great work! May God bless you 🙂</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=411#respond' data-commentid="411" data-postid="4014" data-belowelement="div-comment-411" data-respondelement="respond" data-replyto="Antwoord op Wasim" aria-label='Antwoord op Wasim'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-412" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-412" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/19004af386eca3a3f32c0e4df0737bee?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/19004af386eca3a3f32c0e4df0737bee?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Hay Macau</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-412"><time datetime="2019-06-19T14:19:37+00:00">juni 19, 2019 om 2:19 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you very much for the great article. Just a minor point: Figure 15 maybe should be the last red adds with all the green, right? Again, thanks very much!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=412#respond' data-commentid="412" data-postid="4014" data-belowelement="div-comment-412" data-respondelement="respond" data-replyto="Antwoord op Hay Macau" aria-label='Antwoord op Hay Macau'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-426" class="comment byuser comment-author-admin bypostauthor even depth-2">
			<article id="div-comment-426" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-426"><time datetime="2019-09-30T10:16:42+00:00">september 30, 2019 om 10:16 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Hay,<br />
I don&#8217;t know exactly what you mean. It could be that the colors are not correct.<br />
The idea is that the output of pywt.wavedec(), which contains a list of sets of coefficients is used as input for a feature generator function.<br />
As long as you are consistent, the order of the coefficients does not really matter.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=426#respond' data-commentid="426" data-postid="4014" data-belowelement="div-comment-426" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-413" class="comment odd alt thread-even depth-1">
			<article id="div-comment-413" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/2908a8226018f15aa905960a0083843d?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2908a8226018f15aa905960a0083843d?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Bryan Fry</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-413"><time datetime="2019-06-27T18:50:51+00:00">juni 27, 2019 om 6:50 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Ahmet &#8212; I almost never comment on anything on the internet &#8230; just wanted to say that this is a tremendously well-written and helpful article.  Your figures get straight to the fundamental mechanisms and practical benefits of wavelets.  AND you have exactly the right amount of theory to help me get some intuition about what is happening, without a bunch of detailed math that just obscures things.  And straightforward code with real data.  </p>
<p>Great stuff&#8230;. thanks for your time in putting this together.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=413#respond' data-commentid="413" data-postid="4014" data-belowelement="div-comment-413" data-respondelement="respond" data-replyto="Antwoord op Bryan Fry" aria-label='Antwoord op Bryan Fry'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-414" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-414" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5a2214f7d3943348eef85920b0900dc2?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5a2214f7d3943348eef85920b0900dc2?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">angus</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-414"><time datetime="2019-07-01T07:38:00+00:00">juli 1, 2019 om 7:38 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi, thanks a lot for this article. I&#8217;ve great results using your lowpassfilter function, but I&#8217;m facing a random issue with it, as sometimes, its output is of different shape with one more sample than in the input.<br />
Any idea why?<br />
Thanks anyway.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=414#respond' data-commentid="414" data-postid="4014" data-belowelement="div-comment-414" data-respondelement="respond" data-replyto="Antwoord op angus" aria-label='Antwoord op angus'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-416" class="comment odd alt thread-even depth-1">
			<article id="div-comment-416" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ec338471c693a0c79d82fcd7aed0c1a5?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ec338471c693a0c79d82fcd7aed0c1a5?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Reza</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-416"><time datetime="2019-07-14T21:32:33+00:00">juli 14, 2019 om 9:32 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Great and helpful article, thanks a lot. </p>
<p>I implemented the DWT successfully on a time series, and then I used the level 5 of approximation coefficients and level 1, level 2, level 3, level 4, and level5 of detail coefficients (cA5, cD5, cD4, cD3, cD2, and cD1) as train for machine learning.</p>
<p>But I am facing with a problem, because of decrease the number of samples by each level; I can’t match the different levels of decomposition together.<br />
Could you please help me with that?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=416#respond' data-commentid="416" data-postid="4014" data-belowelement="div-comment-416" data-respondelement="respond" data-replyto="Antwoord op Reza" aria-label='Antwoord op Reza'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-417" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-417" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/736796f3c5b933c3358ed35a2c5df986?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/736796f3c5b933c3358ed35a2c5df986?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Keith</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-417"><time datetime="2019-07-20T04:20:09+00:00">juli 20, 2019 om 4:20 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi</p>
<p>For the CNN + CWT example, I am not getting the same accuracy as you:<br />
&#8212;<br />
5000/5000 [==============================] &#8211; 32s 6ms/step &#8211; loss: 0.4976 &#8211; acc: 0.8670 &#8211; val_loss: 0.6622 &#8211; val_acc: 0.7460<br />
Epoch 2/10<br />
5000/5000 [==============================] &#8211; 37s 7ms/step &#8211; loss: 0.1874 &#8211; acc: 0.9300 &#8211; val_loss: 0.5222 &#8211; val_acc: 0.8140<br />
Epoch 3/10<br />
5000/5000 [==============================] &#8211; 45s 9ms/step &#8211; loss: 0.1634 &#8211; acc: 0.9378 &#8211; val_loss: 0.4913 &#8211; val_acc: 0.8460<br />
Epoch 4/10<br />
5000/5000 [==============================] &#8211; 47s 9ms/step &#8211; loss: 0.1698 &#8211; acc: 0.9428 &#8211; val_loss: 0.6755 &#8211; val_acc: 0.7320<br />
Epoch 5/10<br />
5000/5000 [==============================] &#8211; 51s 10ms/step &#8211; loss: 0.1681 &#8211; acc: 0.9388 &#8211; val_loss: 0.6140 &#8211; val_acc: 0.7860<br />
Epoch 6/10<br />
5000/5000 [==============================] &#8211; 52s 10ms/step &#8211; loss: 0.1501 &#8211; acc: 0.9450 &#8211; val_loss: 0.6650 &#8211; val_acc: 0.7020<br />
Epoch 7/10<br />
5000/5000 [==============================] &#8211; 51s 10ms/step &#8211; loss: 0.1266 &#8211; acc: 0.9530 &#8211; val_loss: 0.3773 &#8211; val_acc: 0.8420<br />
Epoch 8/10<br />
5000/5000 [==============================] &#8211; 53s 11ms/step &#8211; loss: 0.0983 &#8211; acc: 0.9630 &#8211; val_loss: 0.6188 &#8211; val_acc: 0.7080<br />
Epoch 9/10<br />
5000/5000 [==============================] &#8211; 51s 10ms/step &#8211; loss: 0.2276 &#8211; acc: 0.9372 &#8211; val_loss: 0.4089 &#8211; val_acc: 0.8020<br />
Epoch 10/10<br />
5000/5000 [==============================] &#8211; 52s 10ms/step &#8211; loss: 0.1920 &#8211; acc: 0.9492 &#8211; val_loss: 0.4823 &#8211; val_acc: 0.7540<br />
Train loss: 0.14876973194935286, Train accuracy: 0.9456<br />
Test loss: 0.48233831304311753, Test accuracy: 0.7540000004768371<br />
&#8212;<br />
The test accuracy is only 75% compared to your 94%. Do you have any ideas on why this could be the case?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=417#respond' data-commentid="417" data-postid="4014" data-belowelement="div-comment-417" data-respondelement="respond" data-replyto="Antwoord op Keith" aria-label='Antwoord op Keith'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-419" class="comment odd alt thread-even depth-1">
			<article id="div-comment-419" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7e9470c0bfeca03d584400e94f5e8707?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7e9470c0bfeca03d584400e94f5e8707?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Rajesh Saha</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-419"><time datetime="2019-08-08T10:21:10+00:00">augustus 8, 2019 om 10:21 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Very good explanation with proper code&#8230;&#8230;.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=419#respond' data-commentid="419" data-postid="4014" data-belowelement="div-comment-419" data-respondelement="respond" data-replyto="Antwoord op Rajesh Saha" aria-label='Antwoord op Rajesh Saha'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-421" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-421" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/8c8d5638f6ae9a75c0e162dc42e39d62?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8c8d5638f6ae9a75c0e162dc42e39d62?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Benjamin Ng</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-421"><time datetime="2019-09-03T10:14:48+00:00">september 3, 2019 om 10:14 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi,<br />
Could I ask how the threshold for the de-noising of the signal was determined?<br />
In the above example, 0.63*np.nanmax(signal) was used. Why was the value 0.63 select?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=421#respond' data-commentid="421" data-postid="4014" data-belowelement="div-comment-421" data-respondelement="respond" data-replyto="Antwoord op Benjamin Ng" aria-label='Antwoord op Benjamin Ng'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-422" class="comment odd alt thread-even depth-1">
			<article id="div-comment-422" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7dd78317989de083651153fbf78b135f?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7dd78317989de083651153fbf78b135f?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Min Young Kim</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-422"><time datetime="2019-09-03T20:41:36+00:00">september 3, 2019 om 8:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi, thanks for the great article! Really good resource.<br />
Is there a reason why we use only the approximation coefficients to feed into the training set, instead of using all the detail coefficients and just the last approximation coefficients? I would think that there would be a redundancy of features if we use the approximation coefficients only.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=422#respond' data-commentid="422" data-postid="4014" data-belowelement="div-comment-422" data-respondelement="respond" data-replyto="Antwoord op Min Young Kim" aria-label='Antwoord op Min Young Kim'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-424" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-424" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5ad9ec13cfb3a8aaea5b993fb8d6f7ea?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5ad9ec13cfb3a8aaea5b993fb8d6f7ea?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Balandong</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-424"><time datetime="2019-09-29T12:51:18+00:00">september 29, 2019 om 12:51 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Dear Ahmet, thank you for this awesome article and it really helpful!<br />
However I have two question from the section 3.1 Visualizing the State-Space using the Continuous Wavelet Transform.<br />
First, What is dt in line 71. Second, on line 9, what is the purposing of scales and what is the justification of selecting the range 1-128?<br />
Really appreciate for the time taken entertaining this question.<br />
Line 71: dt=0.25<br />
Line 9: [coefficients, frequencies] = pywt.cwt(signal, scales, waveletname, dt)<br />
Line 75 scales = np.arange(1, 128),</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=424#respond' data-commentid="424" data-postid="4014" data-belowelement="div-comment-424" data-respondelement="respond" data-replyto="Antwoord op Balandong" aria-label='Antwoord op Balandong'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-425" class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<article id="div-comment-425" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-425"><time datetime="2019-09-30T08:24:40+00:00">september 30, 2019 om 8:24 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Balandong,<br />
Thank you for the compliment. It is much appreciated.<br />
The el-Nino dataset contains quarterly measurements, that is why I have set the timedelta dt equal to 0.25.<br />
Scales is the wavelet equavalence of frequency. In the domain of wavelet analysis it has become the standard to use scales instead of frequencies. However, as explained in the text, scales increase inversely proportional to frequency.<br />
You can convert a scale to the corresponding frequency  value with <code>pywt.scale2frequency()</code>, so if you know which frequency range the phenomenon you are looking for will exhibit itself you can choose the scale-range accordingly.<br />
So for the above settings, a scale of 128 corresponds to a frequency of 0.0155, which corresponds to a period of 64 years.<br />
But I guess a scale of 100 or 120 would also have been OK. </p>
<p>For choosing the right scales, it might also be a big help to look at papers dealing with similar datasets.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=425#respond' data-commentid="425" data-postid="4014" data-belowelement="div-comment-425" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-428" class="comment even thread-even depth-1 parent">
			<article id="div-comment-428" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/68cbaec04ca272ef0cd812c8cc75e2d5?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/68cbaec04ca272ef0cd812c8cc75e2d5?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Sergei</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-428"><time datetime="2019-10-15T14:15:06+00:00">oktober 15, 2019 om 2:15 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi!<br />
In your ECG example it seems that you decompose the whole waveform into wavelet coefs. This implies an offline mode of processing. Could you comment on the online mode, when the signal arrives in small chunks. What is the optimal size of data, how waveform length affects feature dimension? In FFT we can focus on local signal properties, feeding the signal frame by frame. Does it make sense to do so in wavelet practice? Despite wavelet capturing multiscale features, does it make sense to work frame by frame for limiting feature size or staying online with signal reading?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=428#respond' data-commentid="428" data-postid="4014" data-belowelement="div-comment-428" data-respondelement="respond" data-replyto="Antwoord op Sergei" aria-label='Antwoord op Sergei'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-431" class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<article id="div-comment-431" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-431"><time datetime="2019-10-17T09:00:32+00:00">oktober 17, 2019 om 9:00 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Sergei,<br />
I guess the wavelet transform is less useful in an online mode (especially since it is good in localizing the frequency contents in the time-domain), but depending on the size of the small chunks it can be a little less useful or not useful at all. It also strongly depends on your choice of wavelet. For example, if the small chunks contain 60 samples (1 chunk per minute) you have four levels of decomposition with &#8216;db2&#8217; and only one with &#8216;db9&#8217; or higher.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=431#respond' data-commentid="431" data-postid="4014" data-belowelement="div-comment-431" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-429" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-429" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/024fa67e04c0dac4caf746d1fbb876a8?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/024fa67e04c0dac4caf746d1fbb876a8?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Leonardo Godói</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-429"><time datetime="2019-10-16T17:22:43+00:00">oktober 16, 2019 om 5:22 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Amazing article! It help me a lot!</p>
<p>Thank you for making the codes available!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=429#respond' data-commentid="429" data-postid="4014" data-belowelement="div-comment-429" data-respondelement="respond" data-replyto="Antwoord op Leonardo Godói" aria-label='Antwoord op Leonardo Godói'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-433" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-433" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/004a9951aea2030131bf8467eae1779c?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/004a9951aea2030131bf8467eae1779c?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Milton</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-433"><time datetime="2019-10-18T12:48:36+00:00">oktober 18, 2019 om 12:48 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Desar Ahmet,<br />
First thank you for the excellent document.<br />
Follwing the question of Balandong, how did you calculate the scale 128 with frequency (1/T)?<br />
All the best</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=433#respond' data-commentid="433" data-postid="4014" data-belowelement="div-comment-433" data-respondelement="respond" data-replyto="Antwoord op Milton" aria-label='Antwoord op Milton'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-436" class="comment byuser comment-author-admin bypostauthor even depth-2">
			<article id="div-comment-436" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-436"><time datetime="2019-10-22T08:42:23+00:00">oktober 22, 2019 om 8:42 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Milton.<br />
With pywt you can calculate it as follows:<br />
&#8220;0.25 / pywt.scale2frequency(&#8216;cmor&#8217;,128)&#8221;<br />
>>> 64.0</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=436#respond' data-commentid="436" data-postid="4014" data-belowelement="div-comment-436" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-440" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-440" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/56a906ab5e2b2110c0e3aa650e11d61b?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/56a906ab5e2b2110c0e3aa650e11d61b?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Xavier</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-440"><time datetime="2019-11-14T13:07:01+00:00">november 14, 2019 om 1:07 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi,<br />
thank you for your very interesting post. I was wondering what was the &#8216;gt&#8217; parameter within the<br />
calculate_crossings() funtion :<br />
 zero_crossing_indices = np.nonzero(np.diff(np.array(list_values) &amp; gt; 0))[0]<br />
Futhermore is it possible that it would be: &#8216;,&#8217; instead of the: &#8216;;&#8217; in the line above</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=440#respond' data-commentid="440" data-postid="4014" data-belowelement="div-comment-440" data-respondelement="respond" data-replyto="Antwoord op Xavier" aria-label='Antwoord op Xavier'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-441" class="comment byuser comment-author-admin bypostauthor even depth-2">
			<article id="div-comment-441" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-441"><time datetime="2019-11-14T13:11:21+00:00">november 14, 2019 om 1:11 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I think “&gt;” is wordpress fucking up the greater than sign “>”</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=441#respond' data-commentid="441" data-postid="4014" data-belowelement="div-comment-441" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-443" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-443" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/24c5e58e8f0f19f7970e3f07245bb099?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/24c5e58e8f0f19f7970e3f07245bb099?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Yusuf</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-443"><time datetime="2019-11-23T05:18:54+00:00">november 23, 2019 om 5:18 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi, i think i could not get something. Which code part of &#8220;3.2.3 Training the Convolutional Neural Network with the CWT&#8221; apply wavelet transform?<br />
Thanks</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=443#respond' data-commentid="443" data-postid="4014" data-belowelement="div-comment-443" data-respondelement="respond" data-replyto="Antwoord op Yusuf" aria-label='Antwoord op Yusuf'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-444" class="comment byuser comment-author-admin bypostauthor even depth-2">
			<article id="div-comment-444" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-444"><time datetime="2019-11-23T14:21:51+00:00">november 23, 2019 om 2:21 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>pywt.cwt() applies the continuous wavelet transform.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=444#respond' data-commentid="444" data-postid="4014" data-belowelement="div-comment-444" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-452" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-452" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/bbc638050f3f2613aa15b536ae4f300d?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bbc638050f3f2613aa15b536ae4f300d?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">AB Etim</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-452"><time datetime="2019-12-16T12:14:09+00:00">december 16, 2019 om 12:14 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hello, Please I  am new here on python. I have gone through this code, in section 3.2.1 line 32 and 33 seems to be giving me error, please can someone help check this for me? Also, I will like to know what this train_signals = np.transpose(np.array(train_signals), (1, 2, 0)) does.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=452#respond' data-commentid="452" data-postid="4014" data-belowelement="div-comment-452" data-respondelement="respond" data-replyto="Antwoord op AB Etim" aria-label='Antwoord op AB Etim'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-462" class="comment even thread-even depth-1 parent">
			<article id="div-comment-462" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9806afe38acfbe04a7bf406b8e6f37c5?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9806afe38acfbe04a7bf406b8e6f37c5?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Klaus</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-462"><time datetime="2020-02-17T22:12:05+00:00">februari 17, 2020 om 10:12 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Wow awesome article! thank you. I have signal with quite some phase noise and amplitude noise. I hope this is the way to go. Will let you know.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=462#respond' data-commentid="462" data-postid="4014" data-belowelement="div-comment-462" data-respondelement="respond" data-replyto="Antwoord op Klaus" aria-label='Antwoord op Klaus'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-466" class="comment odd alt depth-2">
			<article id="div-comment-466" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/c810870c551bc3f986431fa6ae878a91?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c810870c551bc3f986431fa6ae878a91?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Alexandre Carvalho</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-466"><time datetime="2020-02-23T19:19:25+00:00">februari 23, 2020 om 7:19 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>This a great article! But i dont no how to download de UCI HAR dataset with more than 10.000 signal , can you help me what bloq o must see? Thank you.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=466#respond' data-commentid="466" data-postid="4014" data-belowelement="div-comment-466" data-respondelement="respond" data-replyto="Antwoord op Alexandre Carvalho" aria-label='Antwoord op Alexandre Carvalho'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-467" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-467" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/3197a1eb0bdd3ab505aaad510da17156?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3197a1eb0bdd3ab505aaad510da17156?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Alex</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-467"><time datetime="2020-02-28T06:02:26+00:00">februari 28, 2020 om 6:02 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi! First, Thanks for the awesome article! But I have a questions about the CWT part. </p>
<p>Why using  &#8220;power&#8221; for visualizing while &#8220;coefficient&#8221; for CNN classification?</p>
<p>In plot_wavelet function,<br />
    dt = time[1] &#8211; time[0]<br />
    [coefficients, frequencies] = pywt.cwt(signal, scales, waveletname, dt)<br />
    power = (abs(coefficients)) ** 2<br />
    period = 1. / frequencies<br />
    levels = [0.0625, 0.125, 0.25, 0.5, 1, 2, 4, 8]<br />
    contourlevels = np.log2(levels)</p>
<p>    fig, ax = plt.subplots(figsize=(15, 10))<br />
    im = ax.contourf(time, np.log2(period), np.log2(power), contourlevels, extend=&#8217;both&#8217;,cmap=cmap)<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<p>In CNN<br />
for ii in range(0,train_size):<br />
    if ii % 1000 == 0:<br />
        print(ii)<br />
    for jj in range(0,9):<br />
        signal = uci_har_signals_train[ii, :, jj]<br />
        coeff, freq = pywt.cwt(signal, scales, waveletname, 1)<br />
        coeff_ = coeff[:,:127]<br />
        train_data_cwt[ii, :, :, jj] = coeff_</p>
<p>test_data_cwt = np.ndarray(shape=(test_size, 127, 127, 9))<br />
for ii in range(0,test_size):<br />
    if ii % 100 == 0:<br />
        print(ii)<br />
    for jj in range(0,9):<br />
        signal = uci_har_signals_test[ii, :, jj]<br />
        coeff, freq = pywt.cwt(signal, scales, waveletname, 1)<br />
        coeff_ = coeff[:,:127]<br />
        test_data_cwt[ii, :, :, jj] = coeff_</p>
<p>uci_har_labels_train = list(map(lambda x: int(x) &#8211; 1, uci_har_labels_train))<br />
uci_har_labels_test = list(map(lambda x: int(x) &#8211; 1, uci_har_labels_test))</p>
<p>Many thanks in advance!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=467#respond' data-commentid="467" data-postid="4014" data-belowelement="div-comment-467" data-respondelement="respond" data-replyto="Antwoord op Alex" aria-label='Antwoord op Alex'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-470" class="comment odd alt thread-even depth-1">
			<article id="div-comment-470" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ddf8bec12522555a2f86e956bb663dcd?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ddf8bec12522555a2f86e956bb663dcd?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">dongyoung yoon</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-470"><time datetime="2020-03-14T21:32:48+00:00">maart 14, 2020 om 9:32 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you for your great posting! it helped me a lot!<br />
by the way, I am curious way you add dt in function pywt.cwt()? as,<br />
[coefficients, frequencies] = pywt.cwt(signal, scales, waveletname, dt)</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=470#respond' data-commentid="470" data-postid="4014" data-belowelement="div-comment-470" data-respondelement="respond" data-replyto="Antwoord op dongyoung yoon" aria-label='Antwoord op dongyoung yoon'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-472" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-472" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/2462df20c0c2ec97504cc4dc7ede3222?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2462df20c0c2ec97504cc4dc7ede3222?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Óscar</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-472"><time datetime="2020-04-04T16:26:08+00:00">april 4, 2020 om 4:26 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank for an awesome post.<br />
I was wondering if you can share the code to obtain Figure 9, which is the scalogram from CWT on the 9 signals of the HAR dataset. I&#8217;ve tried to obtain them, but I have some troubles to get the same results, it is pretty similar, but tends to be messy.</p>
<p>Thanks in advance</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=472#respond' data-commentid="472" data-postid="4014" data-belowelement="div-comment-472" data-respondelement="respond" data-replyto="Antwoord op Óscar" aria-label='Antwoord op Óscar'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-473" class="comment byuser comment-author-admin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-473" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-473"><time datetime="2020-04-05T09:25:41+00:00">april 5, 2020 om 9:25 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>What seems to be the problem? It is simply a matplotlib subplots with ncols=3 and nrows=3&#8230;</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=473#respond' data-commentid="473" data-postid="4014" data-belowelement="div-comment-473" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-474" class="comment even depth-3">
			<article id="div-comment-474" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/2462df20c0c2ec97504cc4dc7ede3222?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2462df20c0c2ec97504cc4dc7ede3222?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Óscar</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-474"><time datetime="2020-04-10T08:44:10+00:00">april 10, 2020 om 8:44 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I have trouble using plt.contourf. My code to try to obtain one of the scalograms is</p>
<p>#plot<br />
fs = 50<br />
scales = np.arange(1,128) #len(of the signal)</p>
<p>t = np.arange(len(uci_har_signals_train[0, :, 3]))/fs</p>
<p>[coefficients, frequencies] = pywt.cwt(uci_har_signals_train[0, :, 3],scales, &#8216;morl&#8217;, 1)<br />
#levels = frequencies[-1:0:-1]<br />
levels = 20<br />
#contourlevels = (levels)<br />
fig,ax = plt.subplots(figsize = (10,8))<br />
im = ax.contourf(t, frequencies,np.log10(np.abs(coefficients)**2),levels,cmap=plt.cm.seismic)</p>
<p>#yticks = 2**np.arange(np.ceil(frequencies.min()), np.ceil((frequencies.max())))<br />
#ax.set_yticks([])<br />
#ax.set_yticklabels([])<br />
ax.invert_yaxis()<br />
ylim = ax.get_ylim()<br />
#ax.set_ylim(ylim[0], -1)</p>
<p>But the result is not similar to the one you obtain.</p>
<p>Thank you for the response</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=474#respond' data-commentid="474" data-postid="4014" data-belowelement="div-comment-474" data-respondelement="respond" data-replyto="Antwoord op Óscar" aria-label='Antwoord op Óscar'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-476" class="comment odd alt thread-even depth-1">
			<article id="div-comment-476" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/fc79d7fdf910acf881c7f25356824557?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fc79d7fdf910acf881c7f25356824557?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Daniel</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-476"><time datetime="2020-04-22T21:01:13+00:00">april 22, 2020 om 9:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Anyone here interested in Wavelets?</p>
<p>Follow my dissertation about PCBs Fast Wavelet Transform.</p>
<p>Please, download and read it!</p>
<p>Link: <a href="http://repositorio.unicamp.br/jspui/handle/REPOSIP/338849" rel="nofollow ugc">http://repositorio.unicamp.br/jspui/handle/REPOSIP/338849</a></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=476#respond' data-commentid="476" data-postid="4014" data-belowelement="div-comment-476" data-respondelement="respond" data-replyto="Antwoord op Daniel" aria-label='Antwoord op Daniel'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-479" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-479" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cbdfaa21af59685d504e3c3f7790a33c?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cbdfaa21af59685d504e3c3f7790a33c?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Florian</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-479"><time datetime="2020-05-12T13:23:11+00:00">mei 12, 2020 om 1:23 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>An excellent article, thank you so much for it!<br />
It convinced me to investigate further onto wavelet transformation topic.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=479#respond' data-commentid="479" data-postid="4014" data-belowelement="div-comment-479" data-respondelement="respond" data-replyto="Antwoord op Florian" aria-label='Antwoord op Florian'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-480" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-480" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ade17a5d2b6a20f561a73103fd51319f?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ade17a5d2b6a20f561a73103fd51319f?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">David</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-480"><time datetime="2020-05-13T22:54:12+00:00">mei 13, 2020 om 10:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Dear Ahmet<br />
I really thank you for this explanation. I have some questions and I  hope you get free time to give me your miracle guidance.<br />
I&#8217;m really sad that whenever we are talking about signal and signal processing all get focus on multivariate &#8230;.<br />
I am working with time series forecasting and I have some problems with padding and signal extension when using wavelet.<br />
as you know distortion happens in two edges of the finite signal(time series here) then we should use a signal extension method to extend signal then our main signal will be unaffected.<br />
in time series maybe the historical data available to extend but it is the main problem for the right edge because we do not know the future value(this problem is much more important for online models) so we use prediction engines to get artifact future samples to extend the signal.<br />
some formula to calculate the number of samples we need is (FilterLenght-1)*(2**(DecLevel-1)<br />
could you please tell me or give an example code(more realistic) how can we use artificial data to extend the signal appropriately for the different levels to reduce the distortions<br />
Sincerely I am waiting for your replay<br />
Best Regards</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=480#respond' data-commentid="480" data-postid="4014" data-belowelement="div-comment-480" data-respondelement="respond" data-replyto="Antwoord op David" aria-label='Antwoord op David'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-483" class="comment even depth-2">
			<article id="div-comment-483" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/86353a2e90bcd4ddf0f0e6aad5783c2c?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/86353a2e90bcd4ddf0f0e6aad5783c2c?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Gigi</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-483"><time datetime="2020-07-06T08:58:44+00:00">juli 6, 2020 om 8:58 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi David,</p>
<p>Have you solved this problem? I am facing the same issue. I could reproduce the improvement of accuracies for time series forecast from using LSTM to dwt+LSTM as shown in the literature using historical data. But as you said, in real life we would face padding problems on the right edge and I couldn&#8217;t find how they solve this problem in the literature. Would be very grateful if you have solved this issue and don&#8217;t mind to share the solution here.</p>
<p>Thanks in advance</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=483#respond' data-commentid="483" data-postid="4014" data-belowelement="div-comment-483" data-respondelement="respond" data-replyto="Antwoord op Gigi" aria-label='Antwoord op Gigi'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-482" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-482" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/80623564b4a79f73521e855bd5be02a7?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/80623564b4a79f73521e855bd5be02a7?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Daniel</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-482"><time datetime="2020-06-26T22:22:15+00:00">juni 26, 2020 om 10:22 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Anyone here interested in Wavelets?</p>
<p>Please, check out my Master dissertation about PCBs inspection using Fast Wavelet Transform:</p>
<p><a href="http://repositorio.unicamp.br/jspui/bitstream/REPOSIP/338849/1/Bonello_DanielKatz_M.pdf" rel="nofollow ugc">http://repositorio.unicamp.br/jspui/bitstream/REPOSIP/338849/1/Bonello_DanielKatz_M.pdf</a></p>
<p>Thank you 😉</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=482#respond' data-commentid="482" data-postid="4014" data-belowelement="div-comment-482" data-respondelement="respond" data-replyto="Antwoord op Daniel" aria-label='Antwoord op Daniel'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-486" class="comment even thread-even depth-1">
			<article id="div-comment-486" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/76bc0d23625791f3efae04b35aec1359?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/76bc0d23625791f3efae04b35aec1359?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Paul Lipman</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-486"><time datetime="2020-09-29T20:38:33+00:00">september 29, 2020 om 8:38 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for a really fantastic article! I&#8217;ve been trying to do something similar with a very large dataset, but the resulting array is too large to fit in memory. I have 12 scaleograms to layer into the CNN. I know Keras has the &#8220;flow_from_directory&#8221; capability, but I can only figure out how to do this with a 3-layer RGB image. Is there anything you&#8217;d recommend for applying your approach with larger data sets? Many thanks!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=486#respond' data-commentid="486" data-postid="4014" data-belowelement="div-comment-486" data-respondelement="respond" data-replyto="Antwoord op Paul Lipman" aria-label='Antwoord op Paul Lipman'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-487" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-487" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/254f71fa01240bddec253310e535663e?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/254f71fa01240bddec253310e535663e?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Sibi</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-487"><time datetime="2020-09-30T15:01:45+00:00">september 30, 2020 om 3:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Nice Article ! Is it possible to discuss the rationale behind the data transformation for generating the ytick values and what do they mean intuitively  ? And also what is the reason behind applying invert_yaxis. I am trying out the approach on a dataset that I have and inverting the y-axis gives extremely different spectrogram</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=487#respond' data-commentid="487" data-postid="4014" data-belowelement="div-comment-487" data-respondelement="respond" data-replyto="Antwoord op Sibi" aria-label='Antwoord op Sibi'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-489" class="comment even thread-even depth-1 parent">
			<article id="div-comment-489" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/b4fe83f4694c46565ff774fcf0c44eb2?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b4fe83f4694c46565ff774fcf0c44eb2?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Conor White</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-489"><time datetime="2020-10-20T13:00:28+00:00">oktober 20, 2020 om 1:00 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Regarding the right edge problem referred to above: Use of wavelets is all fine in theory but practically useless for time series forecasting. When applying a wavelet transform to time series data, you effectively are leaking future information backwards through the series. This is why it gives such great results when training a model but will not work in the real world as we don&#8217;t have the future values.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=489#respond' data-commentid="489" data-postid="4014" data-belowelement="div-comment-489" data-respondelement="respond" data-replyto="Antwoord op Conor White" aria-label='Antwoord op Conor White'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-490" class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<article id="div-comment-490" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-490"><time datetime="2020-10-31T12:43:08+00:00">oktober 31, 2020 om 12:43 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Conor,<br />
Thank you for this reaction. That is why I also first split the time-series into a training set and a test set. The training set is up to t0 and a the test set from t0 up to the end.<br />
Since the wavelet transform is only applied on the training part of the signal it is impossible to incorporate future information which is in the test set.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=490#respond' data-commentid="490" data-postid="4014" data-belowelement="div-comment-490" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-491" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-491" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/90501af2657fc81b9970a9fdcd7cb273?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/90501af2657fc81b9970a9fdcd7cb273?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Wassim</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-491"><time datetime="2020-12-17T12:28:23+00:00">december 17, 2020 om 12:28 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hey ahmet , Thank you for the big work here . in the following code :<br />
def get_ecg_features(ecg_data, ecg_labels, waveletname):<br />
    list_features = []<br />
    list_unique_labels = list(set(ecg_labels))<br />
&#8212;&#8212;&#8212;&#8211;&gt;&gt;&gt;&gt;    list_labels = [list_unique_labels.index(elem) for elem in ecg_labels]<br />
    for signal in ecg_data:<br />
        list_coeff = pywt.wavedec(signal, waveletname)<br />
        features = []<br />
        for coeff in list_coeff:<br />
           &#8212;&#8212;&#8211;&gt; features += get_features(coeff)<br />
        list_features.append(features)<br />
    return list_features, list_labels</p>
<p>i didnt understand clearly what you did exactly in the lines I mentionned there , can you please explain more , really appreciate .</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=491#respond' data-commentid="491" data-postid="4014" data-belowelement="div-comment-491" data-respondelement="respond" data-replyto="Antwoord op Wassim" aria-label='Antwoord op Wassim'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-492" class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<article id="div-comment-492" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-492"><time datetime="2020-12-17T17:57:50+00:00">december 17, 2020 om 5:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>It looks like I am LabelEncoding the labels by replacing them with their index number (of list_unique_labels).<br />
You can also use scikit-learns Label Encoder of course. If you do it like above I would recommend to also sort the list_unique_labels so it is always in the same order. </p>
<p>Second:<br />
get_features() returns a list which is automatically concatenated with “features”.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=492#respond' data-commentid="492" data-postid="4014" data-belowelement="div-comment-492" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-496" class="comment even thread-even depth-1">
			<article id="div-comment-496" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/55502f40dc8b7c769880b10874abc9d0?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/55502f40dc8b7c769880b10874abc9d0?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">E K</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-496"><time datetime="2021-01-14T20:48:57+00:00">januari 14, 2021 om 8:48 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Fantastic writeup, incredibly detailed and easy to follow. Thank you!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=496#respond' data-commentid="496" data-postid="4014" data-belowelement="div-comment-496" data-respondelement="respond" data-replyto="Antwoord op E K" aria-label='Antwoord op E K'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-497" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-497" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d1052b861274a45cbdee0b74e27a7bb4?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d1052b861274a45cbdee0b74e27a7bb4?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Fer</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-497"><time datetime="2021-01-21T20:18:40+00:00">januari 21, 2021 om 8:18 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank You! I agree with you, there are not many resources online talking about DWT in a practical way, I truly appreciate your post!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=497#respond' data-commentid="497" data-postid="4014" data-belowelement="div-comment-497" data-respondelement="respond" data-replyto="Antwoord op Fer" aria-label='Antwoord op Fer'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-499" class="comment even thread-even depth-1 parent">
			<article id="div-comment-499" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/8ee8e1d2f89b7c5aa092c0785f062c92?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8ee8e1d2f89b7c5aa092c0785f062c92?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Saeb</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-499"><time datetime="2021-01-31T19:56:25+00:00">januari 31, 2021 om 7:56 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Ahmet,<br />
Thank you for the great content, it helped me a lot.<br />
I have a question. In feature extraction steps you are using the output from the &#8220;pywt.wavedec&#8221; function. The &#8220;pywavelet&#8221; documentation states that the output is [cA_n, cD_n, cD_n-1, &#8230;, cD2, cD1] (n is the level), however in your figure it looks like the features are created from only the approximation coefficients. Don&#8217;t the features come from the last approximation coefficients and all the detail coefficients?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=499#respond' data-commentid="499" data-postid="4014" data-belowelement="div-comment-499" data-respondelement="respond" data-replyto="Antwoord op Saeb" aria-label='Antwoord op Saeb'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-500" class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<article id="div-comment-500" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-500"><time datetime="2021-02-03T07:00:11+00:00">februari 3, 2021 om 7:00 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Saeb,<br />
Thank a lot. You are right actually, looks like the arrows are pointing from the wrong coefficients.<br />
I&#8217;ll update it asap.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=500#respond' data-commentid="500" data-postid="4014" data-belowelement="div-comment-500" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-501" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-501" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/70373264af2192404e52a672c597a635?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/70373264af2192404e52a672c597a635?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Nahid</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-501"><time datetime="2021-02-05T14:29:13+00:00">februari 5, 2021 om 2:29 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I have tried exactly the same code, but frequency domain plot does not come exactly the same given above. What is the problem??</p>
<p>def get_fft_values(y_values, T, N, f_s):<br />
    f_values = np.linspace(0.0, 1.0/(2.0*T), N//2)<br />
    fft_values_ = fft(y_values)<br />
    fft_values = 2.0/N * np.abs(fft_values_[0:N//2])<br />
    return f_values, fft_values</p>
<p>t_n=1<br />
N = 100000<br />
T = t_n / N<br />
f_s = 1/T</p>
<p>xa = np.linspace(0, t_n, num=N)<br />
xb = np.linspace(0, t_n/4, num=N//4)</p>
<p>frequencies = [4, 30, 60, 90]<br />
y1a, y1b = np.sin(2*np.pi*frequencies[0]*xa), np.sin(2*np.pi*frequencies[0]*xb)<br />
y2a, y2b = np.sin(2*np.pi*frequencies[1]*xa), np.sin(2*np.pi*frequencies[1]*xb)<br />
y3a, y3b = np.sin(2*np.pi*frequencies[2]*xa), np.sin(2*np.pi*frequencies[2]*xb)<br />
y4a, y4b = np.sin(2*np.pi*frequencies[3]*xa), np.sin(2*np.pi*frequencies[3]*xb)</p>
<p>composite_signal1 = y1a + y2a + y3a + y4a<br />
composite_signal2 = np.concatenate([y1b, y2b, y3b, y4b])</p>
<p>f_values1, fft_values1 = get_fft_values(composite_signal1, T, N, f_s)<br />
f_values2, fft_values2 = get_fft_values(composite_signal2, T, N, f_s)</p>
<p>fig, axarr = plt.subplots(nrows=2, ncols=2, figsize=(12,8))<br />
axarr[0,0].plot(xa, composite_signal1)<br />
axarr[1,0].plot(xa, composite_signal2)<br />
axarr[0,1].plot(f_values1, fft_values1)<br />
axarr[1,1].plot(f_values2, fft_values2)<br />
(&#8230;)<br />
plt.tight_layout()<br />
plt.show()</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=501#respond' data-commentid="501" data-postid="4014" data-belowelement="div-comment-501" data-respondelement="respond" data-replyto="Antwoord op Nahid" aria-label='Antwoord op Nahid'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-502" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-502" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9ebba87d298788ebb9631a55f842a0d0?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9ebba87d298788ebb9631a55f842a0d0?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Mariana Costa</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-502"><time datetime="2021-02-25T13:33:08+00:00">februari 25, 2021 om 1:33 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I think this article is very important and informative, it helped me a lot. I&#8217;m currently studying the hypothesis of using wavelet transform as a preprocessing step in  my machine learning model. I have a small problem/dilemma with this and it would be really nice if you could answer. So, i have these signals to split into train/test but to transform the signlas with wavelet transform i can&#8217;t shuffle the data right? I feel like it doesn&#8217;t make sense to transform a shuffled signal, but if i don&#8217;t do it my test data won&#8217;t include important values to test. And I think i can&#8217;t transform the whole signal and only after split since there will be leakage to the test set right? So, any ideas how to help me? Thank you so much!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=502#respond' data-commentid="502" data-postid="4014" data-belowelement="div-comment-502" data-respondelement="respond" data-replyto="Antwoord op Mariana Costa" aria-label='Antwoord op Mariana Costa'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-503" class="comment byuser comment-author-admin bypostauthor even depth-2">
			<article id="div-comment-503" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-503"><time datetime="2021-02-25T14:10:38+00:00">februari 25, 2021 om 2:10 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Mariana,<br />
I think you are doing an “out of time” split to split each signal into a part train and part test, right?<br />
Because you could also split it “out of sample” where each signal is either in train or in test. </p>
<p>In any case you should first split and then transform to prevent leakage.<br />
If you have a signals of 100 sec, you could split it into 50s of train and 50s of test. If you have unequal lengths for train/ test for example 80s for train and 20s for test you could also apply a windowing function to split the train part into blocks of 20s.<br />
If you want to apply windowing, you have to make sure there are no blocks which are both in the train and test set. </p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=503#respond' data-commentid="503" data-postid="4014" data-belowelement="div-comment-503" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-504" class="comment byuser comment-author-admin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-504" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/af13b24aa38f363681a1a29ce4e7204a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">admin</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-504"><time datetime="2021-02-25T14:19:50+00:00">februari 25, 2021 om 2:19 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>It really depends on what you want to predict I guess. If it is an ‘event’ / anomaly which can occur at any part of the signal randomly and you apply windowing it will be in some of the blocks and not in others.<br />
If it is something where the location in the time-series is relevant like “remaining useful life time prediction” then you should also keep track of which part of the signal you get each block and maybe use it as an additional feature</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=504#respond' data-commentid="504" data-postid="4014" data-belowelement="div-comment-504" data-respondelement="respond" data-replyto="Antwoord op admin" aria-label='Antwoord op admin'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-505" class="comment even depth-3">
			<article id="div-comment-505" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9ebba87d298788ebb9631a55f842a0d0?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9ebba87d298788ebb9631a55f842a0d0?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Mariana Costa</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-505"><time datetime="2021-02-26T17:50:26+00:00">februari 26, 2021 om 5:50 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you! That actually cleared my min 🙂</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=505#respond' data-commentid="505" data-postid="4014" data-belowelement="div-comment-505" data-respondelement="respond" data-replyto="Antwoord op Mariana Costa" aria-label='Antwoord op Mariana Costa'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-506" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-506" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cb34f67b8406cbfcafb4db25ed4c43f2?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cb34f67b8406cbfcafb4db25ed4c43f2?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Addi</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-506"><time datetime="2021-03-01T21:58:40+00:00">maart 1, 2021 om 9:58 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi, very interesting blog post.<br />
Could you share the part of the code to obtain: Figure 9. The CWT applied on two signals belonging to the UCI HAR dataset ?<br />
 I used plt.matshow, but the resolution is different, and i do not know which signal you used for comparison. Thank you very much.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=506#respond' data-commentid="506" data-postid="4014" data-belowelement="div-comment-506" data-respondelement="respond" data-replyto="Antwoord op Addi" aria-label='Antwoord op Addi'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-507" class="comment even thread-even depth-1">
			<article id="div-comment-507" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/518776334ed5a386cf6a7f4c2c49a798?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/518776334ed5a386cf6a7f4c2c49a798?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn"><a href='https://www.facebook.com/alxfed/' rel='external nofollow ugc' class='url'>Alex Fedotov</a></b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-507"><time datetime="2021-03-05T16:01:40+00:00">maart 5, 2021 om 4:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I like those no_zero_crossings and no_mean_crossings features that gave you 86% of the result right away. How did you come up with that? Also, do you quite understand their connection with Walsh basis?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=507#respond' data-commentid="507" data-postid="4014" data-belowelement="div-comment-507" data-respondelement="respond" data-replyto="Antwoord op Alex Fedotov" aria-label='Antwoord op Alex Fedotov'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-508" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-508" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d524dcd7b52716bdbd45e5ace3f6d1d8?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d524dcd7b52716bdbd45e5ace3f6d1d8?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Madhu Oruganti`</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-508"><time datetime="2021-03-12T09:45:15+00:00">maart 12, 2021 om 9:45 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi sir,<br />
How can we change the scaling factor in stationary wavelet transform (swt).<br />
In python wavelets they were providing as this command for swt,  pywt.swt2(arr, &#8216;bior1.3&#8217;, level=1, start_level=0):<br />
I am working for images for extracting features from facial images.</p>
<p>Thank you</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=508#respond' data-commentid="508" data-postid="4014" data-belowelement="div-comment-508" data-respondelement="respond" data-replyto="Antwoord op Madhu Oruganti`" aria-label='Antwoord op Madhu Oruganti`'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-512" class="comment even thread-even depth-1">
			<article id="div-comment-512" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/87fc9651ff52bb01ddb21ec4365698a4?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/87fc9651ff52bb01ddb21ec4365698a4?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">salimi</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-512"><time datetime="2021-05-09T14:50:01+00:00">mei 9, 2021 om 2:50 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>hi .i read this article . it is very useful. i enjoyed it .<br />
i want decompose  an image with  non subsampled shearlet transform(NSST) . can help me . please</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=512#respond' data-commentid="512" data-postid="4014" data-belowelement="div-comment-512" data-respondelement="respond" data-replyto="Antwoord op salimi" aria-label='Antwoord op salimi'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-513" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-513" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/87fc9651ff52bb01ddb21ec4365698a4?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/87fc9651ff52bb01ddb21ec4365698a4?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">salimi</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-513"><time datetime="2021-05-09T14:52:01+00:00">mei 9, 2021 om 2:52 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>hi . i read this article . it is very useful.i enjoyed it .<br />
i want decompose  an image with  non subsampled shearlet transform . can help me . please</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=513#respond' data-commentid="513" data-postid="4014" data-belowelement="div-comment-513" data-respondelement="respond" data-replyto="Antwoord op salimi" aria-label='Antwoord op salimi'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-514" class="comment even thread-even depth-1">
			<article id="div-comment-514" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/159f0ed884662e7d3a833d3bf6d75044?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/159f0ed884662e7d3a833d3bf6d75044?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' loading='lazy'/>						<b class="fn">Josep Manuel</b> <span class="says">schreef:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#comment-514"><time datetime="2021-05-17T15:22:33+00:00">mei 17, 2021 om 3:22 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hello Ahmet,<br />
Awesome article, awesome blog, great job!.<br />
I have some questions about wavelets:<br />
1.- Have you any good reference(s) to deepen knowledge in the wavelet world?<br />
2.- How to choose the right wavelet for a given application? I see, the question has been answered almost in the last paragraph, try, test, test and try&#8230; is there any advice or suggestion other to burn the cpu?.<br />
3.- In the case of a time series forecasting, what approach do you suggest?<br />
3a.- Use the components as individual signals, forecast it and add the forecasted series as the final forecast?<br />
3b.- Extract some features, as in the case of time series classification, and try to build a regressor from it?<br />
Thank you very much for you time<br />
JM Vericat</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/?replytocom=514#respond' data-commentid="514" data-postid="4014" data-belowelement="div-comment-514" data-respondelement="respond" data-replyto="Antwoord op Josep Manuel" aria-label='Antwoord op Josep Manuel'>Beantwoorden</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-522" class="pingback odd alt thread-odd thread-alt depth-1">
			<div class="comment-body">
				Pingback: <a href='http://aurimas.eu/blog/2022/01/an-interactive-introduction-to-wavelets-and-discrete-wavelet-transformation-for-data-scientists/' rel='external nofollow ugc' class='url'>An interactive introduction to wavelets and discrete wavelet transformation for data scientists &#8211; @aurimas</a> 			</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Geef een antwoord <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/#respond" style="display:none;">Antwoord annuleren</a></small></h3><form action="https://ataspinar.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Het e-mailadres wordt niet gepubliceerd.</span> Vereiste velden zijn gemarkeerd met <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Reactie</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Naam <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p>
<p class="comment-form-email"><label for="email">E-mail <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required='required' /></p>
<p class="comment-form-url"><label for="url">Site</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Mijn naam, e-mail en site bewaren in deze browser voor de volgende keer wanneer ik een reactie plaats.</label></p>
<p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Stuur mij een e-mail als er vervolgreacties zijn.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Stuur mij een e-mail als er nieuwe berichten zijn.</label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Reactie plaatsen" /> <input type='hidden' name='comment_post_ID' value='4014' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p>
<noscript><input type="hidden" name="JS04X7" value="NS1" /></noscript>
<noscript><p><strong>U heeft JavaScript momenteel uitgeschakeld. Om een reactie te kunnen plaatsen dient u JavaScript in te schakelen en Cookies toe te staan, vernieuw vervolgens deze pagina.</strong> <a href="http://enable-javascript.com/" rel="nofollow external" >Klik hier voor uitleg over het inschakelen van JavaScript in uw browser.</a></p></noscript>
</form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->

	

<div id="secondary" class="widget-area col-md-3" role="complementary" >
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://ataspinar.com/">
				<label>
					<span class="screen-reader-text">Zoeken naar:</span>
					<input type="search" class="search-field" placeholder="Zoeken &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Zoeken" />
			</form></aside><aside id="blog_subscription-2" class="widget widget_blog_subscription jetpack_subscription_widget"><h3 class="widget-title">Subscribe to this blog! </h3>
            <form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
				                    <p id="subscribe-email">
                        <label id="jetpack-subscribe-label"
                               class="screen-reader-text"
                               for="subscribe-field-blog_subscription-2">
							E-mailadres                        </label>
                        <input type="email" name="email" required="required"
                        			                                                value=""
                            id="subscribe-field-blog_subscription-2"
                            placeholder="E-mailadres"
                        />
                    </p>

					<p id="subscribe-submit"
											>
                        <input type="hidden" name="action" value="subscribe"/>
                        <input type="hidden" name="source" value="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/"/>
                        <input type="hidden" name="sub-type" value="widget"/>
                        <input type="hidden" name="redirect_fragment" value="blog_subscription-2"/>
						                        <button type="submit"
	                        		                    	                        name="jetpack_subscriptions_widget"
	                    >
	                        Subscribe!                        </button>
                    </p>
				            </form>
		
</aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h3 class="widget-title">Meest recente berichten</h3>
		<ul>
											<li>
					<a href="https://ataspinar.com/2020/12/22/time-series-forecasting-with-stochastic-signal-analysis-techniques/">Time-Series forecasting with Stochastic Signal Analysis techniques</a>
									</li>
											<li>
					<a href="https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/" aria-current="page">A guide for using the Wavelet Transform in Machine Learning</a>
									</li>
											<li>
					<a href="https://ataspinar.com/2018/07/05/building-recurrent-neural-networks-in-tensorflow/">Building Recurrent Neural Networks in Tensorflow</a>
									</li>
											<li>
					<a href="https://ataspinar.com/2018/04/04/machine-learning-with-signal-processing-techniques/">Machine Learning with Signal Processing Techniques</a>
									</li>
											<li>
					<a href="https://ataspinar.com/2017/12/04/using-convolutional-neural-networks-to-detect-features-in-sattelite-images/">Using Convolutional Neural Networks to detect features in satellite images</a>
									</li>
					</ul>

		</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categorieën</h3>
			<ul>
					<li class="cat-item cat-item-8"><a href="https://ataspinar.com/category/machine-learning/classification/">Classification</a>
</li>
	<li class="cat-item cat-item-13"><a href="https://ataspinar.com/category/convolutional-neural-networks/">convolutional neural networks</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://ataspinar.com/category/data-mining/">Data Mining</a>
</li>
	<li class="cat-item cat-item-12"><a href="https://ataspinar.com/category/deep-learning/">deep learning</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://ataspinar.com/category/machine-learning/">Machine Learning</a>
</li>
	<li class="cat-item cat-item-14"><a href="https://ataspinar.com/category/recurrent-neural-networks/">recurrent neural networks</a>
</li>
	<li class="cat-item cat-item-9"><a href="https://ataspinar.com/category/scikit-learn/">scikit-learn</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://ataspinar.com/category/machine-learning/sentiment-analytics/">Sentiment Analytics</a>
</li>
	<li class="cat-item cat-item-10"><a href="https://ataspinar.com/category/stochastic-signal-analysis/">Stochastic signal analysis</a>
</li>
	<li class="cat-item cat-item-11"><a href="https://ataspinar.com/category/tensorflow/">tensorflow</a>
</li>
	<li class="cat-item cat-item-5"><a href="https://ataspinar.com/category/twitter-analytics/">Twitter Analytics</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://ataspinar.com/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-6"><a href="https://ataspinar.com/category/visualizations/">Visualizations</a>
</li>
			</ul>

			</aside><aside id="meta-2" class="widget widget_meta"><h3 class="widget-title">Meta</h3>
		<ul>
						<li><a href="https://ataspinar.com/wp-login.php">Inloggen</a></li>
			<li><a href="https://ataspinar.com/feed/">Berichten feed</a></li>
			<li><a href="https://ataspinar.com/comments/feed/">Reacties feed</a></li>

			<li><a href="https://nl.wordpress.org/">WordPress.org</a></li>
		</ul>

		</aside></div><!-- #secondary -->
			</div>
		</div>
	</div><!-- #content -->

	
	
    <a on="tap:toptarget.scrollTo(duration=200)" class="go-top"><i class="sydney-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z" /></svg></i></a>
		
	<footer id="colophon" class="site-footer" role="contentinfo" >
		<div class="site-info container">
			<a href="https://wordpress.org/">Ondersteund door WordPress</a>
			<span class="sep"> | </span>
			Thema: <a href="https://athemes.com/theme/sydney" rel="nofollow">Sydney</a> van aThemes.		</div><!-- .site-info -->
	</footer><!-- #colophon -->

	
</div><!-- #page -->


<script type='text/javascript'>
/* <![CDATA[ */
r3f5x9JS=escape(document['referrer']);
hf4N='a45fb7c8a1877d5ac9c14b7d755225a8';
hf4V='88f1c3fbcc4b617b6792863536df64e2';
cm4S="form[action='https://ataspinar.com/wp-comments-post.php']";
jQuery(document).ready(function($){var e="#commentform, .comment-respond form, .comment-form, "+cm4S+", #lostpasswordform, #registerform, #loginform, #login_form, #wpss_contact_form, .wpcf7-form";$(e).submit(function(){$("<input>").attr("type","hidden").attr("name","r3f5x9JS").attr("value",r3f5x9JS).appendTo(e);$("<input>").attr("type","hidden").attr("name",hf4N).attr("value",hf4V).appendTo(e);return true;});$("#comment").attr({minlength:"15",maxlength:"15360"})});
/* ]]> */
</script> 

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/ataspinar.com\/2018\/12\/21\/a-guide-for-using-the-wavelet-transform-in-machine-learning\/":4014};
	</script>
				<script type='text/javascript' src='https://ataspinar.com/wp-includes/js/dist/vendor/regenerator-runtime.min.js?ver=0.13.7' id='regenerator-runtime-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0' id='wp-polyfill-js'></script>
<script type='text/javascript' id='contact-form-7-js-extra'>
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/ataspinar.com\/wp-json\/","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.4.2' id='contact-form-7-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/wp-gif-player/js/play_gif.js?ver=1512585559' id='play_gifs-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/wp-gif-player/inc/spin.js?ver=1.0' id='spin-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/wp-gif-player/inc/jquery.spin.js?ver=1.0' id='spinjQuery-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/themes/sydney/js/functions.min.js?ver=20210120' id='sydney-functions-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-includes/js/comment-reply.min.js?ver=5.8' id='comment-reply-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/wp-spamshield/js/jscripts-ftr-min.js' id='wpss-jscripts-ftr-js'></script>
<script type='text/javascript' src='https://ataspinar.com/wp-includes/js/wp-embed.min.js?ver=5.8' id='wp-embed-js'></script>
<script type='text/javascript' id='sharing-js-js-extra'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"nl","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://ataspinar.com/wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js?ver=10.0' id='sharing-js-js'></script>
<script type='text/javascript' id='sharing-js-js-after'>
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
</script>
	<script>
	/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
	</script>
	<script src='https://stats.wp.com/e-202210.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.0',blog:'108526624',post:'4014',tz:'0',srv:'ataspinar.com'} ]);
	_stq.push([ 'clickTrackerInit', '108526624', '4014' ]);
</script>

</body>
</html>
